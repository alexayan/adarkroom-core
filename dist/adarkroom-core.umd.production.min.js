!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self)["adarkroom-core"]={})}(this,(function(e){"use strict";function t(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function n(e){return function(){var n=this,r=arguments;return new Promise((function(a,o){var i=e.apply(n,r);function c(e){t(i,a,o,c,s,"next",e)}function s(e){t(i,a,o,c,s,"throw",e)}c(void 0)}))}}function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function c(e,t){return e(t={exports:{}},t.exports),t.exports}var s,u,l,f,h=c((function(e){var t=function(e){var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var a=Object.create((t&&t.prototype instanceof f?t:f).prototype),o=new _(r||[]);return a._invoke=function(e,t,n){var r="suspendedStart";return function(a,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw o;return{value:void 0,done:!0}}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var c=x(i,n);if(c){if(c===l)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=u(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}(e,n,o),a}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var l={};function f(){}function h(){}function d(){}var p={};c(p,a,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(E([])));g&&g!==t&&n.call(g,a)&&(p=g);var v=d.prototype=f.prototype=Object.create(p);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var r;this._invoke=function(a,o){function i(){return new t((function(r,i){!function r(a,o,i,c){var s=u(e[a],e,o);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):t.resolve(f).then((function(e){l.value=e,i(l)}),(function(e){return r("throw",e,i,c)}))}c(s.arg)}(a,o,r,i)}))}return r=r?r.then(i,i):i()}}function x(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function E(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=d,c(v,"constructor",d),c(d,"constructor",h),h.displayName=c(d,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,c(e,i,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(b.prototype),c(b.prototype,o,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new b(s(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),c(v,i,"Generator"),c(v,a,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=E,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),s=n.call(o,"finallyLoc");if(c&&s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:E(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}));function d(e){return e}(u=e.StoreCategory||(e.StoreCategory={})).wood="wood",u.fur="fur",u.meat="meat",u.iron="iron",u.coal="coal",u.sulphur="sulphur",u.steel="steel",u.cured_meat="cured_meat",u.scales="scales",u.teeth="teeth",u.leather="leather",u.bait="bait",u.torch="torch",u.cloth="cloth",u.bone_spear="bone_spear",u.iron_sword="iron_sword",u.steel_sword="steel_sword",u.bayonet="bayonet",u.rifle="rifle",u.laser_rifle="laser_rifle",u.bullets="bullets",u.energy_cell="energy_cell",u.grenade="grenade",u.bolas="bolas",u.medicine="medicine",u.compass="compass",u.charm="charm",u.alien_alloy="alien_alloy",u.waterskin="waterskin",u.cask="cask",u.water_tank="water_tank",u.rucksack="rucksack",u.wagon="wagon",u.convoy="convoy",u.l_armou="l_armou",u.i_armour="i_armour",u.s_armour="s_armour",u.trap="trap",u.cart="cart",u.hut="hut",u.lodge="lodge",u.trading_post="trading_post",u.tannery="tannery",u.smokehouse="smokehouse",u.workshop="workshop",u.steelworks="steelworks",u.armoury="armoury",(l=e.GameSpace||(e.GameSpace={})).Room="Room",l.Path="Path",l.Outside="Outside",l.World="World",l.Ship="Ship",l.Space="Space",(f=e.PerkCategory||(e.PerkCategory={})).boxer="boxer",f.martial_artist="martial_artist",f.unarmed_master="unarmed_master",f.barbarian="barbarian",f.slow_metabolism="slow_metabolism",f.desert_rat="desert_rat",f.evasive="evasive",f.precise="precise",f.scout="scout",f.stealthy="stealthy",f.gastronome="gastronome";var p,m,g,v,y=((s={})[e.PerkCategory.boxer]={name:d("boxer"),desc:d("punches do more damage"),notify:d("learned to throw punches with purpose")},s[e.PerkCategory.martial_artist]={name:d("martial artist"),desc:d("punches do even more damage."),notify:d("learned to fight quite effectively without weapons")},s[e.PerkCategory.unarmed_master]={name:d("unarmed master"),desc:d("punch twice as fast, and with even more force"),notify:d("learned to strike faster without weapons")},s[e.PerkCategory.barbarian]={name:d("barbarian"),desc:d("melee weapons deal more damage"),notify:d("learned to swing weapons with force")},s[e.PerkCategory.slow_metabolism]={name:d("slow metabolism"),desc:d("go twice as far without eating"),notify:d("learned how to ignore the hunger")},s[e.PerkCategory.desert_rat]={name:d("desert rat"),desc:d("go twice as far without drinking"),notify:d("learned to love the dry air")},s[e.PerkCategory.evasive]={name:d("evasive"),desc:d("dodge attacks more effectively"),notify:d("learned to be where they're not")},s[e.PerkCategory.precise]={name:d("precise"),desc:d("land blows more often"),notify:d("learned to predict their movement")},s[e.PerkCategory.scout]={name:d("scout"),desc:d("see farther"),notify:d("learned to look ahead")},s[e.PerkCategory.stealthy]={name:d("stealthy"),desc:d("better avoid conflict in the wild"),notify:d("learned how not to be seen")},s[e.PerkCategory.gastronome]={name:d("gastronome"),desc:d("restore more health when eating"),notify:d("learned to make the most of food")},s);(p=e.Building||(e.Building={})).trap="trap",p.cart="cart",p.hut="hut",p.lodge="lodge",p.trading_post="trading_post",p.tannery="tannery",p.smokehouse="smokehouse",p.workshop="workshop",p.steelworks="steelworks",p.armoury="armoury",p.sulphur_mine="sulphur_mine",p.iron_mine="iron_mine",p.coal_mine="coal_mine",(m=e.Craftable||(e.Craftable={})).trap="trap",m.cart="cart",m.hut="hut",m.lodge="lodge",m.trading_post="trading_post",m.tannery="tannery",m.smokehouse="smokehouse",m.workshop="workshop",m.steelworks="steelworks",m.armoury="armoury",m.torch="torch",m.waterskin="waterskin",m.cask="cask",m.water_tank="water_tank",m.bone_spear="bone_spear",m.rucksack="rucksack",m.wagon="wagon",m.convoy="convoy",m.l_armou="l_armou",m.i_armour="i_armour",m.s_armour="s_armour",m.iron_sword="iron_sword",m.steel_sword="steel_sword",m.rifle="rifle",function(e){e.medicine="medicine",e.charm="charm",e.bayonet="bayonet",e.bolas="bolas",e.grenade="grenade",e.bullets="bullets",e.cured_meat="cured_meat",e.laser_rifle="laser_rifle",e.energy_cell="energy_cell"}(g||(g={})),(v=e.WorkerType||(e.WorkerType={})).sulphur_miner="sulphur_miner",v.hunter="hunter",v.trapper="trapper",v.charcutier="charcutier",v.iron_miner="iron_miner",v.coal_miner="coal_miner",v.armourer="armourer",v.tanner="tanner",v.steelworker="steelworker";var b={gatherer:{name:d("gatherer"),delay:10,stores:{wood:1}},hunter:{name:d("hunter"),delay:10,stores:{fur:.5,meat:.5}},trapper:{name:d("trapper"),delay:10,stores:{meat:-1,bait:1}},tanner:{name:d("tanner"),delay:10,stores:{fur:-5,leather:1}},charcutier:{name:d("charcutier"),delay:10,stores:{meat:-5,wood:-5,cured_meat:1}},iron_miner:{name:d("iron miner"),delay:10,stores:{cured_meat:-1,iron:1}},coal_miner:{name:d("coal miner"),delay:10,stores:{cured_meat:-1,coal:1}},sulphur_miner:{name:d("sulphur miner"),delay:10,stores:{cured_meat:-1,sulphur:1}},steelworker:{name:d("steelworker"),delay:10,stores:{iron:-1,coal:-1,steel:1}},armourer:{name:d("armourer"),delay:10,stores:{steel:-1,sulphur:-1,bullets:1}}};function x(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function w(e){return!!e&&!!e[ce]}function S(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===se}(e)||Array.isArray(e)||!!e[ie]||!!e.constructor[ie]||L(e)||W(e))}function _(e,t,n){void 0===n&&(n=!1),0===E(e)?(n?Object.keys:ue)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function E(e){var t=e[ce];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:L(e)?2:W(e)?3:0}function O(e,t){return 2===E(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function k(e,t,n){var r=E(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function A(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function L(e){return ne&&e instanceof Map}function W(e){return re&&e instanceof Set}function D(e){return e.o||e.t}function M(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=le(e);delete t[ce];for(var n=ue(t),r=0;r<n.length;r++){var a=n[r],o=t[a];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(Object.getPrototypeOf(e),t)}function R(e,t){return void 0===t&&(t=!1),j(e)||w(e)||!S(e)||(E(e)>1&&(e.set=e.add=e.clear=e.delete=C),Object.freeze(e),t&&_(e,(function(e,t){return R(t,!0)}),!0)),e}function C(){x(2)}function j(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function P(e){var t=fe[e];return t||x(18,e),t}function T(){return ee}function N(e,t){t&&(P("Patches"),e.u=[],e.s=[],e.v=t)}function I(e){F(e),e.p.forEach(V),e.p=null}function F(e){e===ee&&(ee=e.l)}function G(e){return ee={p:[],l:ee,h:e,m:!0,_:0}}function V(e){var t=e[ce];0===t.i||1===t.i?t.j():t.O=!0}function U(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.g||P("ES5").S(t,e,r),r?(n[ce].P&&(I(t),x(4)),S(e)&&(e=B(t,e),t.l||z(t,e)),t.u&&P("Patches").M(n[ce],e,t.u,t.s)):e=B(t,n,[]),I(t),t.u&&t.v(t.u,t.s),e!==oe?e:void 0}function B(e,t,n){if(j(t))return t;var r=t[ce];if(!r)return _(t,(function(a,o){return H(e,r,t,a,o,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return z(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var a=4===r.i||5===r.i?r.o=M(r.k):r.o;_(3===r.i?new Set(a):a,(function(t,o){return H(e,r,a,t,o,n)})),z(e,a,!1),n&&e.u&&P("Patches").R(r,n,e.u,e.s)}return r.o}function H(e,t,n,r,a,o){if(w(a)){var i=B(e,a,o&&t&&3!==t.i&&!O(t.D,r)?o.concat(r):void 0);if(k(n,r,i),!w(i))return;e.m=!1}if(S(a)&&!j(a)){if(!e.h.F&&e._<1)return;B(e,a),t&&t.A.l||z(e,a)}}function z(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&R(t,n)}function $(e,t){var n=e[ce];return(n?D(n):e)[t]}function q(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function Y(e){e.P||(e.P=!0,e.l&&Y(e.l))}function K(e){e.o||(e.o=M(e.t))}function J(e,t,n){var r=L(t)?P("MapSet").N(t,n):W(t)?P("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:T(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},a=r,o=he;n&&(a=[r],o=de);var i=Proxy.revocable(a,o),c=i.revoke,s=i.proxy;return r.k=s,r.j=c,s}(t,n):P("ES5").J(t,n);return(n?n.A:T()).p.push(r),r}function Z(e){return w(e)||x(22,e),function e(t){if(!S(t))return t;var n,r=t[ce],a=E(t);if(r){if(!r.P&&(r.i<4||!P("ES5").K(r)))return r.t;r.I=!0,n=Q(t,a),r.I=!1}else n=Q(t,a);return _(n,(function(t,a){r&&function(e,t){return 2===E(e)?e.get(t):e[t]}(r.t,t)===a||k(n,t,e(a))})),3===a?new Set(n):n}(e)}function Q(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return M(e)}var X,ee,te="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),ne="undefined"!=typeof Map,re="undefined"!=typeof Set,ae="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,oe=te?Symbol.for("immer-nothing"):((X={})["immer-nothing"]=!0,X),ie=te?Symbol.for("immer-draftable"):"__$immer_draftable",ce=te?Symbol.for("immer-state"):"__$immer_state",se=""+Object.prototype.constructor,ue="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,le=Object.getOwnPropertyDescriptors||function(e){var t={};return ue(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},fe={},he={get:function(e,t){if(t===ce)return e;var n=D(e);if(!O(n,t))return function(e,t,n){var r,a=q(t,n);return a?"value"in a?a.value:null===(r=a.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!S(r)?r:r===$(e.t,t)?(K(e),e.o[t]=J(e.A.h,r,e)):r},has:function(e,t){return t in D(e)},ownKeys:function(e){return Reflect.ownKeys(D(e))},set:function(e,t,n){var r=q(D(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var a=$(D(e),t),o=null==a?void 0:a[ce];if(o&&o.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(A(n,a)&&(void 0!==n||O(e.t,t)))return!0;K(e),Y(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==$(e.t,t)||t in e.t?(e.D[t]=!1,K(e),Y(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=D(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){x(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){x(12)}},de={};_(he,(function(e,t){de[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),de.deleteProperty=function(e,t){return he.deleteProperty.call(this,e[0],t)},de.set=function(e,t,n){return he.set.call(this,e[0],t,n,e[0])};var pe=new(function(){function e(e){var t=this;this.g=ae,this.F=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var a=n;n=e;var o=t;return function(e){var t=this;void 0===e&&(e=a);for(var r=arguments.length,i=Array(r>1?r-1:0),c=1;c<r;c++)i[c-1]=arguments[c];return o.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(i))}))}}var i;if("function"!=typeof n&&x(6),void 0!==r&&"function"!=typeof r&&x(7),S(e)){var c=G(t),s=J(t,e,void 0),u=!0;try{i=n(s),u=!1}finally{u?I(c):F(c)}return"undefined"!=typeof Promise&&i instanceof Promise?i.then((function(e){return N(c,r),U(e,c)}),(function(e){throw I(c),e})):(N(c,r),U(i,c))}if(!e||"object"!=typeof e){if((i=n(e))===oe)return;return void 0===i&&(i=e),t.F&&R(i,!0),i}x(21,e)},this.produceWithPatches=function(e,n){return"function"==typeof e?function(n){for(var r=arguments.length,a=Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(a))}))}:[t.produce(e,n,(function(e,t){r=e,a=t})),r,a];var r,a},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){S(e)||x(8),w(e)&&(e=Z(e));var t=G(this),n=J(this,e,void 0);return n[ce].C=!0,F(t),n},t.finishDraft=function(e,t){var n=(e&&e[ce]).A;return N(n,t),U(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!ae&&x(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var a=P("Patches").$;return w(e)?a(e,t):this.produce(e,(function(e){return a(e,t)}))},e}()),me=pe.produce;function ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){ge(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function be(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}pe.produceWithPatches.bind(pe),pe.setAutoFreeze.bind(pe),pe.setUseProxies.bind(pe),pe.applyPatches.bind(pe),pe.createDraft.bind(pe),pe.finishDraft.bind(pe);var xe="function"==typeof Symbol&&Symbol.observable||"@@observable",we=function(){return Math.random().toString(36).substring(7).split("").join(".")},Se={INIT:"@@redux/INIT"+we(),REPLACE:"@@redux/REPLACE"+we(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+we()}};function _e(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Ee(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(be(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(be(1));return n(Ee)(e,t)}if("function"!=typeof e)throw new Error(be(2));var a=e,o=t,i=[],c=i,s=!1;function u(){c===i&&(c=i.slice())}function l(){if(s)throw new Error(be(3));return o}function f(e){if("function"!=typeof e)throw new Error(be(4));if(s)throw new Error(be(5));var t=!0;return u(),c.push(e),function(){if(t){if(s)throw new Error(be(6));t=!1,u();var n=c.indexOf(e);c.splice(n,1),i=null}}}function h(e){if(!_e(e))throw new Error(be(7));if(void 0===e.type)throw new Error(be(8));if(s)throw new Error(be(9));try{s=!0,o=a(o,e)}finally{s=!1}for(var t=i=c,n=0;n<t.length;n++)(0,t[n])();return e}function d(e){if("function"!=typeof e)throw new Error(be(10));a=e,h({type:Se.REPLACE})}function p(){var e,t=f;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(be(11));function n(){e.next&&e.next(l())}return n(),{unsubscribe:t(n)}}})[xe]=function(){return this},e}return h({type:Se.INIT}),(r={dispatch:h,subscribe:f,getState:l,replaceReducer:d})[xe]=p,r}function Oe(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var a=t[r];"function"==typeof e[a]&&(n[a]=e[a])}var o,i=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:Se.INIT}))throw new Error(be(12));if(void 0===n(void 0,{type:Se.PROBE_UNKNOWN_ACTION()}))throw new Error(be(13))}))}(n)}catch(e){o=e}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var r=!1,a={},c=0;c<i.length;c++){var s=i[c],u=e[s],l=(0,n[s])(u,t);if(void 0===l)throw new Error(be(14));a[s]=l,r=r||l!==u}return(r=r||i.length!==Object.keys(e).length)?a:e}}function ke(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function Ae(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(be(15))},a={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},o=t.map((function(e){return e(a)}));return r=ke.apply(void 0,o)(n.dispatch),ye(ye({},n),{},{dispatch:r})}}}function Le(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(a){return"function"==typeof a?a(n,r,e):t(a)}}}}var We=Le();We.withExtraArgument=Le;var De,Me=(De=function(e,t){return(De=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}De(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Re=function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e},Ce=Object.defineProperty,je=Object.defineProperties,Pe=Object.getOwnPropertyDescriptors,Te=Object.getOwnPropertySymbols,Ne=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable,Fe=function(e,t,n){return t in e?Ce(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},Ge=function(e,t){for(var n in t||(t={}))Ne.call(t,n)&&Fe(e,n,t[n]);if(Te)for(var r=0,a=Te(t);r<a.length;r++)Ie.call(t,n=a[r])&&Fe(e,n,t[n]);return e},Ve=function(e,t){return je(e,Pe(t))},Ue="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?ke:ke.apply(null,arguments)},Be=function(e){function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var a=e.apply(this,n)||this;return Object.setPrototypeOf(a,t.prototype),a}return Me(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,Re([void 0],e[0].concat(this)))):new(t.bind.apply(t,Re([void 0],e.concat(this))))},t}(Array);function He(e){var t,n=function(e){return function(e){void 0===e&&(e={});var t=e.thunk,n=void 0===t||t,r=new Be;return n&&(function(e){return"boolean"==typeof e}(n)?r.push(We):r.push(We.withExtraArgument(n.extraArgument))),r}(e)},r=e||{},a=r.reducer,o=void 0===a?void 0:a,i=r.middleware,c=void 0===i?n():i,s=r.devTools,u=void 0===s||s,l=r.preloadedState,f=void 0===l?void 0:l,h=r.enhancers,d=void 0===h?void 0:h;if("function"==typeof o)t=o;else{if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(o))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=Oe(o)}var p=c;"function"==typeof p&&(p=p(n));var m=Ae.apply(void 0,p),g=ke;u&&(g=Ue(Ge({trace:!1},"object"==typeof u&&u)));var v=[m];return Array.isArray(d)?v=Re([m],d):"function"==typeof d&&(v=d(v)),Ee(t,f,g.apply(void 0,v))}function ze(e,t){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(t){var a=t.apply(void 0,n);if(!a)throw new Error("prepareAction did not return an object");return Ge(Ge({type:e,payload:a.payload},"meta"in a&&{meta:a.meta}),"error"in a&&{error:a.error})}return{type:e,payload:n[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(t){return t.type===e},n}function $e(e){var t,n={},r=[],a={addCase:function(e,t){var r="string"==typeof e?e:e.type;if(r in n)throw new Error("addCase cannot be called with two reducers for the same action type");return n[r]=t,a},addMatcher:function(e,t){return r.push({matcher:e,reducer:t}),a},addDefaultCase:function(e){return t=e,a}};return e(a),[n,r,t]}function qe(e){var t=e.name,n=e.initialState;if(!t)throw new Error("`name` is a required option for createSlice");var r=e.reducers||{},a="function"==typeof e.extraReducers?$e(e.extraReducers):[e.extraReducers],o=a[0],i=void 0===o?{}:o,c=a[1],s=void 0===c?[]:c,u=a[2],l=void 0===u?void 0:u,f=Object.keys(r),h={},d={},p={};f.forEach((function(e){var n,a,o=r[e],i=function(e,t){return e+"/"+t}(t,e);"reducer"in o?(n=o.reducer,a=o.prepare):n=o,h[e]=n,d[i]=n,p[e]=a?ze(i,a):ze(i)}));var m=function(e,t,n,r){void 0===n&&(n=[]);var a="function"==typeof t?$e(t):[t,n,r],o=a[0],i=a[1],c=a[2],s=me(e,(function(){}));return function(e,t){void 0===e&&(e=s);var n=Re([o[t.type]],i.filter((function(e){return(0,e.matcher)(t)})).map((function(e){return e.reducer})));return 0===n.filter((function(e){return!!e})).length&&(n=[c]),n.reduce((function(e,n){if(n){var r;if(w(e))return void 0===(r=n(e,t))?e:r;if(S(e))return me(e,(function(e){return n(e,t)}));if(void 0===(r=n(e,t))){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}return e}),e)}}(n,Ge(Ge({},i),d),s,l);return{name:t,reducer:m,actions:p,caseReducers:h}}var Ye=function(e){void 0===e&&(e=21);for(var t="",n=e;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t},Ke=["name","message","stack","code"],Je=function(e,t){this.payload=e,this.meta=t},Ze=function(e,t){this.payload=e,this.meta=t},Qe=function(e){if("object"==typeof e&&null!==e){for(var t={},n=0,r=Ke;n<r.length;n++){var a=r[n];"string"==typeof e[a]&&(t[a]=e[a])}return t}return{message:String(e)}};function Xe(e,t,n){var r=ze(e+"/fulfilled",(function(e,t,n,r){return{payload:e,meta:Ve(Ge({},r||{}),{arg:n,requestId:t,requestStatus:"fulfilled"})}})),a=ze(e+"/pending",(function(e,t,n){return{payload:void 0,meta:Ve(Ge({},n||{}),{arg:t,requestId:e,requestStatus:"pending"})}})),o=ze(e+"/rejected",(function(e,t,r,a,o){return{payload:a,error:(n&&n.serializeError||Qe)(e||"Rejected"),meta:Ve(Ge({},o||{}),{arg:r,requestId:t,rejectedWithValue:!!a,requestStatus:"rejected",aborted:"AbortError"===(null==e?void 0:e.name),condition:"ConditionError"===(null==e?void 0:e.name)})}})),i="undefined"!=typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){}}}return e.prototype.abort=function(){},e}();return Object.assign((function(e){return function(c,s,u){var l,f,h=(null!=(l=null==n?void 0:n.idGenerator)?l:Ye)(),d=new i,p=new Promise((function(e,t){return d.signal.addEventListener("abort",(function(){return t({name:"AbortError",message:f||"Aborted"})}))})),m=!1,g=function(){return i=this,l=function(){var i,l,f;return function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}(this,(function(g){switch(g.label){case 0:if(g.trys.push([0,2,,3]),n&&n.condition&&!1===n.condition(e,{getState:s,extra:u}))throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return m=!0,c(a(h,e,null==(i=null==n?void 0:n.getPendingMeta)?void 0:i.call(n,{requestId:h,arg:e},{getState:s,extra:u}))),[4,Promise.race([p,Promise.resolve(t(e,{dispatch:c,getState:s,extra:u,requestId:h,signal:d.signal,rejectWithValue:function(e,t){return new Je(e,t)},fulfillWithValue:function(e,t){return new Ze(e,t)}})).then((function(t){if(t instanceof Je)throw t;return t instanceof Ze?r(t.payload,h,e,t.meta):r(t,h,e)}))])];case 1:return l=g.sent(),[3,3];case 2:return f=g.sent(),l=f instanceof Je?o(null,h,e,f.payload,f.meta):o(f,h,e),[3,3];case 3:return n&&!n.dispatchConditionRejection&&o.match(l)&&l.meta.condition||c(l),[2,l]}}))},new Promise((function(e,t){var n=function(e){try{a(l.next(e))}catch(e){t(e)}},r=function(e){try{a(l.throw(e))}catch(e){t(e)}},a=function(t){return t.done?e(t.value):Promise.resolve(t.value).then(n,r)};a((l=l.apply(i,null)).next())}));var i,l}();return Object.assign(g,{abort:function(e){m&&(f=e,d.abort())},requestId:h,arg:e,unwrap:function(){return g.then(et)}})}}),{pending:a,rejected:o,fulfilled:r,typePrefix:e})}function et(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}!function(){function e(e,t){var n=a[e];return n?n.enumerable=t:a[e]=n={configurable:!0,enumerable:t,get:function(){return he.get(this[ce],e)},set:function(t){he.set(this[ce],e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var a=e[t][ce];if(!a.P)switch(a.i){case 5:r(a)&&Y(a);break;case 4:n(a)&&Y(a)}}}function n(e){for(var t=e.t,n=e.k,r=ue(n),a=r.length-1;a>=0;a--){var o=r[a];if(o!==ce){var i=t[o];if(void 0===i&&!O(t,o))return!0;var c=n[o],s=c&&c[ce];if(s?s.t!==i:!A(c,i))return!0}}var u=!!t[ce];return r.length!==ue(t).length+(u?0:1)}function r(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!n||n.get)}var a={};!function(e,t){fe.ES5||(fe.ES5=t)}(0,{J:function(t,n){var r=Array.isArray(t),a=function(t,n){if(t){for(var r=Array(n.length),a=0;a<n.length;a++)Object.defineProperty(r,""+a,e(a,!0));return r}var o=le(n);delete o[ce];for(var i=ue(o),c=0;c<i.length;c++){var s=i[c];o[s]=e(s,t||!!o[s].enumerable)}return Object.create(Object.getPrototypeOf(n),o)}(r,t),o={i:r?5:4,A:n?n.A:T(),P:!1,I:!1,D:{},l:n,t:t,k:a,o:null,O:!1,C:!1};return Object.defineProperty(a,ce,{value:o,writable:!0}),a},S:function(e,n,a){a?w(n)&&n[ce].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[ce];if(n){var a=n.t,o=n.k,i=n.D,c=n.i;if(4===c)_(o,(function(t){t!==ce&&(void 0!==a[t]||O(a,t)?i[t]||e(o[t]):(i[t]=!0,Y(n)))})),_(a,(function(e){void 0!==o[e]||O(o,e)||(i[e]=!1,Y(n))}));else if(5===c){if(r(n)&&(Y(n),i.length=!0),o.length<a.length)for(var s=o.length;s<a.length;s++)i[s]=!1;else for(var u=a.length;u<o.length;u++)i[u]=!0;for(var l=Math.min(o.length,a.length),f=0;f<l;f++)void 0===i[f]&&e(o[f])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):r(e)}})}();var tt,nt,rt,at,ot,it,ct,st,ut,lt,ft,ht,dt,pt,mt,gt,vt=qe({name:"marketing",initialState:{penrose:!1},reducers:{changePenrose:function(e,t){e.penrose=t.payload}}}),yt=vt.actions,bt=vt.reducer,xt=qe({name:"config",initialState:{hyperMode:!1,soundOn:!1},reducers:{changeHyperMode:function(e,t){e.hyperMode=t.payload},changeSound:function(e,t){e.soundOn=t.payload}}}),wt=xt.actions,St=xt.reducer,_t=qe({name:"location",initialState:{Outside:!1,Room:!1,Ship:!1,World:!1,Path:!1},reducers:{enableOutside:function(e){e.Outside=!0},enableRoom:function(e){e.Room=!0},enableSpaceShip:function(e){e.Ship=!0},enableWorld:function(e){e.World=!0},enablePath:function(e){e.Path=!0}}}),Et=_t.actions,Ot=Oe({location:_t.reducer}),kt={location:Et},At=c((function(e,t){(function(){var n="Expected a function",r="__lodash_placeholder__",a=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],o="[object Arguments]",c="[object Array]",s="[object Boolean]",u="[object Date]",l="[object Error]",f="[object Function]",h="[object GeneratorFunction]",d="[object Map]",p="[object Number]",m="[object Object]",g="[object RegExp]",v="[object Set]",y="[object String]",b="[object Symbol]",x="[object WeakMap]",w="[object ArrayBuffer]",S="[object DataView]",_="[object Float32Array]",E="[object Float64Array]",O="[object Int8Array]",k="[object Int16Array]",A="[object Int32Array]",L="[object Uint8Array]",W="[object Uint16Array]",D="[object Uint32Array]",M=/\b__p \+= '';/g,R=/\b(__p \+=) '' \+/g,C=/(__e\(.*?\)|\b__t\)) \+\n'';/g,j=/&(?:amp|lt|gt|quot|#39);/g,P=/[&<>"']/g,T=RegExp(j.source),N=RegExp(P.source),I=/<%-([\s\S]+?)%>/g,F=/<%([\s\S]+?)%>/g,G=/<%=([\s\S]+?)%>/g,V=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,U=/^\w*$/,B=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,H=/[\\^$.*+?()[\]{}|]/g,z=RegExp(H.source),$=/^\s+/,q=/\s/,Y=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,K=/\{\n\/\* \[wrapped with (.+)\] \*/,J=/,? & /,Z=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Q=/[()=,{}\[\]\/\s]/,X=/\\(\\)?/g,ee=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,te=/\w*$/,ne=/^[-+]0x[0-9a-f]+$/i,re=/^0b[01]+$/i,ae=/^\[object .+?Constructor\]$/,oe=/^0o[0-7]+$/i,ie=/^(?:0|[1-9]\d*)$/,ce=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,se=/($^)/,ue=/['\n\r\u2028\u2029\\]/g,le="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",fe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",he="["+fe+"]",de="["+le+"]",pe="\\d+",me="[a-z\\xdf-\\xf6\\xf8-\\xff]",ge="[^\\ud800-\\udfff"+fe+pe+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",ve="\\ud83c[\\udffb-\\udfff]",ye="[^\\ud800-\\udfff]",be="(?:\\ud83c[\\udde6-\\uddff]){2}",xe="[\\ud800-\\udbff][\\udc00-\\udfff]",we="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Se="(?:"+me+"|"+ge+")",_e="(?:"+we+"|"+ge+")",Ee="(?:"+de+"|"+ve+")?",Oe="[\\ufe0e\\ufe0f]?"+Ee+"(?:\\u200d(?:"+[ye,be,xe].join("|")+")[\\ufe0e\\ufe0f]?"+Ee+")*",ke="(?:"+["[\\u2700-\\u27bf]",be,xe].join("|")+")"+Oe,Ae="(?:"+[ye+de+"?",de,be,xe,"[\\ud800-\\udfff]"].join("|")+")",Le=RegExp("['’]","g"),We=RegExp(de,"g"),De=RegExp(ve+"(?="+ve+")|"+Ae+Oe,"g"),Me=RegExp([we+"?"+me+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[he,we,"$"].join("|")+")",_e+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[he,we+Se,"$"].join("|")+")",we+"?"+Se+"+(?:['’](?:d|ll|m|re|s|t|ve))?",we+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",pe,ke].join("|"),"g"),Re=RegExp("[\\u200d\\ud800-\\udfff"+le+"\\ufe0e\\ufe0f]"),Ce=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,je=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Pe=-1,Te={};Te[_]=Te[E]=Te[O]=Te[k]=Te[A]=Te[L]=Te["[object Uint8ClampedArray]"]=Te[W]=Te[D]=!0,Te[o]=Te[c]=Te[w]=Te[s]=Te[S]=Te[u]=Te[l]=Te[f]=Te[d]=Te[p]=Te[m]=Te[g]=Te[v]=Te[y]=Te[x]=!1;var Ne={};Ne[o]=Ne[c]=Ne[w]=Ne[S]=Ne[s]=Ne[u]=Ne[_]=Ne[E]=Ne[O]=Ne[k]=Ne[A]=Ne[d]=Ne[p]=Ne[m]=Ne[g]=Ne[v]=Ne[y]=Ne[b]=Ne[L]=Ne["[object Uint8ClampedArray]"]=Ne[W]=Ne[D]=!0,Ne[l]=Ne[f]=Ne[x]=!1;var Ie={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Fe=parseFloat,Ge=parseInt,Ve="object"==typeof i&&i&&i.Object===Object&&i,Ue="object"==typeof self&&self&&self.Object===Object&&self,Be=Ve||Ue||Function("return this")(),He=t&&!t.nodeType&&t,ze=He&&e&&!e.nodeType&&e,$e=ze&&ze.exports===He,qe=$e&&Ve.process,Ye=function(){try{return ze&&ze.require&&ze.require("util").types||qe&&qe.binding&&qe.binding("util")}catch(e){}}(),Ke=Ye&&Ye.isArrayBuffer,Je=Ye&&Ye.isDate,Ze=Ye&&Ye.isMap,Qe=Ye&&Ye.isRegExp,Xe=Ye&&Ye.isSet,et=Ye&&Ye.isTypedArray;function tt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function nt(e,t,n,r){for(var a=-1,o=null==e?0:e.length;++a<o;){var i=e[a];t(r,i,n(i),e)}return r}function rt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function at(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function ot(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function it(e,t){for(var n=-1,r=null==e?0:e.length,a=0,o=[];++n<r;){var i=e[n];t(i,n,e)&&(o[a++]=i)}return o}function ct(e,t){return!(null==e||!e.length)&&vt(e,t,0)>-1}function st(e,t,n){for(var r=-1,a=null==e?0:e.length;++r<a;)if(n(t,e[r]))return!0;return!1}function ut(e,t){for(var n=-1,r=null==e?0:e.length,a=Array(r);++n<r;)a[n]=t(e[n],n,e);return a}function lt(e,t){for(var n=-1,r=t.length,a=e.length;++n<r;)e[a+n]=t[n];return e}function ft(e,t,n,r){var a=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++a]);++a<o;)n=t(n,e[a],a,e);return n}function ht(e,t,n,r){var a=null==e?0:e.length;for(r&&a&&(n=e[--a]);a--;)n=t(n,e[a],a,e);return n}function dt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var pt=wt("length");function mt(e,t,n){var r;return n(e,(function(e,n,a){if(t(e,n,a))return r=n,!1})),r}function gt(e,t,n,r){for(var a=e.length,o=n+(r?1:-1);r?o--:++o<a;)if(t(e[o],o,e))return o;return-1}function vt(e,t,n){return t==t?function(e,t,n){for(var r=n-1,a=e.length;++r<a;)if(e[r]===t)return r;return-1}(e,t,n):gt(e,bt,n)}function yt(e,t,n,r){for(var a=n-1,o=e.length;++a<o;)if(r(e[a],t))return a;return-1}function bt(e){return e!=e}function xt(e,t){var n=null==e?0:e.length;return n?Et(e,t)/n:NaN}function wt(e){return function(t){return null==t?void 0:t[e]}}function St(e){return function(t){return null==e?void 0:e[t]}}function _t(e,t,n,r,a){return a(e,(function(e,a,o){n=r?(r=!1,e):t(n,e,a,o)})),n}function Et(e,t){for(var n,r=-1,a=e.length;++r<a;){var o=t(e[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n}function Ot(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function kt(e){return e?e.slice(0,Ht(e)+1).replace($,""):e}function At(e){return function(t){return e(t)}}function Lt(e,t){return ut(t,(function(t){return e[t]}))}function Wt(e,t){return e.has(t)}function Dt(e,t){for(var n=-1,r=e.length;++n<r&&vt(t,e[n],0)>-1;);return n}function Mt(e,t){for(var n=e.length;n--&&vt(t,e[n],0)>-1;);return n}function Rt(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var Ct=St({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),jt=St({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Pt(e){return"\\"+Ie[e]}function Tt(e){return Re.test(e)}function Nt(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function It(e,t){return function(n){return e(t(n))}}function Ft(e,t){for(var n=-1,a=e.length,o=0,i=[];++n<a;){var c=e[n];c!==t&&c!==r||(e[n]=r,i[o++]=n)}return i}function Gt(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function Vt(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function Ut(e){return Tt(e)?function(e){for(var t=De.lastIndex=0;De.test(e);)++t;return t}(e):pt(e)}function Bt(e){return Tt(e)?function(e){return e.match(De)||[]}(e):function(e){return e.split("")}(e)}function Ht(e){for(var t=e.length;t--&&q.test(e.charAt(t)););return t}var zt=St({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),$t=function e(t){var i,q=(t=null==t?Be:$t.defaults(Be.Object(),t,$t.pick(Be,je))).Array,le=t.Date,fe=t.Error,he=t.Function,de=t.Math,pe=t.Object,me=t.RegExp,ge=t.String,ve=t.TypeError,ye=q.prototype,be=pe.prototype,xe=t["__core-js_shared__"],we=he.prototype.toString,Se=be.hasOwnProperty,_e=0,Ee=(i=/[^.]+$/.exec(xe&&xe.keys&&xe.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",Oe=be.toString,ke=we.call(pe),Ae=Be._,De=me("^"+we.call(Se).replace(H,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Re=$e?t.Buffer:void 0,Ie=t.Symbol,Ve=t.Uint8Array,Ue=Re?Re.allocUnsafe:void 0,He=It(pe.getPrototypeOf,pe),ze=pe.create,qe=be.propertyIsEnumerable,Ye=ye.splice,pt=Ie?Ie.isConcatSpreadable:void 0,St=Ie?Ie.iterator:void 0,qt=Ie?Ie.toStringTag:void 0,Yt=function(){try{var e=Qa(pe,"defineProperty");return e({},"",{}),e}catch(e){}}(),Kt=t.clearTimeout!==Be.clearTimeout&&t.clearTimeout,Jt=le&&le.now!==Be.Date.now&&le.now,Zt=t.setTimeout!==Be.setTimeout&&t.setTimeout,Qt=de.ceil,Xt=de.floor,en=pe.getOwnPropertySymbols,tn=Re?Re.isBuffer:void 0,nn=t.isFinite,rn=ye.join,an=It(pe.keys,pe),on=de.max,cn=de.min,sn=le.now,un=t.parseInt,ln=de.random,fn=ye.reverse,hn=Qa(t,"DataView"),dn=Qa(t,"Map"),pn=Qa(t,"Promise"),mn=Qa(t,"Set"),gn=Qa(t,"WeakMap"),vn=Qa(pe,"create"),yn=gn&&new gn,bn={},xn=ko(hn),wn=ko(dn),Sn=ko(pn),_n=ko(mn),En=ko(gn),On=Ie?Ie.prototype:void 0,kn=On?On.valueOf:void 0,An=On?On.toString:void 0;function Ln(e){if(Bi(e)&&!Ri(e)&&!(e instanceof Rn)){if(e instanceof Mn)return e;if(Se.call(e,"__wrapped__"))return Ao(e)}return new Mn(e)}var Wn=function(){function e(){}return function(t){if(!Ui(t))return{};if(ze)return ze(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Dn(){}function Mn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function Rn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Cn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function jn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Pn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Tn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Pn;++t<n;)this.add(e[t])}function Nn(e){var t=this.__data__=new jn(e);this.size=t.size}function In(e,t){var n=Ri(e),r=!n&&Mi(e),a=!n&&!r&&Ti(e),o=!n&&!r&&!a&&Zi(e),i=n||r||a||o,c=i?Ot(e.length,ge):[],s=c.length;for(var u in e)!t&&!Se.call(e,u)||i&&("length"==u||a&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||oo(u,s))||c.push(u);return c}function Fn(e){var t=e.length;return t?e[Pr(0,t-1)]:void 0}function Gn(e,t){return _o(ga(e),Kn(t,0,e.length))}function Vn(e){return _o(ga(e))}function Un(e,t,n){(void 0!==n&&!Li(e[t],n)||void 0===n&&!(t in e))&&qn(e,t,n)}function Bn(e,t,n){var r=e[t];Se.call(e,t)&&Li(r,n)&&(void 0!==n||t in e)||qn(e,t,n)}function Hn(e,t){for(var n=e.length;n--;)if(Li(e[n][0],t))return n;return-1}function zn(e,t,n,r){return er(e,(function(e,a,o){t(r,e,n(e),o)})),r}function $n(e,t){return e&&va(t,bc(t),e)}function qn(e,t,n){"__proto__"==t&&Yt?Yt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Yn(e,t){for(var n=-1,r=t.length,a=q(r),o=null==e;++n<r;)a[n]=o?void 0:pc(e,t[n]);return a}function Kn(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function Jn(e,t,n,r,a,i){var c,l=1&t,x=2&t,M=4&t;if(n&&(c=a?n(e,r,a,i):n(e)),void 0!==c)return c;if(!Ui(e))return e;var R=Ri(e);if(R){if(c=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Se.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!l)return ga(e,c)}else{var C=to(e),j=C==f||C==h;if(Ti(e))return la(e,l);if(C==m||C==o||j&&!a){if(c=x||j?{}:ro(e),!l)return x?function(e,t){return va(e,eo(e),t)}(e,function(e,t){return e&&va(t,xc(t),e)}(c,e)):function(e,t){return va(e,Xa(e),t)}(e,$n(c,e))}else{if(!Ne[C])return a?e:{};c=function(e,t,n){var r=e.constructor;switch(t){case w:return fa(e);case s:case u:return new r(+e);case S:return function(e,t){var n=t?fa(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case _:case E:case O:case k:case A:case L:case"[object Uint8ClampedArray]":case W:case D:return ha(e,n);case d:return new r;case p:case y:return new r(e);case g:return function(e){var t=new e.constructor(e.source,te.exec(e));return t.lastIndex=e.lastIndex,t}(e);case v:return new r;case b:return kn?pe(kn.call(e)):{}}}(e,C,l)}}i||(i=new Nn);var P=i.get(e);if(P)return P;i.set(e,c),Yi(e)?e.forEach((function(r){c.add(Jn(r,t,n,r,e,i))})):Hi(e)&&e.forEach((function(r,a){c.set(a,Jn(r,t,n,a,e,i))}));var T=R?void 0:(M?x?za:Ha:x?xc:bc)(e);return rt(T||e,(function(r,a){T&&(r=e[a=r]),Bn(c,a,Jn(r,t,n,a,e,i))})),c}function Zn(e,t,n){var r=n.length;if(null==e)return!r;for(e=pe(e);r--;){var a=n[r],o=e[a];if(void 0===o&&!(a in e)||!(0,t[a])(o))return!1}return!0}function Qn(e,t,r){if("function"!=typeof e)throw new ve(n);return bo((function(){e.apply(void 0,r)}),t)}function Xn(e,t,n,r){var a=-1,o=ct,i=!0,c=e.length,s=[],u=t.length;if(!c)return s;n&&(t=ut(t,At(n))),r?(o=st,i=!1):t.length>=200&&(o=Wt,i=!1,t=new Tn(t));e:for(;++a<c;){var l=e[a],f=null==n?l:n(l);if(l=r||0!==l?l:0,i&&f==f){for(var h=u;h--;)if(t[h]===f)continue e;s.push(l)}else o(t,f,r)||s.push(l)}return s}Ln.templateSettings={escape:I,evaluate:F,interpolate:G,variable:"",imports:{_:Ln}},(Ln.prototype=Dn.prototype).constructor=Ln,(Mn.prototype=Wn(Dn.prototype)).constructor=Mn,(Rn.prototype=Wn(Dn.prototype)).constructor=Rn,Cn.prototype.clear=function(){this.__data__=vn?vn(null):{},this.size=0},Cn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Cn.prototype.get=function(e){var t=this.__data__;if(vn){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Se.call(t,e)?t[e]:void 0},Cn.prototype.has=function(e){var t=this.__data__;return vn?void 0!==t[e]:Se.call(t,e)},Cn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=vn&&void 0===t?"__lodash_hash_undefined__":t,this},jn.prototype.clear=function(){this.__data__=[],this.size=0},jn.prototype.delete=function(e){var t=this.__data__,n=Hn(t,e);return!(n<0||(n==t.length-1?t.pop():Ye.call(t,n,1),--this.size,0))},jn.prototype.get=function(e){var t=this.__data__,n=Hn(t,e);return n<0?void 0:t[n][1]},jn.prototype.has=function(e){return Hn(this.__data__,e)>-1},jn.prototype.set=function(e,t){var n=this.__data__,r=Hn(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Pn.prototype.clear=function(){this.size=0,this.__data__={hash:new Cn,map:new(dn||jn),string:new Cn}},Pn.prototype.delete=function(e){var t=Ja(this,e).delete(e);return this.size-=t?1:0,t},Pn.prototype.get=function(e){return Ja(this,e).get(e)},Pn.prototype.has=function(e){return Ja(this,e).has(e)},Pn.prototype.set=function(e,t){var n=Ja(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Tn.prototype.add=Tn.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Tn.prototype.has=function(e){return this.__data__.has(e)},Nn.prototype.clear=function(){this.__data__=new jn,this.size=0},Nn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Nn.prototype.get=function(e){return this.__data__.get(e)},Nn.prototype.has=function(e){return this.__data__.has(e)},Nn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof jn){var r=n.__data__;if(!dn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Pn(r)}return n.set(e,t),this.size=n.size,this};var er=xa(sr),tr=xa(ur,!0);function nr(e,t){var n=!0;return er(e,(function(e,r,a){return n=!!t(e,r,a)})),n}function rr(e,t,n){for(var r=-1,a=e.length;++r<a;){var o=e[r],i=t(o);if(null!=i&&(void 0===c?i==i&&!Ji(i):n(i,c)))var c=i,s=o}return s}function ar(e,t){var n=[];return er(e,(function(e,r,a){t(e,r,a)&&n.push(e)})),n}function or(e,t,n,r,a){var o=-1,i=e.length;for(n||(n=ao),a||(a=[]);++o<i;){var c=e[o];t>0&&n(c)?t>1?or(c,t-1,n,r,a):lt(a,c):r||(a[a.length]=c)}return a}var ir=wa(),cr=wa(!0);function sr(e,t){return e&&ir(e,t,bc)}function ur(e,t){return e&&cr(e,t,bc)}function lr(e,t){return it(t,(function(t){return Fi(e[t])}))}function fr(e,t){for(var n=0,r=(t=ia(t,e)).length;null!=e&&n<r;)e=e[Oo(t[n++])];return n&&n==r?e:void 0}function hr(e,t,n){var r=t(e);return Ri(e)?r:lt(r,n(e))}function dr(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":qt&&qt in pe(e)?function(e){var t=Se.call(e,qt),n=e[qt];try{e[qt]=void 0;var r=!0}catch(e){}var a=Oe.call(e);return r&&(t?e[qt]=n:delete e[qt]),a}(e):function(e){return Oe.call(e)}(e)}function pr(e,t){return e>t}function mr(e,t){return null!=e&&Se.call(e,t)}function gr(e,t){return null!=e&&t in pe(e)}function vr(e,t,n){for(var r=n?st:ct,a=e[0].length,o=e.length,i=o,c=q(o),s=Infinity,u=[];i--;){var l=e[i];i&&t&&(l=ut(l,At(t))),s=cn(l.length,s),c[i]=!n&&(t||a>=120&&l.length>=120)?new Tn(i&&l):void 0}l=e[0];var f=-1,h=c[0];e:for(;++f<a&&u.length<s;){var d=l[f],p=t?t(d):d;if(d=n||0!==d?d:0,!(h?Wt(h,p):r(u,p,n))){for(i=o;--i;){var m=c[i];if(!(m?Wt(m,p):r(e[i],p,n)))continue e}h&&h.push(p),u.push(d)}}return u}function yr(e,t,n){var r=null==(e=mo(e,t=ia(t,e)))?e:e[Oo(Io(t))];return null==r?void 0:tt(r,e,n)}function br(e){return Bi(e)&&dr(e)==o}function xr(e,t,n,r,a){return e===t||(null==e||null==t||!Bi(e)&&!Bi(t)?e!=e&&t!=t:function(e,t,n,r,a,i){var f=Ri(e),h=Ri(t),x=f?c:to(e),_=h?c:to(t),E=(x=x==o?m:x)==m,O=(_=_==o?m:_)==m,k=x==_;if(k&&Ti(e)){if(!Ti(t))return!1;f=!0,E=!1}if(k&&!E)return i||(i=new Nn),f||Zi(e)?Ua(e,t,n,r,a,i):function(e,t,n,r,a,o,i){switch(n){case S:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case w:return!(e.byteLength!=t.byteLength||!o(new Ve(e),new Ve(t)));case s:case u:case p:return Li(+e,+t);case l:return e.name==t.name&&e.message==t.message;case g:case y:return e==t+"";case d:var c=Nt;case v:if(c||(c=Gt),e.size!=t.size&&!(1&r))return!1;var f=i.get(e);if(f)return f==t;r|=2,i.set(e,t);var h=Ua(c(e),c(t),r,a,o,i);return i.delete(e),h;case b:if(kn)return kn.call(e)==kn.call(t)}return!1}(e,t,x,n,r,a,i);if(!(1&n)){var A=E&&Se.call(e,"__wrapped__"),L=O&&Se.call(t,"__wrapped__");if(A||L){var W=A?e.value():e,D=L?t.value():t;return i||(i=new Nn),a(W,D,n,r,i)}}return!!k&&(i||(i=new Nn),function(e,t,n,r,a,o){var i=1&n,c=Ha(e),s=c.length;if(s!=Ha(t).length&&!i)return!1;for(var u=s;u--;){var l=c[u];if(!(i?l in t:Se.call(t,l)))return!1}var f=o.get(e),h=o.get(t);if(f&&h)return f==t&&h==e;var d=!0;o.set(e,t),o.set(t,e);for(var p=i;++u<s;){var m=e[l=c[u]],g=t[l];if(r)var v=i?r(g,m,l,t,e,o):r(m,g,l,e,t,o);if(!(void 0===v?m===g||a(m,g,n,r,o):v)){d=!1;break}p||(p="constructor"==l)}if(d&&!p){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(d=!1)}return o.delete(e),o.delete(t),d}(e,t,n,r,a,i))}(e,t,n,r,xr,a))}function wr(e,t,n,r){var a=n.length,o=a,i=!r;if(null==e)return!o;for(e=pe(e);a--;){var c=n[a];if(i&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++a<o;){var s=(c=n[a])[0],u=e[s],l=c[1];if(i&&c[2]){if(void 0===u&&!(s in e))return!1}else{var f=new Nn;if(r)var h=r(u,l,s,e,t,f);if(!(void 0===h?xr(l,u,3,r,f):h))return!1}}return!0}function Sr(e){return!(!Ui(e)||(t=e,Ee&&Ee in t))&&(Fi(e)?De:ae).test(ko(e));var t}function _r(e){return"function"==typeof e?e:null==e?zc:"object"==typeof e?Ri(e)?Lr(e[0],e[1]):Ar(e):es(e)}function Er(e){if(!lo(e))return an(e);var t=[];for(var n in pe(e))Se.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Or(e,t){return e<t}function kr(e,t){var n=-1,r=ji(e)?q(e.length):[];return er(e,(function(e,a,o){r[++n]=t(e,a,o)})),r}function Ar(e){var t=Za(e);return 1==t.length&&t[0][2]?ho(t[0][0],t[0][1]):function(n){return n===e||wr(n,e,t)}}function Lr(e,t){return co(e)&&fo(t)?ho(Oo(e),t):function(n){var r=pc(n,e);return void 0===r&&r===t?mc(n,e):xr(t,r,3)}}function Wr(e,t,n,r,a){e!==t&&ir(t,(function(o,i){if(a||(a=new Nn),Ui(o))!function(e,t,n,r,a,o,i){var c=vo(e,n),s=vo(t,n),u=i.get(s);if(u)Un(e,n,u);else{var l=o?o(c,s,n+"",e,t,i):void 0,f=void 0===l;if(f){var h=Ri(s),d=!h&&Ti(s),p=!h&&!d&&Zi(s);l=s,h||d||p?Ri(c)?l=c:Pi(c)?l=ga(c):d?(f=!1,l=la(s,!0)):p?(f=!1,l=ha(s,!0)):l=[]:$i(s)||Mi(s)?(l=c,Mi(c)?l=oc(c):Ui(c)&&!Fi(c)||(l=ro(s))):f=!1}f&&(i.set(s,l),a(l,s,r,o,i),i.delete(s)),Un(e,n,l)}}(e,t,i,n,Wr,r,a);else{var c=r?r(vo(e,i),o,i+"",e,t,a):void 0;void 0===c&&(c=o),Un(e,i,c)}}),xc)}function Dr(e,t){var n=e.length;if(n)return oo(t+=t<0?n:0,n)?e[t]:void 0}function Mr(e,t,n){t=t.length?ut(t,(function(e){return Ri(e)?function(t){return fr(t,1===e.length?e[0]:e)}:e})):[zc];var r=-1;return t=ut(t,At(Ka())),function(e,t){var r=e.length;for(e.sort((function(e,t){return function(e,t,n){for(var r=-1,a=e.criteria,o=t.criteria,i=a.length,c=n.length;++r<i;){var s=da(a[r],o[r]);if(s)return r>=c?s:s*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}));r--;)e[r]=e[r].value;return e}(kr(e,(function(e,n,a){return{criteria:ut(t,(function(t){return t(e)})),index:++r,value:e}})))}function Rr(e,t,n){for(var r=-1,a=t.length,o={};++r<a;){var i=t[r],c=fr(e,i);n(c,i)&&Gr(o,ia(i,e),c)}return o}function Cr(e,t,n,r){var a=r?yt:vt,o=-1,i=t.length,c=e;for(e===t&&(t=ga(t)),n&&(c=ut(e,At(n)));++o<i;)for(var s=0,u=t[o],l=n?n(u):u;(s=a(c,l,s,r))>-1;)c!==e&&Ye.call(c,s,1),Ye.call(e,s,1);return e}function jr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var a=t[n];if(n==r||a!==o){var o=a;oo(a)?Ye.call(e,a,1):Qr(e,a)}}return e}function Pr(e,t){return e+Xt(ln()*(t-e+1))}function Tr(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=Xt(t/2))&&(e+=e)}while(t);return n}function Nr(e,t){return xo(po(e,t,zc),e+"")}function Ir(e){return Fn(Lc(e))}function Fr(e,t){var n=Lc(e);return _o(n,Kn(t,0,n.length))}function Gr(e,t,n,r){if(!Ui(e))return e;for(var a=-1,o=(t=ia(t,e)).length,i=o-1,c=e;null!=c&&++a<o;){var s=Oo(t[a]),u=n;if("__proto__"===s||"constructor"===s||"prototype"===s)return e;if(a!=i){var l=c[s];void 0===(u=r?r(l,s,c):void 0)&&(u=Ui(l)?l:oo(t[a+1])?[]:{})}Bn(c,s,u),c=c[s]}return e}var Vr=yn?function(e,t){return yn.set(e,t),e}:zc,Ur=Yt?function(e,t){return Yt(e,"toString",{configurable:!0,enumerable:!1,value:Uc(t),writable:!0})}:zc;function Br(e){return _o(Lc(e))}function Hr(e,t,n){var r=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(n=n>a?a:n)<0&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var o=q(a);++r<a;)o[r]=e[r+t];return o}function zr(e,t){var n;return er(e,(function(e,r,a){return!(n=t(e,r,a))})),!!n}function $r(e,t,n){var r=0,a=null==e?r:e.length;if("number"==typeof t&&t==t&&a<=2147483647){for(;r<a;){var o=r+a>>>1,i=e[o];null!==i&&!Ji(i)&&(n?i<=t:i<t)?r=o+1:a=o}return a}return qr(e,t,zc,n)}function qr(e,t,n,r){var a=0,o=null==e?0:e.length;if(0===o)return 0;for(var i=(t=n(t))!=t,c=null===t,s=Ji(t),u=void 0===t;a<o;){var l=Xt((a+o)/2),f=n(e[l]),h=void 0!==f,d=null===f,p=f==f,m=Ji(f);if(i)var g=r||p;else g=u?p&&(r||h):c?p&&h&&(r||!d):s?p&&h&&!d&&(r||!m):!d&&!m&&(r?f<=t:f<t);g?a=l+1:o=l}return cn(o,4294967294)}function Yr(e,t){for(var n=-1,r=e.length,a=0,o=[];++n<r;){var i=e[n],c=t?t(i):i;if(!n||!Li(c,s)){var s=c;o[a++]=0===i?0:i}}return o}function Kr(e){return"number"==typeof e?e:Ji(e)?NaN:+e}function Jr(e){if("string"==typeof e)return e;if(Ri(e))return ut(e,Jr)+"";if(Ji(e))return An?An.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Zr(e,t,n){var r=-1,a=ct,o=e.length,i=!0,c=[],s=c;if(n)i=!1,a=st;else if(o>=200){var u=t?null:Ta(e);if(u)return Gt(u);i=!1,a=Wt,s=new Tn}else s=t?[]:c;e:for(;++r<o;){var l=e[r],f=t?t(l):l;if(l=n||0!==l?l:0,i&&f==f){for(var h=s.length;h--;)if(s[h]===f)continue e;t&&s.push(f),c.push(l)}else a(s,f,n)||(s!==c&&s.push(f),c.push(l))}return c}function Qr(e,t){return null==(e=mo(e,t=ia(t,e)))||delete e[Oo(Io(t))]}function Xr(e,t,n,r){return Gr(e,t,n(fr(e,t)),r)}function ea(e,t,n,r){for(var a=e.length,o=r?a:-1;(r?o--:++o<a)&&t(e[o],o,e););return n?Hr(e,r?0:o,r?o+1:a):Hr(e,r?o+1:0,r?a:o)}function ta(e,t){var n=e;return n instanceof Rn&&(n=n.value()),ft(t,(function(e,t){return t.func.apply(t.thisArg,lt([e],t.args))}),n)}function na(e,t,n){var r=e.length;if(r<2)return r?Zr(e[0]):[];for(var a=-1,o=q(r);++a<r;)for(var i=e[a],c=-1;++c<r;)c!=a&&(o[a]=Xn(o[a]||i,e[c],t,n));return Zr(or(o,1),t,n)}function ra(e,t,n){for(var r=-1,a=e.length,o=t.length,i={};++r<a;)n(i,e[r],r<o?t[r]:void 0);return i}function aa(e){return Pi(e)?e:[]}function oa(e){return"function"==typeof e?e:zc}function ia(e,t){return Ri(e)?e:co(e,t)?[e]:Eo(ic(e))}var ca=Nr;function sa(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:Hr(e,t,n)}var ua=Kt||function(e){return Be.clearTimeout(e)};function la(e,t){if(t)return e.slice();var n=e.length,r=Ue?Ue(n):new e.constructor(n);return e.copy(r),r}function fa(e){var t=new e.constructor(e.byteLength);return new Ve(t).set(new Ve(e)),t}function ha(e,t){var n=t?fa(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function da(e,t){if(e!==t){var n=void 0!==e,r=null===e,a=e==e,o=Ji(e),i=void 0!==t,c=null===t,s=t==t,u=Ji(t);if(!c&&!u&&!o&&e>t||o&&i&&s&&!c&&!u||r&&i&&s||!n&&s||!a)return 1;if(!r&&!o&&!u&&e<t||u&&n&&a&&!r&&!o||c&&n&&a||!i&&a||!s)return-1}return 0}function pa(e,t,n,r){for(var a=-1,o=e.length,i=n.length,c=-1,s=t.length,u=on(o-i,0),l=q(s+u),f=!r;++c<s;)l[c]=t[c];for(;++a<i;)(f||a<o)&&(l[n[a]]=e[a]);for(;u--;)l[c++]=e[a++];return l}function ma(e,t,n,r){for(var a=-1,o=e.length,i=-1,c=n.length,s=-1,u=t.length,l=on(o-c,0),f=q(l+u),h=!r;++a<l;)f[a]=e[a];for(var d=a;++s<u;)f[d+s]=t[s];for(;++i<c;)(h||a<o)&&(f[d+n[i]]=e[a++]);return f}function ga(e,t){var n=-1,r=e.length;for(t||(t=q(r));++n<r;)t[n]=e[n];return t}function va(e,t,n,r){var a=!n;n||(n={});for(var o=-1,i=t.length;++o<i;){var c=t[o],s=r?r(n[c],e[c],c,n,e):void 0;void 0===s&&(s=e[c]),a?qn(n,c,s):Bn(n,c,s)}return n}function ya(e,t){return function(n,r){var a=Ri(n)?nt:zn,o=t?t():{};return a(n,e,Ka(r,2),o)}}function ba(e){return Nr((function(t,n){var r=-1,a=n.length,o=a>1?n[a-1]:void 0,i=a>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(a--,o):void 0,i&&io(n[0],n[1],i)&&(o=a<3?void 0:o,a=1),t=pe(t);++r<a;){var c=n[r];c&&e(t,c,r,o)}return t}))}function xa(e,t){return function(n,r){if(null==n)return n;if(!ji(n))return e(n,r);for(var a=n.length,o=t?a:-1,i=pe(n);(t?o--:++o<a)&&!1!==r(i[o],o,i););return n}}function wa(e){return function(t,n,r){for(var a=-1,o=pe(t),i=r(t),c=i.length;c--;){var s=i[e?c:++a];if(!1===n(o[s],s,o))break}return t}}function Sa(e){return function(t){var n=Tt(t=ic(t))?Bt(t):void 0,r=n?n[0]:t.charAt(0),a=n?sa(n,1).join(""):t.slice(1);return r[e]()+a}}function _a(e){return function(t){return ft(Fc(Mc(t).replace(Le,"")),e,"")}}function Ea(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Wn(e.prototype),r=e.apply(n,t);return Ui(r)?r:n}}function Oa(e){return function(t,n,r){var a=pe(t);if(!ji(t)){var o=Ka(n,3);t=bc(t),n=function(e){return o(a[e],e,a)}}var i=e(t,n,r);return i>-1?a[o?t[i]:i]:void 0}}function ka(e){return Ba((function(t){var r=t.length,a=r,o=Mn.prototype.thru;for(e&&t.reverse();a--;){var i=t[a];if("function"!=typeof i)throw new ve(n);if(o&&!c&&"wrapper"==qa(i))var c=new Mn([],!0)}for(a=c?a:r;++a<r;){var s=qa(i=t[a]),u="wrapper"==s?$a(i):void 0;c=u&&so(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?c[qa(u[0])].apply(c,u[3]):1==i.length&&so(i)?c[s]():c.thru(i)}return function(){var e=arguments,n=e[0];if(c&&1==e.length&&Ri(n))return c.plant(n).value();for(var a=0,o=r?t[a].apply(this,e):n;++a<r;)o=t[a].call(this,o);return o}}))}function Aa(e,t,n,r,a,o,i,c,s,u){var l=128&t,f=1&t,h=2&t,d=24&t,p=512&t,m=h?void 0:Ea(e);return function g(){for(var v=arguments.length,y=q(v),b=v;b--;)y[b]=arguments[b];if(d)var x=Ya(g),w=Rt(y,x);if(r&&(y=pa(y,r,a,d)),o&&(y=ma(y,o,i,d)),v-=w,d&&v<u){var S=Ft(y,x);return ja(e,t,Aa,g.placeholder,n,y,S,c,s,u-v)}var _=f?n:this,E=h?_[e]:e;return v=y.length,c?y=go(y,c):p&&v>1&&y.reverse(),l&&s<v&&(y.length=s),this&&this!==Be&&this instanceof g&&(E=m||Ea(E)),E.apply(_,y)}}function La(e,t){return function(n,r){return function(e,t,n,r){return sr(e,(function(e,a,o){t(r,n(e),a,o)})),r}(n,e,t(r),{})}}function Wa(e,t){return function(n,r){var a;if(void 0===n&&void 0===r)return t;if(void 0!==n&&(a=n),void 0!==r){if(void 0===a)return r;"string"==typeof n||"string"==typeof r?(n=Jr(n),r=Jr(r)):(n=Kr(n),r=Kr(r)),a=e(n,r)}return a}}function Da(e){return Ba((function(t){return t=ut(t,At(Ka())),Nr((function(n){var r=this;return e(t,(function(e){return tt(e,r,n)}))}))}))}function Ma(e,t){var n=(t=void 0===t?" ":Jr(t)).length;if(n<2)return n?Tr(t,e):t;var r=Tr(t,Qt(e/Ut(t)));return Tt(t)?sa(Bt(r),0,e).join(""):r.slice(0,e)}function Ra(e){return function(t,n,r){return r&&"number"!=typeof r&&io(t,n,r)&&(n=r=void 0),t=tc(t),void 0===n?(n=t,t=0):n=tc(n),function(e,t,n,r){for(var a=-1,o=on(Qt((t-e)/(n||1)),0),i=q(o);o--;)i[r?o:++a]=e,e+=n;return i}(t,n,r=void 0===r?t<n?1:-1:tc(r),e)}}function Ca(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ac(t),n=ac(n)),e(t,n)}}function ja(e,t,n,r,a,o,i,c,s,u){var l=8&t;t|=l?32:64,4&(t&=~(l?64:32))||(t&=-4);var f=[e,t,a,l?o:void 0,l?i:void 0,l?void 0:o,l?void 0:i,c,s,u],h=n.apply(void 0,f);return so(e)&&yo(h,f),h.placeholder=r,wo(h,e,t)}function Pa(e){var t=de[e];return function(e,n){if(e=ac(e),(n=null==n?0:cn(nc(n),292))&&nn(e)){var r=(ic(e)+"e").split("e");return+((r=(ic(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Ta=mn&&1/Gt(new mn([,-0]))[1]==1/0?function(e){return new mn(e)}:Jc;function Na(e){return function(t){var n=to(t);return n==d?Nt(t):n==v?Vt(t):function(e,t){return ut(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Ia(e,t,a,o,i,c,s,u){var l=2&t;if(!l&&"function"!=typeof e)throw new ve(n);var f=o?o.length:0;if(f||(t&=-97,o=i=void 0),s=void 0===s?s:on(nc(s),0),u=void 0===u?u:nc(u),f-=i?i.length:0,64&t){var h=o,d=i;o=i=void 0}var p=l?void 0:$a(e),m=[e,t,a,o,i,h,d,c,s,u];if(p&&function(e,t){var n=e[1],a=t[1],o=n|a;if(!(o<131||128==a&&8==n||128==a&&256==n&&e[7].length<=t[8]||384==a&&t[7].length<=t[8]&&8==n))return e;1&a&&(e[2]=t[2],o|=1&n?0:4);var i=t[3];if(i){var c=e[3];e[3]=c?pa(c,i,t[4]):i,e[4]=c?Ft(e[3],r):t[4]}(i=t[5])&&(e[5]=(c=e[5])?ma(c,i,t[6]):i,e[6]=c?Ft(e[5],r):t[6]),(i=t[7])&&(e[7]=i),128&a&&(e[8]=null==e[8]?t[8]:cn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o}(m,p),e=m[0],t=m[1],a=m[2],o=m[3],i=m[4],!(u=m[9]=void 0===m[9]?l?0:e.length:on(m[9]-f,0))&&24&t&&(t&=-25),t&&1!=t)g=8==t||16==t?function(e,t,n){var r=Ea(e);return function a(){for(var o=arguments.length,i=q(o),c=o,s=Ya(a);c--;)i[c]=arguments[c];var u=o<3&&i[0]!==s&&i[o-1]!==s?[]:Ft(i,s);if((o-=u.length)<n)return ja(e,t,Aa,a.placeholder,void 0,i,u,void 0,void 0,n-o);var l=this&&this!==Be&&this instanceof a?r:e;return tt(l,this,i)}}(e,t,u):32!=t&&33!=t||i.length?Aa.apply(void 0,m):function(e,t,n,r){var a=1&t,o=Ea(e);return function t(){for(var i=-1,c=arguments.length,s=-1,u=r.length,l=q(u+c),f=this&&this!==Be&&this instanceof t?o:e;++s<u;)l[s]=r[s];for(;c--;)l[s++]=arguments[++i];return tt(f,a?n:this,l)}}(e,t,a,o);else var g=function(e,t,n){var r=1&t,a=Ea(e);return function t(){var o=this&&this!==Be&&this instanceof t?a:e;return o.apply(r?n:this,arguments)}}(e,t,a);return wo((p?Vr:yo)(g,m),e,t)}function Fa(e,t,n,r){return void 0===e||Li(e,be[n])&&!Se.call(r,n)?t:e}function Ga(e,t,n,r,a,o){return Ui(e)&&Ui(t)&&(o.set(t,e),Wr(e,t,void 0,Ga,o),o.delete(t)),e}function Va(e){return $i(e)?void 0:e}function Ua(e,t,n,r,a,o){var i=1&n,c=e.length,s=t.length;if(c!=s&&!(i&&s>c))return!1;var u=o.get(e),l=o.get(t);if(u&&l)return u==t&&l==e;var f=-1,h=!0,d=2&n?new Tn:void 0;for(o.set(e,t),o.set(t,e);++f<c;){var p=e[f],m=t[f];if(r)var g=i?r(m,p,f,t,e,o):r(p,m,f,e,t,o);if(void 0!==g){if(g)continue;h=!1;break}if(d){if(!dt(t,(function(e,t){if(!Wt(d,t)&&(p===e||a(p,e,n,r,o)))return d.push(t)}))){h=!1;break}}else if(p!==m&&!a(p,m,n,r,o)){h=!1;break}}return o.delete(e),o.delete(t),h}function Ba(e){return xo(po(e,void 0,Co),e+"")}function Ha(e){return hr(e,bc,Xa)}function za(e){return hr(e,xc,eo)}var $a=yn?function(e){return yn.get(e)}:Jc;function qa(e){for(var t=e.name+"",n=bn[t],r=Se.call(bn,t)?n.length:0;r--;){var a=n[r],o=a.func;if(null==o||o==e)return a.name}return t}function Ya(e){return(Se.call(Ln,"placeholder")?Ln:e).placeholder}function Ka(){var e=Ln.iteratee||$c;return e=e===$c?_r:e,arguments.length?e(arguments[0],arguments[1]):e}function Ja(e,t){var n,r,a=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?a["string"==typeof t?"string":"hash"]:a.map}function Za(e){for(var t=bc(e),n=t.length;n--;){var r=t[n],a=e[r];t[n]=[r,a,fo(a)]}return t}function Qa(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Sr(n)?n:void 0}var Xa=en?function(e){return null==e?[]:(e=pe(e),it(en(e),(function(t){return qe.call(e,t)})))}:rs,eo=en?function(e){for(var t=[];e;)lt(t,Xa(e)),e=He(e);return t}:rs,to=dr;function no(e,t,n){for(var r=-1,a=(t=ia(t,e)).length,o=!1;++r<a;){var i=Oo(t[r]);if(!(o=null!=e&&n(e,i)))break;e=e[i]}return o||++r!=a?o:!!(a=null==e?0:e.length)&&Vi(a)&&oo(i,a)&&(Ri(e)||Mi(e))}function ro(e){return"function"!=typeof e.constructor||lo(e)?{}:Wn(He(e))}function ao(e){return Ri(e)||Mi(e)||!!(pt&&e&&e[pt])}function oo(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&ie.test(e))&&e>-1&&e%1==0&&e<t}function io(e,t,n){if(!Ui(n))return!1;var r=typeof t;return!!("number"==r?ji(n)&&oo(t,n.length):"string"==r&&t in n)&&Li(n[t],e)}function co(e,t){if(Ri(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Ji(e))||U.test(e)||!V.test(e)||null!=t&&e in pe(t)}function so(e){var t=qa(e),n=Ln[t];if("function"!=typeof n||!(t in Rn.prototype))return!1;if(e===n)return!0;var r=$a(n);return!!r&&e===r[0]}(hn&&to(new hn(new ArrayBuffer(1)))!=S||dn&&to(new dn)!=d||pn&&"[object Promise]"!=to(pn.resolve())||mn&&to(new mn)!=v||gn&&to(new gn)!=x)&&(to=function(e){var t=dr(e),n=t==m?e.constructor:void 0,r=n?ko(n):"";if(r)switch(r){case xn:return S;case wn:return d;case Sn:return"[object Promise]";case _n:return v;case En:return x}return t});var uo=xe?Fi:as;function lo(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||be)}function fo(e){return e==e&&!Ui(e)}function ho(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in pe(n))}}function po(e,t,n){return t=on(void 0===t?e.length-1:t,0),function(){for(var r=arguments,a=-1,o=on(r.length-t,0),i=q(o);++a<o;)i[a]=r[t+a];a=-1;for(var c=q(t+1);++a<t;)c[a]=r[a];return c[t]=n(i),tt(e,this,c)}}function mo(e,t){return t.length<2?e:fr(e,Hr(t,0,-1))}function go(e,t){for(var n=e.length,r=cn(t.length,n),a=ga(e);r--;){var o=t[r];e[r]=oo(o,n)?a[o]:void 0}return e}function vo(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var yo=So(Vr),bo=Zt||function(e,t){return Be.setTimeout(e,t)},xo=So(Ur);function wo(e,t,n){var r=t+"";return xo(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(Y,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return rt(a,(function(n){var r="_."+n[0];t&n[1]&&!ct(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(K);return t?t[1].split(J):[]}(r),n)))}function So(e){var t=0,n=0;return function(){var r=sn(),a=16-(r-n);if(n=r,a>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function _o(e,t){var n=-1,r=e.length,a=r-1;for(t=void 0===t?r:t;++n<t;){var o=Pr(n,a),i=e[o];e[o]=e[n],e[n]=i}return e.length=t,e}var Eo=function(e){var t=Si((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(B,(function(e,n,r,a){t.push(r?a.replace(X,"$1"):n||e)})),t}),(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}();function Oo(e){if("string"==typeof e||Ji(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ko(e){if(null!=e){try{return we.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ao(e){if(e instanceof Rn)return e.clone();var t=new Mn(e.__wrapped__,e.__chain__);return t.__actions__=ga(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Lo=Nr((function(e,t){return Pi(e)?Xn(e,or(t,1,Pi,!0)):[]})),Wo=Nr((function(e,t){var n=Io(t);return Pi(n)&&(n=void 0),Pi(e)?Xn(e,or(t,1,Pi,!0),Ka(n,2)):[]})),Do=Nr((function(e,t){var n=Io(t);return Pi(n)&&(n=void 0),Pi(e)?Xn(e,or(t,1,Pi,!0),void 0,n):[]}));function Mo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var a=null==n?0:nc(n);return a<0&&(a=on(r+a,0)),gt(e,Ka(t,3),a)}function Ro(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var a=r-1;return void 0!==n&&(a=nc(n),a=n<0?on(r+a,0):cn(a,r-1)),gt(e,Ka(t,3),a,!0)}function Co(e){return null!=e&&e.length?or(e,1):[]}function jo(e){return e&&e.length?e[0]:void 0}var Po=Nr((function(e){var t=ut(e,aa);return t.length&&t[0]===e[0]?vr(t):[]})),To=Nr((function(e){var t=Io(e),n=ut(e,aa);return t===Io(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?vr(n,Ka(t,2)):[]})),No=Nr((function(e){var t=Io(e),n=ut(e,aa);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?vr(n,void 0,t):[]}));function Io(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var Fo=Nr(Go);function Go(e,t){return e&&e.length&&t&&t.length?Cr(e,t):e}var Vo=Ba((function(e,t){var n=null==e?0:e.length,r=Yn(e,t);return jr(e,ut(t,(function(e){return oo(e,n)?+e:e})).sort(da)),r}));function Uo(e){return null==e?e:fn.call(e)}var Bo=Nr((function(e){return Zr(or(e,1,Pi,!0))})),Ho=Nr((function(e){var t=Io(e);return Pi(t)&&(t=void 0),Zr(or(e,1,Pi,!0),Ka(t,2))})),zo=Nr((function(e){var t=Io(e);return t="function"==typeof t?t:void 0,Zr(or(e,1,Pi,!0),void 0,t)}));function $o(e){if(!e||!e.length)return[];var t=0;return e=it(e,(function(e){if(Pi(e))return t=on(e.length,t),!0})),Ot(t,(function(t){return ut(e,wt(t))}))}function qo(e,t){if(!e||!e.length)return[];var n=$o(e);return null==t?n:ut(n,(function(e){return tt(t,void 0,e)}))}var Yo=Nr((function(e,t){return Pi(e)?Xn(e,t):[]})),Ko=Nr((function(e){return na(it(e,Pi))})),Jo=Nr((function(e){var t=Io(e);return Pi(t)&&(t=void 0),na(it(e,Pi),Ka(t,2))})),Zo=Nr((function(e){var t=Io(e);return t="function"==typeof t?t:void 0,na(it(e,Pi),void 0,t)})),Qo=Nr($o),Xo=Nr((function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,qo(e,n)}));function ei(e){var t=Ln(e);return t.__chain__=!0,t}function ti(e,t){return t(e)}var ni=Ba((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,a=function(t){return Yn(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Rn&&oo(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:ti,args:[a],thisArg:void 0}),new Mn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(a)})),ri=ya((function(e,t,n){Se.call(e,n)?++e[n]:qn(e,n,1)})),ai=Oa(Mo),oi=Oa(Ro);function ii(e,t){return(Ri(e)?rt:er)(e,Ka(t,3))}function ci(e,t){return(Ri(e)?at:tr)(e,Ka(t,3))}var si=ya((function(e,t,n){Se.call(e,n)?e[n].push(t):qn(e,n,[t])})),ui=Nr((function(e,t,n){var r=-1,a="function"==typeof t,o=ji(e)?q(e.length):[];return er(e,(function(e){o[++r]=a?tt(t,e,n):yr(e,t,n)})),o})),li=ya((function(e,t,n){qn(e,n,t)}));function fi(e,t){return(Ri(e)?ut:kr)(e,Ka(t,3))}var hi=ya((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),di=Nr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&io(e,t[0],t[1])?t=[]:n>2&&io(t[0],t[1],t[2])&&(t=[t[0]]),Mr(e,or(t,1),[])})),pi=Jt||function(){return Be.Date.now()};function mi(e,t,n){return t=n?void 0:t,Ia(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function gi(e,t){var r;if("function"!=typeof t)throw new ve(n);return e=nc(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}}var vi=Nr((function(e,t,n){var r=1;if(n.length){var a=Ft(n,Ya(vi));r|=32}return Ia(e,r,t,n,a)})),yi=Nr((function(e,t,n){var r=3;if(n.length){var a=Ft(n,Ya(yi));r|=32}return Ia(t,r,e,n,a)}));function bi(e,t,r){var a,o,i,c,s,u,l=0,f=!1,h=!1,d=!0;if("function"!=typeof e)throw new ve(n);function p(t){var n=a,r=o;return a=o=void 0,l=t,c=e.apply(r,n)}function m(e){return l=e,s=bo(v,t),f?p(e):c}function g(e){var n=e-u;return void 0===u||n>=t||n<0||h&&e-l>=i}function v(){var e=pi();if(g(e))return y(e);s=bo(v,function(e){var n=t-(e-u);return h?cn(n,i-(e-l)):n}(e))}function y(e){return s=void 0,d&&a?p(e):(a=o=void 0,c)}function b(){var e=pi(),n=g(e);if(a=arguments,o=this,u=e,n){if(void 0===s)return m(u);if(h)return ua(s),s=bo(v,t),p(u)}return void 0===s&&(s=bo(v,t)),c}return t=ac(t)||0,Ui(r)&&(f=!!r.leading,i=(h="maxWait"in r)?on(ac(r.maxWait)||0,t):i,d="trailing"in r?!!r.trailing:d),b.cancel=function(){void 0!==s&&ua(s),l=0,a=u=o=s=void 0},b.flush=function(){return void 0===s?c:y(pi())},b}var xi=Nr((function(e,t){return Qn(e,1,t)})),wi=Nr((function(e,t,n){return Qn(e,ac(t)||0,n)}));function Si(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ve(n);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],o=r.cache;if(o.has(a))return o.get(a);var i=e.apply(this,n);return r.cache=o.set(a,i)||o,i};return r.cache=new(Si.Cache||Pn),r}function _i(e){if("function"!=typeof e)throw new ve(n);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Si.Cache=Pn;var Ei=ca((function(e,t){var n=(t=1==t.length&&Ri(t[0])?ut(t[0],At(Ka())):ut(or(t,1),At(Ka()))).length;return Nr((function(r){for(var a=-1,o=cn(r.length,n);++a<o;)r[a]=t[a].call(this,r[a]);return tt(e,this,r)}))})),Oi=Nr((function(e,t){return Ia(e,32,void 0,t,Ft(t,Ya(Oi)))})),ki=Nr((function(e,t){return Ia(e,64,void 0,t,Ft(t,Ya(ki)))})),Ai=Ba((function(e,t){return Ia(e,256,void 0,void 0,void 0,t)}));function Li(e,t){return e===t||e!=e&&t!=t}var Wi=Ca(pr),Di=Ca((function(e,t){return e>=t})),Mi=br(function(){return arguments}())?br:function(e){return Bi(e)&&Se.call(e,"callee")&&!qe.call(e,"callee")},Ri=q.isArray,Ci=Ke?At(Ke):function(e){return Bi(e)&&dr(e)==w};function ji(e){return null!=e&&Vi(e.length)&&!Fi(e)}function Pi(e){return Bi(e)&&ji(e)}var Ti=tn||as,Ni=Je?At(Je):function(e){return Bi(e)&&dr(e)==u};function Ii(e){if(!Bi(e))return!1;var t=dr(e);return t==l||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!$i(e)}function Fi(e){if(!Ui(e))return!1;var t=dr(e);return t==f||t==h||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Gi(e){return"number"==typeof e&&e==nc(e)}function Vi(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Ui(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Bi(e){return null!=e&&"object"==typeof e}var Hi=Ze?At(Ze):function(e){return Bi(e)&&to(e)==d};function zi(e){return"number"==typeof e||Bi(e)&&dr(e)==p}function $i(e){if(!Bi(e)||dr(e)!=m)return!1;var t=He(e);if(null===t)return!0;var n=Se.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&we.call(n)==ke}var qi=Qe?At(Qe):function(e){return Bi(e)&&dr(e)==g},Yi=Xe?At(Xe):function(e){return Bi(e)&&to(e)==v};function Ki(e){return"string"==typeof e||!Ri(e)&&Bi(e)&&dr(e)==y}function Ji(e){return"symbol"==typeof e||Bi(e)&&dr(e)==b}var Zi=et?At(et):function(e){return Bi(e)&&Vi(e.length)&&!!Te[dr(e)]},Qi=Ca(Or),Xi=Ca((function(e,t){return e<=t}));function ec(e){if(!e)return[];if(ji(e))return Ki(e)?Bt(e):ga(e);if(St&&e[St])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[St]());var t=to(e);return(t==d?Nt:t==v?Gt:Lc)(e)}function tc(e){return e?(e=ac(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function nc(e){var t=tc(e),n=t%1;return t==t?n?t-n:t:0}function rc(e){return e?Kn(nc(e),0,4294967295):0}function ac(e){if("number"==typeof e)return e;if(Ji(e))return NaN;if(Ui(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ui(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=kt(e);var n=re.test(e);return n||oe.test(e)?Ge(e.slice(2),n?2:8):ne.test(e)?NaN:+e}function oc(e){return va(e,xc(e))}function ic(e){return null==e?"":Jr(e)}var cc=ba((function(e,t){if(lo(t)||ji(t))va(t,bc(t),e);else for(var n in t)Se.call(t,n)&&Bn(e,n,t[n])})),sc=ba((function(e,t){va(t,xc(t),e)})),uc=ba((function(e,t,n,r){va(t,xc(t),e,r)})),lc=ba((function(e,t,n,r){va(t,bc(t),e,r)})),fc=Ba(Yn),hc=Nr((function(e,t){e=pe(e);var n=-1,r=t.length,a=r>2?t[2]:void 0;for(a&&io(t[0],t[1],a)&&(r=1);++n<r;)for(var o=t[n],i=xc(o),c=-1,s=i.length;++c<s;){var u=i[c],l=e[u];(void 0===l||Li(l,be[u])&&!Se.call(e,u))&&(e[u]=o[u])}return e})),dc=Nr((function(e){return e.push(void 0,Ga),tt(Sc,void 0,e)}));function pc(e,t,n){var r=null==e?void 0:fr(e,t);return void 0===r?n:r}function mc(e,t){return null!=e&&no(e,t,gr)}var gc=La((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Oe.call(t)),e[t]=n}),Uc(zc)),vc=La((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Oe.call(t)),Se.call(e,t)?e[t].push(n):e[t]=[n]}),Ka),yc=Nr(yr);function bc(e){return ji(e)?In(e):Er(e)}function xc(e){return ji(e)?In(e,!0):function(e){if(!Ui(e))return function(e){var t=[];if(null!=e)for(var n in pe(e))t.push(n);return t}(e);var t=lo(e),n=[];for(var r in e)("constructor"!=r||!t&&Se.call(e,r))&&n.push(r);return n}(e)}var wc=ba((function(e,t,n){Wr(e,t,n)})),Sc=ba((function(e,t,n,r){Wr(e,t,n,r)})),_c=Ba((function(e,t){var n={};if(null==e)return n;var r=!1;t=ut(t,(function(t){return t=ia(t,e),r||(r=t.length>1),t})),va(e,za(e),n),r&&(n=Jn(n,7,Va));for(var a=t.length;a--;)Qr(n,t[a]);return n})),Ec=Ba((function(e,t){return null==e?{}:function(e,t){return Rr(e,t,(function(t,n){return mc(e,n)}))}(e,t)}));function Oc(e,t){if(null==e)return{};var n=ut(za(e),(function(e){return[e]}));return t=Ka(t),Rr(e,n,(function(e,n){return t(e,n[0])}))}var kc=Na(bc),Ac=Na(xc);function Lc(e){return null==e?[]:Lt(e,bc(e))}var Wc=_a((function(e,t,n){return t=t.toLowerCase(),e+(n?Dc(t):t)}));function Dc(e){return Ic(ic(e).toLowerCase())}function Mc(e){return(e=ic(e))&&e.replace(ce,Ct).replace(We,"")}var Rc=_a((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Cc=_a((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),jc=Sa("toLowerCase"),Pc=_a((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),Tc=_a((function(e,t,n){return e+(n?" ":"")+Ic(t)})),Nc=_a((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ic=Sa("toUpperCase");function Fc(e,t,n){return e=ic(e),void 0===(t=n?void 0:t)?function(e){return Ce.test(e)}(e)?function(e){return e.match(Me)||[]}(e):function(e){return e.match(Z)||[]}(e):e.match(t)||[]}var Gc=Nr((function(e,t){try{return tt(e,void 0,t)}catch(e){return Ii(e)?e:new fe(e)}})),Vc=Ba((function(e,t){return rt(t,(function(t){t=Oo(t),qn(e,t,vi(e[t],e))})),e}));function Uc(e){return function(){return e}}var Bc=ka(),Hc=ka(!0);function zc(e){return e}function $c(e){return _r("function"==typeof e?e:Jn(e,1))}var qc=Nr((function(e,t){return function(n){return yr(n,e,t)}})),Yc=Nr((function(e,t){return function(n){return yr(e,n,t)}}));function Kc(e,t,n){var r=bc(t),a=lr(t,r);null!=n||Ui(t)&&(a.length||!r.length)||(n=t,t=e,e=this,a=lr(t,bc(t)));var o=!(Ui(n)&&"chain"in n&&!n.chain),i=Fi(e);return rt(a,(function(n){var r=t[n];e[n]=r,i&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),a=n.__actions__=ga(this.__actions__);return a.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,lt([this.value()],arguments))})})),e}function Jc(){}var Zc=Da(ut),Qc=Da(ot),Xc=Da(dt);function es(e){return co(e)?wt(Oo(e)):function(e){return function(t){return fr(t,e)}}(e)}var ts=Ra(),ns=Ra(!0);function rs(){return[]}function as(){return!1}var os,is=Wa((function(e,t){return e+t}),0),cs=Pa("ceil"),ss=Wa((function(e,t){return e/t}),1),us=Pa("floor"),ls=Wa((function(e,t){return e*t}),1),fs=Pa("round"),hs=Wa((function(e,t){return e-t}),0);return Ln.after=function(e,t){if("function"!=typeof t)throw new ve(n);return e=nc(e),function(){if(--e<1)return t.apply(this,arguments)}},Ln.ary=mi,Ln.assign=cc,Ln.assignIn=sc,Ln.assignInWith=uc,Ln.assignWith=lc,Ln.at=fc,Ln.before=gi,Ln.bind=vi,Ln.bindAll=Vc,Ln.bindKey=yi,Ln.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Ri(e)?e:[e]},Ln.chain=ei,Ln.chunk=function(e,t,n){t=(n?io(e,t,n):void 0===t)?1:on(nc(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var a=0,o=0,i=q(Qt(r/t));a<r;)i[o++]=Hr(e,a,a+=t);return i},Ln.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,a=[];++t<n;){var o=e[t];o&&(a[r++]=o)}return a},Ln.concat=function(){var e=arguments.length;if(!e)return[];for(var t=q(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return lt(Ri(n)?ga(n):[n],or(t,1))},Ln.cond=function(e){var t=null==e?0:e.length,r=Ka();return e=t?ut(e,(function(e){if("function"!=typeof e[1])throw new ve(n);return[r(e[0]),e[1]]})):[],Nr((function(n){for(var r=-1;++r<t;){var a=e[r];if(tt(a[0],this,n))return tt(a[1],this,n)}}))},Ln.conforms=function(e){return function(e){var t=bc(e);return function(n){return Zn(n,e,t)}}(Jn(e,1))},Ln.constant=Uc,Ln.countBy=ri,Ln.create=function(e,t){var n=Wn(e);return null==t?n:$n(n,t)},Ln.curry=function e(t,n,r){var a=Ia(t,8,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return a.placeholder=e.placeholder,a},Ln.curryRight=function e(t,n,r){var a=Ia(t,16,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return a.placeholder=e.placeholder,a},Ln.debounce=bi,Ln.defaults=hc,Ln.defaultsDeep=dc,Ln.defer=xi,Ln.delay=wi,Ln.difference=Lo,Ln.differenceBy=Wo,Ln.differenceWith=Do,Ln.drop=function(e,t,n){var r=null==e?0:e.length;return r?Hr(e,(t=n||void 0===t?1:nc(t))<0?0:t,r):[]},Ln.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?Hr(e,0,(t=r-(t=n||void 0===t?1:nc(t)))<0?0:t):[]},Ln.dropRightWhile=function(e,t){return e&&e.length?ea(e,Ka(t,3),!0,!0):[]},Ln.dropWhile=function(e,t){return e&&e.length?ea(e,Ka(t,3),!0):[]},Ln.fill=function(e,t,n,r){var a=null==e?0:e.length;return a?(n&&"number"!=typeof n&&io(e,t,n)&&(n=0,r=a),function(e,t,n,r){var a=e.length;for((n=nc(n))<0&&(n=-n>a?0:a+n),(r=void 0===r||r>a?a:nc(r))<0&&(r+=a),r=n>r?0:rc(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},Ln.filter=function(e,t){return(Ri(e)?it:ar)(e,Ka(t,3))},Ln.flatMap=function(e,t){return or(fi(e,t),1)},Ln.flatMapDeep=function(e,t){return or(fi(e,t),1/0)},Ln.flatMapDepth=function(e,t,n){return n=void 0===n?1:nc(n),or(fi(e,t),n)},Ln.flatten=Co,Ln.flattenDeep=function(e){return null!=e&&e.length?or(e,1/0):[]},Ln.flattenDepth=function(e,t){return null!=e&&e.length?or(e,t=void 0===t?1:nc(t)):[]},Ln.flip=function(e){return Ia(e,512)},Ln.flow=Bc,Ln.flowRight=Hc,Ln.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var a=e[t];r[a[0]]=a[1]}return r},Ln.functions=function(e){return null==e?[]:lr(e,bc(e))},Ln.functionsIn=function(e){return null==e?[]:lr(e,xc(e))},Ln.groupBy=si,Ln.initial=function(e){return null!=e&&e.length?Hr(e,0,-1):[]},Ln.intersection=Po,Ln.intersectionBy=To,Ln.intersectionWith=No,Ln.invert=gc,Ln.invertBy=vc,Ln.invokeMap=ui,Ln.iteratee=$c,Ln.keyBy=li,Ln.keys=bc,Ln.keysIn=xc,Ln.map=fi,Ln.mapKeys=function(e,t){var n={};return t=Ka(t,3),sr(e,(function(e,r,a){qn(n,t(e,r,a),e)})),n},Ln.mapValues=function(e,t){var n={};return t=Ka(t,3),sr(e,(function(e,r,a){qn(n,r,t(e,r,a))})),n},Ln.matches=function(e){return Ar(Jn(e,1))},Ln.matchesProperty=function(e,t){return Lr(e,Jn(t,1))},Ln.memoize=Si,Ln.merge=wc,Ln.mergeWith=Sc,Ln.method=qc,Ln.methodOf=Yc,Ln.mixin=Kc,Ln.negate=_i,Ln.nthArg=function(e){return e=nc(e),Nr((function(t){return Dr(t,e)}))},Ln.omit=_c,Ln.omitBy=function(e,t){return Oc(e,_i(Ka(t)))},Ln.once=function(e){return gi(2,e)},Ln.orderBy=function(e,t,n,r){return null==e?[]:(Ri(t)||(t=null==t?[]:[t]),Ri(n=r?void 0:n)||(n=null==n?[]:[n]),Mr(e,t,n))},Ln.over=Zc,Ln.overArgs=Ei,Ln.overEvery=Qc,Ln.overSome=Xc,Ln.partial=Oi,Ln.partialRight=ki,Ln.partition=hi,Ln.pick=Ec,Ln.pickBy=Oc,Ln.property=es,Ln.propertyOf=function(e){return function(t){return null==e?void 0:fr(e,t)}},Ln.pull=Fo,Ln.pullAll=Go,Ln.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Cr(e,t,Ka(n,2)):e},Ln.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Cr(e,t,void 0,n):e},Ln.pullAt=Vo,Ln.range=ts,Ln.rangeRight=ns,Ln.rearg=Ai,Ln.reject=function(e,t){return(Ri(e)?it:ar)(e,_i(Ka(t,3)))},Ln.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,a=[],o=e.length;for(t=Ka(t,3);++r<o;){var i=e[r];t(i,r,e)&&(n.push(i),a.push(r))}return jr(e,a),n},Ln.rest=function(e,t){if("function"!=typeof e)throw new ve(n);return Nr(e,t=void 0===t?t:nc(t))},Ln.reverse=Uo,Ln.sampleSize=function(e,t,n){return t=(n?io(e,t,n):void 0===t)?1:nc(t),(Ri(e)?Gn:Fr)(e,t)},Ln.set=function(e,t,n){return null==e?e:Gr(e,t,n)},Ln.setWith=function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:Gr(e,t,n,r)},Ln.shuffle=function(e){return(Ri(e)?Vn:Br)(e)},Ln.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&io(e,t,n)?(t=0,n=r):(t=null==t?0:nc(t),n=void 0===n?r:nc(n)),Hr(e,t,n)):[]},Ln.sortBy=di,Ln.sortedUniq=function(e){return e&&e.length?Yr(e):[]},Ln.sortedUniqBy=function(e,t){return e&&e.length?Yr(e,Ka(t,2)):[]},Ln.split=function(e,t,n){return n&&"number"!=typeof n&&io(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=ic(e))&&("string"==typeof t||null!=t&&!qi(t))&&!(t=Jr(t))&&Tt(e)?sa(Bt(e),0,n):e.split(t,n):[]},Ln.spread=function(e,t){if("function"!=typeof e)throw new ve(n);return t=null==t?0:on(nc(t),0),Nr((function(n){var r=n[t],a=sa(n,0,t);return r&&lt(a,r),tt(e,this,a)}))},Ln.tail=function(e){var t=null==e?0:e.length;return t?Hr(e,1,t):[]},Ln.take=function(e,t,n){return e&&e.length?Hr(e,0,(t=n||void 0===t?1:nc(t))<0?0:t):[]},Ln.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?Hr(e,(t=r-(t=n||void 0===t?1:nc(t)))<0?0:t,r):[]},Ln.takeRightWhile=function(e,t){return e&&e.length?ea(e,Ka(t,3),!1,!0):[]},Ln.takeWhile=function(e,t){return e&&e.length?ea(e,Ka(t,3)):[]},Ln.tap=function(e,t){return t(e),e},Ln.throttle=function(e,t,r){var a=!0,o=!0;if("function"!=typeof e)throw new ve(n);return Ui(r)&&(a="leading"in r?!!r.leading:a,o="trailing"in r?!!r.trailing:o),bi(e,t,{leading:a,maxWait:t,trailing:o})},Ln.thru=ti,Ln.toArray=ec,Ln.toPairs=kc,Ln.toPairsIn=Ac,Ln.toPath=function(e){return Ri(e)?ut(e,Oo):Ji(e)?[e]:ga(Eo(ic(e)))},Ln.toPlainObject=oc,Ln.transform=function(e,t,n){var r=Ri(e),a=r||Ti(e)||Zi(e);if(t=Ka(t,4),null==n){var o=e&&e.constructor;n=a?r?new o:[]:Ui(e)&&Fi(o)?Wn(He(e)):{}}return(a?rt:sr)(e,(function(e,r,a){return t(n,e,r,a)})),n},Ln.unary=function(e){return mi(e,1)},Ln.union=Bo,Ln.unionBy=Ho,Ln.unionWith=zo,Ln.uniq=function(e){return e&&e.length?Zr(e):[]},Ln.uniqBy=function(e,t){return e&&e.length?Zr(e,Ka(t,2)):[]},Ln.uniqWith=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Zr(e,void 0,t):[]},Ln.unset=function(e,t){return null==e||Qr(e,t)},Ln.unzip=$o,Ln.unzipWith=qo,Ln.update=function(e,t,n){return null==e?e:Xr(e,t,oa(n))},Ln.updateWith=function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:Xr(e,t,oa(n),r)},Ln.values=Lc,Ln.valuesIn=function(e){return null==e?[]:Lt(e,xc(e))},Ln.without=Yo,Ln.words=Fc,Ln.wrap=function(e,t){return Oi(oa(t),e)},Ln.xor=Ko,Ln.xorBy=Jo,Ln.xorWith=Zo,Ln.zip=Qo,Ln.zipObject=function(e,t){return ra(e||[],t||[],Bn)},Ln.zipObjectDeep=function(e,t){return ra(e||[],t||[],Gr)},Ln.zipWith=Xo,Ln.entries=kc,Ln.entriesIn=Ac,Ln.extend=sc,Ln.extendWith=uc,Kc(Ln,Ln),Ln.add=is,Ln.attempt=Gc,Ln.camelCase=Wc,Ln.capitalize=Dc,Ln.ceil=cs,Ln.clamp=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=ac(n))==n?n:0),void 0!==t&&(t=(t=ac(t))==t?t:0),Kn(ac(e),t,n)},Ln.clone=function(e){return Jn(e,4)},Ln.cloneDeep=function(e){return Jn(e,5)},Ln.cloneDeepWith=function(e,t){return Jn(e,5,t="function"==typeof t?t:void 0)},Ln.cloneWith=function(e,t){return Jn(e,4,t="function"==typeof t?t:void 0)},Ln.conformsTo=function(e,t){return null==t||Zn(e,t,bc(t))},Ln.deburr=Mc,Ln.defaultTo=function(e,t){return null==e||e!=e?t:e},Ln.divide=ss,Ln.endsWith=function(e,t,n){e=ic(e),t=Jr(t);var r=e.length,a=n=void 0===n?r:Kn(nc(n),0,r);return(n-=t.length)>=0&&e.slice(n,a)==t},Ln.eq=Li,Ln.escape=function(e){return(e=ic(e))&&N.test(e)?e.replace(P,jt):e},Ln.escapeRegExp=function(e){return(e=ic(e))&&z.test(e)?e.replace(H,"\\$&"):e},Ln.every=function(e,t,n){var r=Ri(e)?ot:nr;return n&&io(e,t,n)&&(t=void 0),r(e,Ka(t,3))},Ln.find=ai,Ln.findIndex=Mo,Ln.findKey=function(e,t){return mt(e,Ka(t,3),sr)},Ln.findLast=oi,Ln.findLastIndex=Ro,Ln.findLastKey=function(e,t){return mt(e,Ka(t,3),ur)},Ln.floor=us,Ln.forEach=ii,Ln.forEachRight=ci,Ln.forIn=function(e,t){return null==e?e:ir(e,Ka(t,3),xc)},Ln.forInRight=function(e,t){return null==e?e:cr(e,Ka(t,3),xc)},Ln.forOwn=function(e,t){return e&&sr(e,Ka(t,3))},Ln.forOwnRight=function(e,t){return e&&ur(e,Ka(t,3))},Ln.get=pc,Ln.gt=Wi,Ln.gte=Di,Ln.has=function(e,t){return null!=e&&no(e,t,mr)},Ln.hasIn=mc,Ln.head=jo,Ln.identity=zc,Ln.includes=function(e,t,n,r){e=ji(e)?e:Lc(e),n=n&&!r?nc(n):0;var a=e.length;return n<0&&(n=on(a+n,0)),Ki(e)?n<=a&&e.indexOf(t,n)>-1:!!a&&vt(e,t,n)>-1},Ln.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var a=null==n?0:nc(n);return a<0&&(a=on(r+a,0)),vt(e,t,a)},Ln.inRange=function(e,t,n){return t=tc(t),void 0===n?(n=t,t=0):n=tc(n),function(e,t,n){return e>=cn(t,n)&&e<on(t,n)}(e=ac(e),t,n)},Ln.invoke=yc,Ln.isArguments=Mi,Ln.isArray=Ri,Ln.isArrayBuffer=Ci,Ln.isArrayLike=ji,Ln.isArrayLikeObject=Pi,Ln.isBoolean=function(e){return!0===e||!1===e||Bi(e)&&dr(e)==s},Ln.isBuffer=Ti,Ln.isDate=Ni,Ln.isElement=function(e){return Bi(e)&&1===e.nodeType&&!$i(e)},Ln.isEmpty=function(e){if(null==e)return!0;if(ji(e)&&(Ri(e)||"string"==typeof e||"function"==typeof e.splice||Ti(e)||Zi(e)||Mi(e)))return!e.length;var t=to(e);if(t==d||t==v)return!e.size;if(lo(e))return!Er(e).length;for(var n in e)if(Se.call(e,n))return!1;return!0},Ln.isEqual=function(e,t){return xr(e,t)},Ln.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===r?xr(e,t,void 0,n):!!r},Ln.isError=Ii,Ln.isFinite=function(e){return"number"==typeof e&&nn(e)},Ln.isFunction=Fi,Ln.isInteger=Gi,Ln.isLength=Vi,Ln.isMap=Hi,Ln.isMatch=function(e,t){return e===t||wr(e,t,Za(t))},Ln.isMatchWith=function(e,t,n){return n="function"==typeof n?n:void 0,wr(e,t,Za(t),n)},Ln.isNaN=function(e){return zi(e)&&e!=+e},Ln.isNative=function(e){if(uo(e))throw new fe("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Sr(e)},Ln.isNil=function(e){return null==e},Ln.isNull=function(e){return null===e},Ln.isNumber=zi,Ln.isObject=Ui,Ln.isObjectLike=Bi,Ln.isPlainObject=$i,Ln.isRegExp=qi,Ln.isSafeInteger=function(e){return Gi(e)&&e>=-9007199254740991&&e<=9007199254740991},Ln.isSet=Yi,Ln.isString=Ki,Ln.isSymbol=Ji,Ln.isTypedArray=Zi,Ln.isUndefined=function(e){return void 0===e},Ln.isWeakMap=function(e){return Bi(e)&&to(e)==x},Ln.isWeakSet=function(e){return Bi(e)&&"[object WeakSet]"==dr(e)},Ln.join=function(e,t){return null==e?"":rn.call(e,t)},Ln.kebabCase=Rc,Ln.last=Io,Ln.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var a=r;return void 0!==n&&(a=(a=nc(n))<0?on(r+a,0):cn(a,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,a):gt(e,bt,a,!0)},Ln.lowerCase=Cc,Ln.lowerFirst=jc,Ln.lt=Qi,Ln.lte=Xi,Ln.max=function(e){return e&&e.length?rr(e,zc,pr):void 0},Ln.maxBy=function(e,t){return e&&e.length?rr(e,Ka(t,2),pr):void 0},Ln.mean=function(e){return xt(e,zc)},Ln.meanBy=function(e,t){return xt(e,Ka(t,2))},Ln.min=function(e){return e&&e.length?rr(e,zc,Or):void 0},Ln.minBy=function(e,t){return e&&e.length?rr(e,Ka(t,2),Or):void 0},Ln.stubArray=rs,Ln.stubFalse=as,Ln.stubObject=function(){return{}},Ln.stubString=function(){return""},Ln.stubTrue=function(){return!0},Ln.multiply=ls,Ln.nth=function(e,t){return e&&e.length?Dr(e,nc(t)):void 0},Ln.noConflict=function(){return Be._===this&&(Be._=Ae),this},Ln.noop=Jc,Ln.now=pi,Ln.pad=function(e,t,n){e=ic(e);var r=(t=nc(t))?Ut(e):0;if(!t||r>=t)return e;var a=(t-r)/2;return Ma(Xt(a),n)+e+Ma(Qt(a),n)},Ln.padEnd=function(e,t,n){e=ic(e);var r=(t=nc(t))?Ut(e):0;return t&&r<t?e+Ma(t-r,n):e},Ln.padStart=function(e,t,n){e=ic(e);var r=(t=nc(t))?Ut(e):0;return t&&r<t?Ma(t-r,n)+e:e},Ln.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),un(ic(e).replace($,""),t||0)},Ln.random=function(e,t,n){if(n&&"boolean"!=typeof n&&io(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=tc(e),void 0===t?(t=e,e=0):t=tc(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var a=ln();return cn(e+a*(t-e+Fe("1e-"+((a+"").length-1))),t)}return Pr(e,t)},Ln.reduce=function(e,t,n){var r=Ri(e)?ft:_t,a=arguments.length<3;return r(e,Ka(t,4),n,a,er)},Ln.reduceRight=function(e,t,n){var r=Ri(e)?ht:_t,a=arguments.length<3;return r(e,Ka(t,4),n,a,tr)},Ln.repeat=function(e,t,n){return t=(n?io(e,t,n):void 0===t)?1:nc(t),Tr(ic(e),t)},Ln.replace=function(){var e=arguments,t=ic(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Ln.result=function(e,t,n){var r=-1,a=(t=ia(t,e)).length;for(a||(a=1,e=void 0);++r<a;){var o=null==e?void 0:e[Oo(t[r])];void 0===o&&(r=a,o=n),e=Fi(o)?o.call(e):o}return e},Ln.round=fs,Ln.runInContext=e,Ln.sample=function(e){return(Ri(e)?Fn:Ir)(e)},Ln.size=function(e){if(null==e)return 0;if(ji(e))return Ki(e)?Ut(e):e.length;var t=to(e);return t==d||t==v?e.size:Er(e).length},Ln.snakeCase=Pc,Ln.some=function(e,t,n){var r=Ri(e)?dt:zr;return n&&io(e,t,n)&&(t=void 0),r(e,Ka(t,3))},Ln.sortedIndex=function(e,t){return $r(e,t)},Ln.sortedIndexBy=function(e,t,n){return qr(e,t,Ka(n,2))},Ln.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=$r(e,t);if(r<n&&Li(e[r],t))return r}return-1},Ln.sortedLastIndex=function(e,t){return $r(e,t,!0)},Ln.sortedLastIndexBy=function(e,t,n){return qr(e,t,Ka(n,2),!0)},Ln.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=$r(e,t,!0)-1;if(Li(e[n],t))return n}return-1},Ln.startCase=Tc,Ln.startsWith=function(e,t,n){return e=ic(e),n=null==n?0:Kn(nc(n),0,e.length),t=Jr(t),e.slice(n,n+t.length)==t},Ln.subtract=hs,Ln.sum=function(e){return e&&e.length?Et(e,zc):0},Ln.sumBy=function(e,t){return e&&e.length?Et(e,Ka(t,2)):0},Ln.template=function(e,t,n){var r=Ln.templateSettings;n&&io(e,t,n)&&(t=void 0),e=ic(e),t=uc({},t,r,Fa);var a,o,i=uc({},t.imports,r.imports,Fa),c=bc(i),s=Lt(i,c),u=0,l=t.interpolate||se,f="__p += '",h=me((t.escape||se).source+"|"+l.source+"|"+(l===G?ee:se).source+"|"+(t.evaluate||se).source+"|$","g"),d="//# sourceURL="+(Se.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Pe+"]")+"\n";e.replace(h,(function(t,n,r,i,c,s){return r||(r=i),f+=e.slice(u,s).replace(ue,Pt),n&&(a=!0,f+="' +\n__e("+n+") +\n'"),c&&(o=!0,f+="';\n"+c+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=s+t.length,t})),f+="';\n";var p=Se.call(t,"variable")&&t.variable;if(p){if(Q.test(p))throw new fe("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(o?f.replace(M,""):f).replace(R,"$1").replace(C,"$1;"),f="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var m=Gc((function(){return he(c,d+"return "+f).apply(void 0,s)}));if(m.source=f,Ii(m))throw m;return m},Ln.times=function(e,t){if((e=nc(e))<1||e>9007199254740991)return[];var n=4294967295,r=cn(e,4294967295);e-=4294967295;for(var a=Ot(r,t=Ka(t));++n<e;)t(n);return a},Ln.toFinite=tc,Ln.toInteger=nc,Ln.toLength=rc,Ln.toLower=function(e){return ic(e).toLowerCase()},Ln.toNumber=ac,Ln.toSafeInteger=function(e){return e?Kn(nc(e),-9007199254740991,9007199254740991):0===e?e:0},Ln.toString=ic,Ln.toUpper=function(e){return ic(e).toUpperCase()},Ln.trim=function(e,t,n){if((e=ic(e))&&(n||void 0===t))return kt(e);if(!e||!(t=Jr(t)))return e;var r=Bt(e),a=Bt(t);return sa(r,Dt(r,a),Mt(r,a)+1).join("")},Ln.trimEnd=function(e,t,n){if((e=ic(e))&&(n||void 0===t))return e.slice(0,Ht(e)+1);if(!e||!(t=Jr(t)))return e;var r=Bt(e);return sa(r,0,Mt(r,Bt(t))+1).join("")},Ln.trimStart=function(e,t,n){if((e=ic(e))&&(n||void 0===t))return e.replace($,"");if(!e||!(t=Jr(t)))return e;var r=Bt(e);return sa(r,Dt(r,Bt(t))).join("")},Ln.truncate=function(e,t){var n=30,r="...";if(Ui(t)){var a="separator"in t?t.separator:a;n="length"in t?nc(t.length):n,r="omission"in t?Jr(t.omission):r}var o=(e=ic(e)).length;if(Tt(e)){var i=Bt(e);o=i.length}if(n>=o)return e;var c=n-Ut(r);if(c<1)return r;var s=i?sa(i,0,c).join(""):e.slice(0,c);if(void 0===a)return s+r;if(i&&(c+=s.length-c),qi(a)){if(e.slice(c).search(a)){var u,l=s;for(a.global||(a=me(a.source,ic(te.exec(a))+"g")),a.lastIndex=0;u=a.exec(l);)var f=u.index;s=s.slice(0,void 0===f?c:f)}}else if(e.indexOf(Jr(a),c)!=c){var h=s.lastIndexOf(a);h>-1&&(s=s.slice(0,h))}return s+r},Ln.unescape=function(e){return(e=ic(e))&&T.test(e)?e.replace(j,zt):e},Ln.uniqueId=function(e){var t=++_e;return ic(e)+t},Ln.upperCase=Nc,Ln.upperFirst=Ic,Ln.each=ii,Ln.eachRight=ci,Ln.first=jo,Kc(Ln,(os={},sr(Ln,(function(e,t){Se.call(Ln.prototype,t)||(os[t]=e)})),os),{chain:!1}),Ln.VERSION="4.17.21",rt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Ln[e].placeholder=Ln})),rt(["drop","take"],(function(e,t){Rn.prototype[e]=function(n){n=void 0===n?1:on(nc(n),0);var r=this.__filtered__&&!t?new Rn(this):this.clone();return r.__filtered__?r.__takeCount__=cn(n,r.__takeCount__):r.__views__.push({size:cn(n,4294967295),type:e+(r.__dir__<0?"Right":"")}),r},Rn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),rt(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Rn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Ka(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),rt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Rn.prototype[e]=function(){return this[n](1).value()[0]}})),rt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Rn.prototype[e]=function(){return this.__filtered__?new Rn(this):this[n](1)}})),Rn.prototype.compact=function(){return this.filter(zc)},Rn.prototype.find=function(e){return this.filter(e).head()},Rn.prototype.findLast=function(e){return this.reverse().find(e)},Rn.prototype.invokeMap=Nr((function(e,t){return"function"==typeof e?new Rn(this):this.map((function(n){return yr(n,e,t)}))})),Rn.prototype.reject=function(e){return this.filter(_i(Ka(e)))},Rn.prototype.slice=function(e,t){e=nc(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Rn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=nc(t))<0?n.dropRight(-t):n.take(t-e)),n)},Rn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Rn.prototype.toArray=function(){return this.take(4294967295)},sr(Rn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),a=Ln[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);a&&(Ln.prototype[t]=function(){var t=this.__wrapped__,i=r?[1]:arguments,c=t instanceof Rn,s=i[0],u=c||Ri(t),l=function(e){var t=a.apply(Ln,lt([e],i));return r&&f?t[0]:t};u&&n&&"function"==typeof s&&1!=s.length&&(c=u=!1);var f=this.__chain__,h=!!this.__actions__.length,d=o&&!f,p=c&&!h;if(!o&&u){t=p?t:new Rn(this);var m=e.apply(t,i);return m.__actions__.push({func:ti,args:[l],thisArg:void 0}),new Mn(m,f)}return d&&p?e.apply(this,i):(m=this.thru(l),d?r?m.value()[0]:m.value():m)})})),rt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=ye[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Ln.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var a=this.value();return t.apply(Ri(a)?a:[],e)}return this[n]((function(n){return t.apply(Ri(n)?n:[],e)}))}})),sr(Rn.prototype,(function(e,t){var n=Ln[t];if(n){var r=n.name+"";Se.call(bn,r)||(bn[r]=[]),bn[r].push({name:t,func:n})}})),bn[Aa(void 0,2).name]=[{name:"wrapper",func:void 0}],Rn.prototype.clone=function(){var e=new Rn(this.__wrapped__);return e.__actions__=ga(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ga(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ga(this.__views__),e},Rn.prototype.reverse=function(){if(this.__filtered__){var e=new Rn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Rn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Ri(e),r=t<0,a=n?e.length:0,o=function(e,t,n){for(var r=-1,a=n.length;++r<a;){var o=n[r],i=o.size;switch(o.type){case"drop":e+=i;break;case"dropRight":t-=i;break;case"take":t=cn(t,e+i);break;case"takeRight":e=on(e,t-i)}}return{start:e,end:t}}(0,a,this.__views__),i=o.start,c=o.end,s=c-i,u=r?c:i-1,l=this.__iteratees__,f=l.length,h=0,d=cn(s,this.__takeCount__);if(!n||!r&&a==s&&d==s)return ta(e,this.__actions__);var p=[];e:for(;s--&&h<d;){for(var m=-1,g=e[u+=t];++m<f;){var v=l[m],y=v.type,b=(0,v.iteratee)(g);if(2==y)g=b;else if(!b){if(1==y)continue e;break e}}p[h++]=g}return p},Ln.prototype.at=ni,Ln.prototype.chain=function(){return ei(this)},Ln.prototype.commit=function(){return new Mn(this.value(),this.__chain__)},Ln.prototype.next=function(){void 0===this.__values__&&(this.__values__=ec(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},Ln.prototype.plant=function(e){for(var t,n=this;n instanceof Dn;){var r=Ao(n);r.__index__=0,r.__values__=void 0,t?a.__wrapped__=r:t=r;var a=r;n=n.__wrapped__}return a.__wrapped__=e,t},Ln.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Rn){var t=e;return this.__actions__.length&&(t=new Rn(this)),(t=t.reverse()).__actions__.push({func:ti,args:[Uo],thisArg:void 0}),new Mn(t,this.__chain__)}return this.thru(Uo)},Ln.prototype.toJSON=Ln.prototype.valueOf=Ln.prototype.value=function(){return ta(this.__wrapped__,this.__actions__)},Ln.prototype.first=Ln.prototype.head,St&&(Ln.prototype[St]=function(){return this}),Ln}();ze?((ze.exports=$t)._=$t,He._=$t):Be._=$t}).call(i)})),Lt={trap:{name:d("trap"),type:"building",craft:{maximum:10,availableMsg:d("builder says she can make traps to catch any creatures might still be alive out there"),buildMsg:d("more traps to catch more creatures"),maxMsg:d("more traps won't help now"),type:"building",cost:function(e){return{wood:10+10*(e.game.buildings.trap||0)}}}},cart:{name:d("cart"),type:"building",craft:{maximum:1,availableMsg:d("builder says she can make a cart for carrying wood"),buildMsg:d("the rickety cart will carry more wood from the forest"),type:"building",cost:function(){return{wood:30}}}},hut:{name:d("hut"),type:"building",craft:{maximum:20,availableMsg:d("builder says there are more wanderers. says they'll work, too."),buildMsg:d("builder puts up a hut, out in the forest. says word will get around."),maxMsg:d("no more room for huts."),type:"building",cost:function(e){return{wood:100+50*(e.game.buildings.hut||0)}}}},lodge:{name:d("lodge"),type:"building",craft:{maximum:1,availableMsg:d("villagers could help hunt, given the means"),buildMsg:d("the hunting lodge stands in the forest, a ways out of town"),type:"building",cost:function(){return{wood:200,fur:10,meat:5}}}},trading_post:{name:d("trading post"),type:"building",craft:{maximum:1,availableMsg:d("a trading post would make commerce easier"),buildMsg:d("now the nomads have a place to set up shop, they might stick around a while"),type:"building",cost:function(){return{wood:400,fur:100}}}},tannery:{name:d("tannery"),type:"building",craft:{maximum:1,availableMsg:d("builder says leather could be useful. says the villagers could make it."),buildMsg:d("tannery goes up quick, on the edge of the village"),type:"building",cost:function(){return{wood:500,fur:50}}}},smokehouse:{name:d("smokehouse"),type:"building",craft:{maximum:1,availableMsg:d("should cure the meat, or it'll spoil. builder says she can fix something up."),buildMsg:d("builder finishes the smokehouse. she looks hungry."),type:"building",cost:function(){return{wood:600,meat:50}}}},workshop:{name:d("workshop"),type:"building",craft:{maximum:1,availableMsg:d("builder says she could make finer things, if she had the tools"),buildMsg:d("workshop's finally ready. builder's excited to get to it"),type:"building",cost:function(){return{wood:800,leather:100,scales:10}}}},steelworks:{name:d("steelworks"),type:"building",craft:{maximum:1,availableMsg:d("builder says the villagers could make steel, given the tools"),buildMsg:d("a haze falls over the village as the steelworks fires up"),type:"building",cost:function(){return{wood:1500,iron:100,coal:100}}}},armoury:{name:d("armoury"),type:"building",craft:{maximum:1,availableMsg:d("builder says it'd be useful to have a steady source of bullets"),buildMsg:d("armoury's done, welcoming back the weapons of the past."),type:"building",cost:function(){return{wood:3e3,steel:100,sulphur:50}}}},torch:{name:d("torch"),type:"tool",craft:{type:"tool",buildMsg:d("a torch to keep the dark away"),cost:function(){return{wood:1,cloth:1}}}},waterskin:{name:d("waterskin"),type:"upgrade",craft:{type:"upgrade",maximum:1,buildMsg:d("this waterskin'll hold a bit of water, at least"),cost:function(){return{leather:50}}}},cask:{name:d("cask"),type:"upgrade",craft:{type:"upgrade",maximum:1,buildMsg:d("the cask holds enough water for longer expeditions"),cost:function(){return{leather:100,iron:20}}}},water_tank:{name:d("water tank"),type:"upgrade",craft:{type:"upgrade",maximum:1,buildMsg:d("never go thirsty again"),cost:function(){return{iron:100,steel:50}}}},bone_spear:{name:d("bone spear"),type:"weapon",craft:{type:"weapon",buildMsg:d("this spear's not elegant, but it's pretty good at stabbing"),cost:function(){return{wood:100,teeth:5}}},weapon:{verb:d("stab"),type:"melee",damage:2,cooldown:2}},rucksack:{name:d("rucksack"),type:"upgrade",craft:{type:"upgrade",maximum:1,buildMsg:d("carrying more means longer expeditions to the wilds"),cost:function(){return{leather:200}}}},wagon:{name:d("wagon"),type:"upgrade",craft:{type:"upgrade",maximum:1,buildMsg:d("the wagon can carry a lot of supplies"),cost:function(){return{wood:500,iron:100}}}},convoy:{name:d("convoy"),type:"upgrade",craft:{type:"upgrade",maximum:1,buildMsg:d("the convoy can haul mostly everything"),cost:function(){return{wood:1e3,iron:200,steel:100}}}},l_armour:{name:d("l armour"),type:"upgrade",craft:{type:"upgrade",maximum:1,buildMsg:d("leather's not strong. better than rags, though."),cost:function(){return{leather:200,scales:20}}}},i_armour:{name:d("i armour"),type:"upgrade",craft:{type:"upgrade",maximum:1,buildMsg:d("iron's stronger than leather"),cost:function(){return{leather:200,iron:100}}}},s_armour:{name:d("s armour"),type:"upgrade",craft:{type:"upgrade",maximum:1,buildMsg:d("steel's stronger than iron"),cost:function(){return{leather:200,steel:100}}}},iron_sword:{name:d("iron sword"),type:"weapon",craft:{type:"weapon",buildMsg:d("sword is sharp. good protection out in the wilds."),cost:function(){return{wood:200,leather:50,iron:20}}},weapon:{verb:d("swing"),type:"melee",damage:4,cooldown:2}},steel_sword:{name:d("steel sword"),type:"weapon",craft:{type:"weapon",buildMsg:d("the steel is strong, and the blade true."),cost:function(){return{wood:500,leather:100,steel:20}}},weapon:{verb:d("slash"),type:"melee",damage:6,cooldown:2}},rifle:{name:d("rifle"),type:"weapon",craft:{type:"weapon",buildMsg:d("black powder and bullets, like the old days."),cost:function(){return{wood:200,steel:50,sulphur:50}}},weapon:{verb:d("shoot"),type:"ranged",damage:5,cooldown:1,cost:{bullets:1}}},cured_meat:{name:d("cured meat"),type:"tool",desc:d("restores")+" 8 "+d("hp")},bullets:{name:d("bullets"),type:"tool",desc:d("use with rifle"),trade:{type:"good",cost:function(){return{scales:10}}}},grenade:{name:d("grenade"),type:"weapon",weapon:{verb:d("lob"),type:"ranged",damage:15,cooldown:5,cost:{grenade:1}},trade:{type:"weapon",cost:function(){return{scales:100,teeth:50}}}},bolas:{name:d("bolas"),type:"weapon",weapon:{verb:d("tangle"),type:"ranged",damage:"stun",cooldown:15,cost:{bolas:1}},trade:{type:"weapon",cost:function(){return{teeth:10}}}},laser_rifle:{name:d("laser rifle"),type:"weapon",weapon:{verb:d("blast"),type:"ranged",damage:8,cooldown:1,cost:{energy_cell:1}}},energy_cell:{name:d("energy cell"),type:"tool",desc:d("emits a soft red glow"),trade:{type:"good",cost:function(){return{scales:10,teeth:10}}}},bayonet:{name:d("bayonet"),type:"weapon",weapon:{verb:d("thrust"),type:"melee",damage:8,cooldown:2},trade:{type:"weapon",cost:function(){return{scales:500,teeth:250}}}},charm:{name:d("charm"),type:"tool"},medicine:{name:d("medicine"),type:"tool",desc:d("restores")+" 20 "+d("hp"),trade:{type:"good",cost:function(){return{scales:50,teeth:30}}}},wood:{name:d("wood"),type:"resouce"},fur:{name:d("fur"),type:"resouce"},meat:{name:d("meat"),type:"resouce"},iron:{name:d("iron"),type:"resouce",trade:{type:"good",cost:function(){return{fur:150,scales:50}}}},coal:{name:d("coal"),type:"resouce",trade:{type:"good",cost:function(){return{fur:200,teeth:50}}}},sulphur:{name:d("sulphur"),type:"resouce"},steel:{name:d("steel"),type:"resouce",trade:{type:"good",cost:function(){return{fur:300,scales:50,teeth:50}}}},scales:{name:d("scales"),type:"resouce",trade:{type:"good",cost:function(){return{fur:150}}}},teeth:{name:d("teeth"),type:"resouce",trade:{type:"good",cost:function(){return{fur:300}}}},leather:{name:d("leather"),type:"resouce"},bait:{name:d("bait"),type:"resouce"},cloth:{name:d("cloth"),type:"resouce"},alien_alloy:{name:d("alien alloy"),type:"resouce",trade:{type:"good",cost:function(){return{fur:1500,scales:750,teeth:300}}}},compass:{name:d("compass"),type:"prop",trade:{type:"special",maximum:1,cost:function(){return{fur:400,scales:20,teeth:10}}}},fists:{name:d("fists"),type:"weapon",weapon:{verb:d("punch"),type:"unarmed",damage:1,cooldown:2}}};(dt=e.CraftableCategory||(e.CraftableCategory={})).trap="trap",dt.cart="cart",dt.hut="hut",dt.lodge="lodge",dt.trading_post="trading_post",dt.tannery="tannery",dt.smokehouse="smokehouse",dt.workshop="workshop",dt.steelworks="steelworks",dt.armoury="armoury",dt.torch="torch",dt.waterskin="waterskin",dt.cask="cask",dt.water_tank="water_tank",dt.bone_spear="bone_spear",dt.rucksack="rucksack",dt.wagon="wagon",dt.convoy="convoy",dt.l_armour="l_armour",dt.i_armour="i_armour",dt.s_armour="s_armour",dt.iron_sword="iron_sword",dt.steel_sword="steel_sword",dt.rifle="rifle",(pt=e.TradeCategory||(e.TradeCategory={})).scales="scales",pt.teeth="teeth",pt.iron="iron",pt.coal="coal",pt.steel="steel",pt.medicine="medicine",pt.bullets="bullets",pt.energy_cell="energy_cell",pt.bolas="bolas",pt.grenade="grenade",pt.bayonet="bayonet",pt.alien_alloy="alien_alloy",pt.compass="compass",function(e){e.cured_meat="cured_meat",e.bullets="bullets",e.grenade="grenade",e.bolas="bolas",e.laser_rifle="laser_rifle",e.energy_cell="energy_cell",e.bayonet="bayonet",e.charm="charm",e.medicine="medicine"}(mt||(mt={})),(gt=e.WeaponCategory||(e.WeaponCategory={})).fists="fists",gt.bone_spear="bone_spear",gt.iron_sword="iron_sword",gt.steel_sword="steel_sword",gt.bayonet="bayonet",gt.rifle="rifle",gt.laser_rifle="laser_rifle",gt.grenade="grenade",gt.bolas="bolas";var Wt=Object.keys(r({},mt,e.CraftableCategory)).filter((function(e){var t=Lt[e];return"tool"===t.type||"weapon"===t.type})),Dt={VILLAGE:"A",IRON_MINE:"I",COAL_MINE:"C",SULPHUR_MINE:"S",FOREST:";",FIELD:",",BARRENS:".",ROAD:"#",HOUSE:"H",CAVE:"V",TOWN:"O",CITY:"Y",OUTPOST:"P",SHIP:"W",BOREHOLE:"B",BATTLEFIELD:"F",SWAMP:"M",CACHE:"U"},Mt={items:Lt,Engine:{VERSION:1.3,MAX_STORE:99999999999999,SAVE_DISPLAY:3e4},World:{name:"World",RADIUS:30,VILLAGE_POS:[30,30],TILE:Dt,TILE_PROBS:(tt={},tt[Dt.FOREST]=.15,tt[Dt.FIELD]=.35,tt[Dt.BARRENS]=.5,tt),LANDMARKS:(nt={},nt[Dt.OUTPOST]={num:0,minRadius:0,maxRadius:0,scene:"outpost",label:d("An&nbsp;Outpost")},nt[Dt.IRON_MINE]={num:1,minRadius:5,maxRadius:5,scene:"ironmine",label:d("Iron&nbsp;Mine")},nt[Dt.COAL_MINE]={num:1,minRadius:10,maxRadius:10,scene:"coalmine",label:d("Coal&nbsp;Mine")},nt[Dt.SULPHUR_MINE]={num:1,minRadius:20,maxRadius:20,scene:"sulphurmine",label:d("Sulphur&nbsp;Mine")},nt[Dt.HOUSE]={num:10,minRadius:0,maxRadius:45,scene:"house",label:d("An&nbsp;Old&nbsp;House")},nt[Dt.CAVE]={num:5,minRadius:3,maxRadius:10,scene:"cave",label:d("A&nbsp;Damp&nbsp;Cave")},nt[Dt.TOWN]={num:10,minRadius:10,maxRadius:20,scene:"town",label:d("An&nbsp;Abandoned&nbsp;Town")},nt[Dt.CITY]={num:20,minRadius:20,maxRadius:45,scene:"city",label:d("A&nbsp;Ruined&nbsp;City")},nt[Dt.SHIP]={num:1,minRadius:28,maxRadius:28,scene:"ship",label:d("A&nbsp;Crashed&nbsp;Starship")},nt[Dt.BOREHOLE]={num:10,minRadius:15,maxRadius:45,scene:"borehole",label:d("A&nbsp;Borehole")},nt[Dt.BATTLEFIELD]={num:5,minRadius:18,maxRadius:45,scene:"battlefield",label:d("A&nbsp;Battlefield")},nt[Dt.SWAMP]={num:1,minRadius:15,maxRadius:45,scene:"swamp",label:d("A&nbsp;Murky&nbsp;Swamp")},nt),STICKINESS:.5,LIGHT_RADIUS:2,BASE_WATER:10,MOVES_PER_FOOD:2,MOVES_PER_WATER:1,DEATH_COOLDOWN:120,FIGHT_CHANCE:.2,BASE_HEALTH:10,BASE_HIT_CHANCE:.8,MEAT_HEAL:8,MEDS_HEAL:20,FIGHT_DELAY:3,NORTH:[0,-1],SOUTH:[0,1],WEST:[-1,0],EAST:[1,0]},Room:{name:"Room",FIRE_COOL_DELAY:3e5,ROOM_WARM_DELAY:3e4,BUILDER_STATE_DELAY:3e4,STOKE_COOLDOWN:10,NEED_WOOD_DELAY:15e3,MiscItems:["laser_rifle"],FireStatus:{Dead:{status:"Dead",value:0,text:d("dead")},Smoldering:{status:"Smoldering",value:1,text:d("smoldering")},Flickering:{status:"Flickering",value:2,text:d("flickering")},Burning:{status:"Burning",value:3,text:d("burning")},Roaring:{status:"Roaring",value:4,text:d("roaring")}},TemperatureStatus:{Freezing:{value:0,text:d("freezing")},Cold:{value:1,text:d("cold")},Mild:{value:2,text:d("mild")},Warm:{value:3,text:d("warm")},Hot:{value:4,text:d("hot")}}},Event:{EVENT_TIME_RANGE:[3,6],PANEL_FADE:200,FIGHT_SPEED:100,EAT_COOLDOWN:5,MEDS_COOLDOWN:7,LEAVE_COOLDOWN:1,STUN_DURATION:4e3},Outside:{name:d("Outside"),STORES_OFFSET:0,GATHER_DELAY:60,TRAPS_DELAY:90,POP_DELAY:[.5,3],HUT_ROOM:4,INCOME:{gatherer:{name:d("gatherer"),delay:10,stores:(rt={},rt[e.StoreCategory.wood]=1,rt)},hunter:{name:d("hunter"),delay:10,stores:(at={},at[e.StoreCategory.fur]=.5,at[e.StoreCategory.meat]=.5,at)},trapper:{name:d("trapper"),delay:10,stores:(ot={},ot[e.StoreCategory.meat]=-1,ot[e.StoreCategory.bait]=1,ot)},tanner:{name:d("tanner"),delay:10,stores:(it={},it[e.StoreCategory.fur]=-5,it[e.StoreCategory.leather]=1,it)},charcutier:{name:d("charcutier"),delay:10,stores:(ct={},ct[e.StoreCategory.meat]=-5,ct[e.StoreCategory.wood]=-5,ct[e.StoreCategory.cured_meat]=1,ct)},iron_miner:{name:d("iron miner"),delay:10,stores:(st={},st[e.StoreCategory.cured_meat]=-1,st[e.StoreCategory.iron]=1,st)},coal_miner:{name:d("coal miner"),delay:10,stores:(ut={},ut[e.StoreCategory.cured_meat]=-1,ut[e.StoreCategory.coal]=1,ut)},sulphur_miner:{name:d("sulphur miner"),delay:10,stores:(lt={},lt[e.StoreCategory.cured_meat]=-1,lt[e.StoreCategory.sulphur]=1,lt)},steelworker:{name:d("steelworker"),delay:10,stores:(ft={},ft[e.StoreCategory.iron]=-1,ft[e.StoreCategory.coal]=-1,ft[e.StoreCategory.steel]=1,ft)},armourer:{name:d("armourer"),delay:10,stores:(ht={},ht[e.StoreCategory.steel]=-1,ht[e.StoreCategory.sulphur]=-1,ht[e.StoreCategory.bullets]=1,ht)}},TrapDrops:[{rollUnder:.5,name:"fur",message:d("scraps of fur")},{rollUnder:.75,name:"meat",message:d("bits of meat")},{rollUnder:.85,name:"scales",message:d("strange scales")},{rollUnder:.93,name:"teeth",message:d("scattered teeth")},{rollUnder:.995,name:"cloth",message:d("tattered cloth")},{rollUnder:1,name:"charm",message:d("a crudely made charm")}]},Path:{DEFAULT_BAG_SPACE:10,STORES_OFFSET:0,Weight:{bone_spear:2,iron_sword:3,steel_sword:5,rifle:5,bullets:.1,energy_cell:.2,laser_rifle:5,bolas:.5},name:d("A Dusty Path"),Outfit:Wt},Ship:{LIFTOFF_COOLDOWN:120,ALLOY_PER_HULL:1,ALLOY_PER_THRUSTER:1,BASE_HULL:0,BASE_THRUSTERS:1,name:d("Ship")},Space:{SHIP_SPEED:3,BASE_ASTEROID_DELAY:500,BASE_ASTEROID_SPEED:1500,FTB_SPEED:6e4,STAR_WIDTH:3e3,STAR_HEIGHT:3e3,NUM_STARS:200,STAR_SPEED:6e4,FRAME_DELAY:100},Prestige:{storesMap:[{store:e.StoreCategory.wood,type:"g"},{store:e.StoreCategory.fur,type:"g"},{store:e.StoreCategory.meat,type:"g"},{store:e.StoreCategory.iron,type:"g"},{store:e.StoreCategory.coal,type:"g"},{store:e.StoreCategory.sulphur,type:"g"},{store:e.StoreCategory.steel,type:"g"},{store:e.StoreCategory.cured_meat,type:"g"},{store:e.StoreCategory.scales,type:"g"},{store:e.StoreCategory.teeth,type:"g"},{store:e.StoreCategory.leather,type:"g"},{store:e.StoreCategory.bait,type:"g"},{store:e.StoreCategory.torch,type:"g"},{store:e.StoreCategory.cloth,type:"g"},{store:e.StoreCategory.bone_spear,type:"w"},{store:e.StoreCategory.iron_sword,type:"w"},{store:e.StoreCategory.steel_sword,type:"w"},{store:e.StoreCategory.bayonet,type:"w"},{store:e.StoreCategory.rifle,type:"w"},{store:e.StoreCategory.laser_rifle,type:"w"},{store:e.StoreCategory.bullets,type:"a"},{store:e.StoreCategory.energy_cell,type:"a"},{store:e.StoreCategory.grenade,type:"a"},{store:e.StoreCategory.bolas,type:"a"}]}};function Rt(e){var t=0;return"boolean"==typeof e?t=!1:"string"==typeof e?t="":null===e&&(t=null),t}var Ct={clean:function(e,t){!function e(t,n){if(!n)return Object.keys(t).forEach((function(n){e(t,n)}));var r=At.get(t,n);if(At.isObject(r))for(var a in At.isEmpty(r)&&delete t[n],r)e(r[a],a)}(e,t.payload)},removeM:function(e,t){t.payload.forEach((function(t){At.unset(e,t)}))},set:function(e,t){var n=Rt(t.payload);return t.payload||n},setM:function(e,t){for(var n in t.payload)if(void 0===t.payload[n])At.set(e,n,void 0);else{var r=Rt(t.payload[n]);At.set(e,n,t.payload[n]||r)}},addM:function(e,t){for(var n in t.payload)At.set(e,n,Math.min(Math.max(At.get(e,n,0)+(t.payload[n]||0),0),Mt.Engine.MAX_STORE))}};function jt(){return Object.values(e.StoreCategory).reduce((function(e,t){return e[t]=void 0,e}),{})}var Pt=qe({name:"stores",initialState:jt(),reducers:r({},Ct)}),Tt=Pt.actions,Nt=Pt.reducer,It=qe({name:"fire",initialState:{status:Mt.Room.FireStatus.Dead},reducers:{changeFire:function(e,t){e.status=t.payload}}}),Ft=r({},It.actions),Gt=It.reducer,Vt=qe({name:"builder",initialState:{level:-1},reducers:r({},Ct)}),Ut=Vt.actions,Bt=Vt.reducer,Ht=qe({name:"temperature",initialState:{status:Mt.Room.TemperatureStatus.Freezing},reducers:r({},Ct,{change:function(e,t){e.status=t.payload}})}),zt=Ht.actions,$t=Ht.reducer,qt=qe({name:"thieves",initialState:0,reducers:r({},Ct,{change:function(e,t){return t.payload}})}),Yt=qt.actions,Kt=qt.reducer,Jt=qe({name:"stolen",initialState:jt(),reducers:r({},Ct)}),Zt=Jt.actions,Qt=Jt.reducer,Xt=qe({name:"stores",initialState:{},reducers:r({},Ct)}),en=Xt.actions,tn=Xt.reducer,nn=qe({name:"population",initialState:{value:0},reducers:r({},Ct)}),rn=nn.actions,an=nn.reducer,on=qe({name:"workers",initialState:{},reducers:r({},Ct)}),cn=on.actions,sn=on.reducer,un=qe({name:"city",initialState:{cleared:!1},reducers:r({},Ct)}),ln=un.actions,fn=un.reducer,hn=qe({name:"world",initialState:{seenAll:!1,mask:[],map:[],enableShip:!1,ship:[0,0],dir:"",sulphurmine:!1,ironmine:!1,coalmine:!1,water:0,danger:!1,foodMove:0,waterMove:0,starvation:!1,thirst:!1,usedOutposts:{},curPos:At.cloneDeep(Mt.World.VILLAGE_POS),health:0,dead:!1,fightMove:0,outfit:{},stunned:0},reducers:r({},Ct,{seeAll:function(e,t){e.seenAll=t.payload},visit:function(e,t){var n=t.payload,r=n.x,a=n.y;e.map[r][a]=e.map[r][a].replace("!")+"!"},useOutpost:function(e){e.usedOutposts[e.curPos[0]+","+e.curPos[1]]=!0},setMap:function(e,t){var n=t.payload,r=n.pos;e.map[r[0]][r[1]]=n.value}})}),dn=r({},hn.actions),pn=hn.reducer,mn=qe({name:"space_ship",initialState:{hull:0,thrusters:1,seenShip:!1,seenWarning:!1},reducers:r({},Ct)}),gn=mn.actions,vn=mn.reducer,yn=qe({name:"outside",initialState:{seenForest:!1},reducers:r({},Ct)}),bn=yn.actions,xn=Oe({fire:Gt,builder:Bt,temperature:$t,thieves:Kt,stolen:Qt,buildings:tn,population:an,workers:sn,city:fn,world:pn,spaceShip:vn,outside:yn.reducer}),wn={fire:Ft,builder:Ut,temperature:zt,thieves:Yt,stolen:Zt,buildings:en,population:rn,workers:cn,city:ln,world:dn,spaceShip:gn,outside:bn},Sn=Xe("notifications/notify",function(){var e=n(h.mark((function e(t,n){var a,o,i;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(0,n.getState)(),i=(o=t.message).module,o.text.slice(-1),!i||a.engine.activeSpace==i){e.next=9;break}if(t.noQueue){e.next=7;break}return e.abrupt("return",t.message);case 7:e.next=10;break;case 9:return e.abrupt("return",r({},t.message,{_module:t.message.module,module:"global"}));case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),_n=qe({name:"notifications",initialState:{notifyQueue:{global:[]}},reducers:{spaceNotify:function(e,t){var n=e.notifyQueue[t.payload]||[];e.notifyQueue[t.payload]=[],n.forEach((function(e){e._module=e.module,e.module="global"})),e.notifyQueue.global=[].concat(e.notifyQueue.global,n)}},extraReducers:function(e){e.addCase(Sn.fulfilled,(function(e,t){var n=t.payload;if(n){var r=n.module||"global";e.notifyQueue[r]||(e.notifyQueue[r]=[]),e.notifyQueue[r].push(n)}}))}}),En=r({},_n.actions,{notify:Sn}),On=_n.reducer,kn=Xe("engine/changeSapce",function(){var e=n(h.mark((function e(t,n){var r;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,(0,n.getState)().engine.activeSpace!==t&&r(En.spaceNotify(t)),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),An=qe({name:"engine",initialState:{activeSubSpace:""},reducers:{changeSubSpace:function(e,t){e.activeSubSpace=t.payload}},extraReducers:function(e){e.addCase(kn.fulfilled,(function(e,t){e.activeSpace=t.payload}))}}),Ln=r({},An.actions,{changeSpace:kn}),Wn=An.reducer,Dn=qe({name:"income",initialState:{},reducers:r({},Ct)}),Mn=Dn.actions,Rn=Dn.reducer;function Cn(){return Object.keys(y).reduce((function(e,t){return e[t]=!1,e}),{})}var jn=Xe("character/perks/add",function(){var e=n(h.mark((function e(t,n){return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,n.dispatch)(En.notify({message:{text:y[t].notify}})),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),Pn=qe({name:"perks",initialState:Cn(),reducers:{},extraReducers:function(e){e.addCase(jn.fulfilled,(function(e,t){e[t.payload]=!0}))}}),Tn=r({},Pn.actions,{addPerk:jn}),Nn=Pn.reducer,In=qe({name:"statistics",initialState:{punches:0,starved:0,dehydrated:0,cityCleared:!1},reducers:r({},Ct)}),Fn=r({},In.actions),Gn=Oe({perks:Nn,statistics:In.reducer}),Vn={perks:Tn,statistics:Fn},Un=qe({name:"events",initialState:{eventStack:[],activeScene:"",delay:{},loot:{},enemys:[],won:!1,fightEvents:[]},reducers:r({},Ct,{end:function(e,t){e.eventStack.shift(),e.activeScene="",e.enemys=[],e.won=!1,e.fightEvents=[]},cleanEnemys:function(e){e.enemys=[],e.won=!1,e.fightEvents=[]},logFight:function(e,t){e.fightEvents||(e.fightEvents=[]),e.fightEvents.push(r({},t.payload,{id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}))},push:function(e,t){e.eventStack.unshift(t.payload)},setSceneEnemy:function(e,t){var n=t.payload;e.enemys=[{chara:n.chara,health:n.health,maxHealth:n.health,stunned:0}],e.fightEvents=[],e.won=!1},winFight:function(e){e.won=!0}})}),Bn=r({},Un.actions),Hn=Un.reducer,zn=qe({name:"previous",initialState:{stores:[],score:0},reducers:r({},Ct)}),$n=r({},zn.actions),qn=zn.reducer,Yn=qe({name:"room",initialState:{changed:!0,crafts:{},buys:{}},reducers:{setChanged:function(e,t){e.changed=t.payload},addCraft:function(e,t){e.crafts[t.payload.name]=!0},addBuy:function(e,t){e.buys[t.payload.name]=!0}}}),Kn=Yn.actions,Jn=Yn.reducer,Zn=qe({name:"outfit",initialState:{},reducers:r({},Ct,{empty:function(){return{}}})}),Qn=Zn.actions,Xn=Oe({outfit:Zn.reducer}),er={outfit:Qn},tr=qe({name:"delay",initialState:{},reducers:r({},Ct)}),nr=r({},tr.actions),rr=tr.reducer,ar=Xe("operation/record",function(){var e=n(h.mark((function e(t,n){var r,a,o;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.extra,a=Date.now(),o=t.cooldown?t.cooldown(r.engine,t):0,e.abrupt("return",{lastExecTime:a,id:t.id,cooldown:o,cooldownAt:a+1e3*o});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),or=qe({name:"operation",initialState:{},reducers:{clearCooldown:function(e,t){var n=t.payload;e[n]&&(e[n].cooldownAt=0)}},extraReducers:function(e){e.addCase(ar.fulfilled,(function(e,t){var n=t.payload;e[n.id]=n}))}}),ir=r({},or.actions,{record:ar}),cr=Oe({room:Jn,marketing:bt,config:St,features:Ot,stores:Nt,game:xn,engine:Wn,income:Rn,character:Gn,events:Hn,notifications:On,previous:qn,path:Xn,delay:rr,operation:or.reducer}),sr={config:wt,stores:Tt,game:wn,engine:Ln,income:Mn,character:Vn,marketing:yt,events:Bn,notifications:En,previous:$n,features:kt,room:Kn,path:er,delay:nr,operation:ir};!function(e){e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")}(c((function(e,t){!function(e){function t(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function n(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function r(e,t,n){r.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}function a(e,t){a.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function o(e,t){o.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function c(e,t,n){c.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:n,enumerable:!0})}function s(e,t,n){var r=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,r),e}function u(e){var t=void 0===e?"undefined":_(e);return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"function"==typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function l(e,t,n,i,f,h,d){d=d||[];var p=(f=f||[]).slice(0);if(void 0!==h){if(i){if("function"==typeof i&&i(p,h))return;if("object"===(void 0===i?"undefined":_(i))){if(i.prefilter&&i.prefilter(p,h))return;if(i.normalize){var m=i.normalize(p,h,e,t);m&&(e=m[0],t=m[1])}}}p.push(h)}"regexp"===u(e)&&"regexp"===u(t)&&(e=e.toString(),t=t.toString());var g=void 0===e?"undefined":_(e),v=void 0===t?"undefined":_(t),y="undefined"!==g||d&&d[d.length-1].lhs&&d[d.length-1].lhs.hasOwnProperty(h),b="undefined"!==v||d&&d[d.length-1].rhs&&d[d.length-1].rhs.hasOwnProperty(h);if(!y&&b)n(new a(p,t));else if(!b&&y)n(new o(p,e));else if(u(e)!==u(t))n(new r(p,e,t));else if("date"===u(e)&&e-t!=0)n(new r(p,e,t));else if("object"===g&&null!==e&&null!==t)if(d.filter((function(t){return t.lhs===e})).length)e!==t&&n(new r(p,e,t));else{if(d.push({lhs:e,rhs:t}),Array.isArray(e)){var x;for(x=0;x<e.length;x++)x>=t.length?n(new c(p,x,new o(void 0,e[x]))):l(e[x],t[x],n,i,p,x,d);for(;x<t.length;)n(new c(p,x,new a(void 0,t[x++])))}else{var w=Object.keys(e),S=Object.keys(t);w.forEach((function(r,a){var o=S.indexOf(r);o>=0?(l(e[r],t[r],n,i,p,r,d),S=s(S,o)):l(e[r],void 0,n,i,p,r,d)})),S.forEach((function(e){l(void 0,t[e],n,i,p,e,d)}))}d.length=d.length-1}else e!==t&&("number"===g&&isNaN(e)&&isNaN(t)||n(new r(p,e,t)))}function f(e,t,n,r){return r=r||[],l(e,t,(function(e){e&&r.push(e)}),n),r.length?r:void 0}function h(e,t,n){if(e&&t&&n&&n.kind){for(var r=e,a=-1,o=n.path?n.path.length-1:0;++a<o;)void 0===r[n.path[a]]&&(r[n.path[a]]="number"==typeof n.path[a]?[]:{}),r=r[n.path[a]];switch(n.kind){case"A":!function e(t,n,r){if(r.path&&r.path.length){var a,o=t[n],i=r.path.length-1;for(a=0;a<i;a++)o=o[r.path[a]];switch(r.kind){case"A":e(o[r.path[a]],r.index,r.item);break;case"D":delete o[r.path[a]];break;case"E":case"N":o[r.path[a]]=r.rhs}}else switch(r.kind){case"A":e(t[n],r.index,r.item);break;case"D":t=s(t,n);break;case"E":case"N":t[n]=r.rhs}return t}(n.path?r[n.path[a]]:r,n.index,n.item);break;case"D":delete r[n.path[a]];break;case"E":case"N":r[n.path[a]]=n.rhs}}}function d(e){return"color: "+k[e].color+"; font-weight: bold"}function p(e,t,n,r){var a=f(e,t);try{r?n.groupCollapsed("diff"):n.group("diff")}catch(e){n.log("diff")}a?a.forEach((function(e){var t=e.kind,r=function(e){var t=e.path,n=e.lhs,r=e.rhs,a=e.index,o=e.item;switch(e.kind){case"E":return[t.join("."),n,"→",r];case"N":return[t.join("."),r];case"D":return[t.join(".")];case"A":return[t.join(".")+"["+a+"]",o];default:return[]}}(e);n.log.apply(n,["%c "+k[t].text,d(t)].concat(E(r)))})):n.log("—— no diff ——");try{n.groupEnd()}catch(e){n.log("—— diff end —— ")}}function m(e,t,n,r){switch(void 0===e?"undefined":_(e)){case"object":return"function"==typeof e[r]?e[r].apply(e,E(n)):e[r];case"function":return e(t);default:return e}}function g(e,t){var n=t.logger,r=t.actionTransformer,a=t.titleFormatter,o=void 0===a?function(e){var t=e.timestamp,n=e.duration;return function(e,r,a){var o=["action"];return o.push("%c"+String(e.type)),t&&o.push("%c@ "+r),n&&o.push("%c(in "+a.toFixed(2)+" ms)"),o.join(" ")}}(t):a,i=t.collapsed,c=t.colors,s=t.level,u=t.diff,l=void 0===t.titleFormatter;e.forEach((function(a,f){var h=a.startedTime,d=a.action,g=a.prevState,v=a.error,y=a.took,b=a.nextState,x=e[f+1];x&&(b=x.prevState,y=x.started-a.started);var S=r(d),_="function"==typeof i?i((function(){return b}),d,a):i,E=w(h),O=c.title?"color: "+c.title(S)+";":"",k=["color: gray; font-weight: lighter;"];k.push(O),t.timestamp&&k.push("color: gray; font-weight: lighter;"),t.duration&&k.push("color: gray; font-weight: lighter;");var A=o(S,E,y);try{_?c.title&&l?n.groupCollapsed.apply(n,["%c "+A].concat(k)):n.groupCollapsed(A):c.title&&l?n.group.apply(n,["%c "+A].concat(k)):n.group(A)}catch(e){n.log(A)}var L=m(s,S,[g],"prevState"),W=m(s,S,[S],"action"),D=m(s,S,[v,g],"error"),M=m(s,S,[b],"nextState");if(L)if(c.prevState){var R="color: "+c.prevState(g)+"; font-weight: bold";n[L]("%c prev state",R,g)}else n[L]("prev state",g);if(W)if(c.action){var C="color: "+c.action(S)+"; font-weight: bold";n[W]("%c action    ",C,S)}else n[W]("action    ",S);if(v&&D)if(c.error){var j="color: "+c.error(v,g)+"; font-weight: bold;";n[D]("%c error     ",j,v)}else n[D]("error     ",v);if(M)if(c.nextState){var P="color: "+c.nextState(b)+"; font-weight: bold";n[M]("%c next state",P,b)}else n[M]("next state",b);u&&p(g,b,n,_);try{n.groupEnd()}catch(e){n.log("—— log end ——")}}))}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},A,e),n=t.logger,r=t.stateTransformer,a=t.errorTransformer,o=t.predicate,i=t.logErrors,c=t.diffPredicate;if(void 0===n)return function(){return function(e){return function(t){return e(t)}}};if(e.getState&&e.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\nconst logger = createLogger({\n  // ...options\n});\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(e){return function(t){return e(t)}}};var s=[];return function(e){var n=e.getState;return function(e){return function(u){if("function"==typeof o&&!o(n,u))return e(u);var l={};s.push(l),l.started=S.now(),l.startedTime=new Date,l.prevState=r(n()),l.action=u;var f=void 0;if(i)try{f=e(u)}catch(e){l.error=a(e)}else f=e(u);l.took=S.now()-l.started,l.nextState=r(n());var h=t.diff&&"function"==typeof c?c(n,u):t.diff;if(g(s,Object.assign({},t,{diff:h})),s.length=0,l.error)throw l.error;return f}}}}var y,b,x=function(e,t){return function(e,t){return new Array(t+1).join("0")}(0,t-e.toString().length)+e},w=function(e){return x(e.getHours(),2)+":"+x(e.getMinutes(),2)+":"+x(e.getSeconds(),2)+"."+x(e.getMilliseconds(),3)},S="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},O=[];y="object"===(void 0===i?"undefined":_(i))&&i?i:"undefined"!=typeof window?window:{},(b=y.DeepDiff)&&O.push((function(){void 0!==b&&y.DeepDiff===f&&(y.DeepDiff=b,b=void 0)})),t(r,n),t(a,n),t(o,n),t(c,n),Object.defineProperties(f,{diff:{value:f,enumerable:!0},observableDiff:{value:l,enumerable:!0},applyDiff:{value:function(e,t,n){e&&t&&l(e,t,(function(r){n&&!n(e,t,r)||h(e,t,r)}))},enumerable:!0},applyChange:{value:h,enumerable:!0},revertChange:{value:function(e,t,n){if(e&&t&&n&&n.kind){var r,a,o=e;for(a=n.path.length-1,r=0;r<a;r++)void 0===o[n.path[r]]&&(o[n.path[r]]={}),o=o[n.path[r]];switch(n.kind){case"A":!function e(t,n,r){if(r.path&&r.path.length){var a,o=t[n],i=r.path.length-1;for(a=0;a<i;a++)o=o[r.path[a]];switch(r.kind){case"A":e(o[r.path[a]],r.index,r.item);break;case"D":case"E":o[r.path[a]]=r.lhs;break;case"N":delete o[r.path[a]]}}else switch(r.kind){case"A":e(t[n],r.index,r.item);break;case"D":case"E":t[n]=r.lhs;break;case"N":t=s(t,n)}return t}(o[n.path[r]],n.index,n.item);break;case"D":case"E":o[n.path[r]]=n.lhs;break;case"N":delete o[n.path[r]]}}},enumerable:!0},isConflict:{value:function(){return void 0!==b},enumerable:!0},noConflict:{value:function(){return O&&(O.forEach((function(e){e()})),O=null),f},enumerable:!0}});var k={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},A={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dispatch,n=e.getState;return"function"==typeof t||"function"==typeof n?v()({dispatch:t,getState:n}):void console.error("\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from 'redux-logger'\n[redux-logger v3] to\n[redux-logger v3] import { createLogger } from 'redux-logger'\n")};e.defaults=A,e.createLogger=v,e.logger=L,e.default=L,Object.defineProperty(e,"__esModule",{value:!0})}(t)})));var ur=[],lr=!1;function fr(){var e;lr&&(e=console).log.apply(e,arguments)}var hr,dr,pr,mr,gr,vr,yr,br,xr,wr,Sr,_r,Er,Or,kr=[{title:d("The Thief"),isAvailable:function(t){return(t.engine.activeSpace===e.GameSpace.Room||t.engine.activeSpace===e.GameSpace.Outside)&&1===t.game.thieves},scenes:{start:{text:[d("the villagers haul a filthy man out of the store room."),d("say his folk have been skimming the supplies."),d("say he should be strung up as an example.")],notification:d("a thief is caught"),blink:!0,buttons:{kill:{text:d("hang him"),nextScene:{1:"hang"}},spare:{text:d("spare him"),nextScene:{1:"spare"}}}},hang:{text:[d("the villagers hang the thief high in front of the store room."),d("the point is made. in the next few days, the missing supplies are returned.")],onLoad:function(e){var t,n,r,a;null==(t=e.store)||t.dispatch(e.actions.game.thieves.set(2)),null==(n=e.store)||n.dispatch(e.actions.income.setM({thieves:0})),null==(r=e.store)||r.dispatch(e.actions.stores.addM(null==(a=e.store)?void 0:a.getState().game.stolen))},buttons:{leave:{text:d("leave"),nextScene:"end"}}},spare:{text:[d("the man says he's grateful. says he won't come around any more."),d("shares what he knows about sneaking before he goes.")],onLoad:function(t){var n,r,a;null==(n=t.store)||n.dispatch(t.actions.game.thieves.set(2)),null==(r=t.store)||r.dispatch(t.actions.income.setM({thieves:0})),null==(a=t.store)||a.dispatch(t.actions.character.perks.addPerk(e.PerkCategory.stealthy))},buttons:{leave:{text:d("leave"),nextScene:"end"}}}}}],Ar=[{title:d("The Nomad"),isAvailable:function(t){return t.engine.activeSpace===e.GameSpace.Room&&!!t.stores.fur},scenes:{start:{text:[d("a nomad shuffles into view, laden with makeshift bags bound with rough twine."),d("won't say from where he came, but it's clear that he's not staying.")],notification:d("a nomad arrives, looking to trade"),blink:!0,buttons:{buyScales:{text:d("buy scales"),cost:{fur:100},reward:{scales:1}},buyTeeth:{text:d("buy teeth"),cost:{fur:200},reward:{teeth:1}},buyBait:{text:d("buy bait"),cost:{fur:5},reward:{bait:1},notification:d("traps are more effective with bait.")},buyCompass:{available:function(e){return!!e.stores.compass},text:d("buy compass"),cost:{fur:300,scales:15,teeth:5},reward:{compass:1},notification:d("the old compass is dented and dusty, but it looks to work.")},goodbye:{text:d("say goodbye"),nextScene:"end"}}}}},{title:d("Noises"),isAvailable:function(t){return t.engine.activeSpace===e.GameSpace.Room&&!!t.stores.wood},scenes:{start:{text:[d("through the walls, shuffling noises can be heard."),d("can't tell what they're up to.")],notification:d("strange noises can be heard through the walls"),blink:!0,buttons:{investigate:{text:d("investigate"),nextScene:{.3:"stuff",1:"nothing"}},ignore:{text:d("ignore them"),nextScene:"end"}}},nothing:{text:[d("vague shapes move, just out of sight."),d("the sounds stop.")],buttons:{backinside:{text:d("go back inside"),nextScene:"end"}}},stuff:{reward:{wood:100,fur:10},text:[d("a bundle of sticks lies just beyond the threshold, wrapped in coarse furs."),d("the night is silent.")],buttons:{backinside:{text:d("go back inside"),nextScene:"end"}}}}},{title:d("Noises"),isAvailable:function(t){return t.engine.activeSpace===e.GameSpace.Room&&!!t.stores.wood},scenes:{start:{text:[d("scratching noises can be heard from the store room."),d("something's in there.")],notification:d("something's in the store room"),blink:!0,buttons:{investigate:{text:d("investigate"),nextScene:{.5:"scales",.8:"teeth",1:"cloth"}},ignore:{text:d("ignore them"),nextScene:"end"}}},scales:{text:[d("some wood is missing."),d("the ground is littered with small scales")],onLoad:function(e){var t,n,r=null==(t=e.store)?void 0:t.getState(),a=(null==r?void 0:r.stores.wood)||0;0===(a=Math.floor(.1*a))&&(a=1);var o=Math.floor(a/5);0===o&&(o=1),null==(n=e.store)||n.dispatch(e.actions.stores.addM({wood:-a,scales:o}))},buttons:{leave:{text:d("leave"),nextScene:"end"}}},teeth:{text:[d("some wood is missing."),d("the ground is littered with small teeth")],onLoad:function(e){var t,n,r=null==(t=e.store)?void 0:t.getState(),a=(null==r?void 0:r.stores.wood)||0;0===(a=Math.floor(.1*a))&&(a=1);var o=Math.floor(a/5);0===o&&(o=1),null==(n=e.store)||n.dispatch(e.actions.stores.addM({wood:-a,teeth:o}))},buttons:{leave:{text:d("leave"),nextScene:"end"}}},cloth:{text:[d("some wood is missing."),d("the ground is littered with scraps of cloth")],onLoad:function(e){var t,n,r=null==(t=e.store)?void 0:t.getState(),a=(null==r?void 0:r.stores.wood)||0;0===(a=Math.floor(.1*a))&&(a=1);var o=Math.floor(a/5);0===o&&(o=1),null==(n=e.store)||n.dispatch(e.actions.stores.addM({wood:-a,cloth:o}))},buttons:{leave:{text:d("leave"),nextScene:"end"}}}}},{title:d("The Beggar"),isAvailable:function(t){return t.engine.activeSpace===e.GameSpace.Room&&!!t.stores.fur},scenes:{start:{text:[d("a beggar arrives."),d("asks for any spare furs to keep him warm at night.")],notification:d("a beggar arrives"),blink:!0,buttons:{"50furs":{text:d("give 50"),cost:{fur:50},nextScene:{.5:"scales",.8:"teeth",1:"cloth"}},"100furs":{text:d("give 100"),cost:{fur:100},nextScene:{.5:"teeth",.8:"scales",1:"cloth"}},deny:{text:d("turn him away"),nextScene:"end"}}},scales:{reward:{scales:20},text:[d("the beggar expresses his thanks."),d("leaves a pile of small scales behind.")],buttons:{leave:{text:d("say goodbye"),nextScene:"end"}}},teeth:{reward:{teeth:20},text:[d("the beggar expresses his thanks."),d("leaves a pile of small teeth behind.")],buttons:{leave:{text:d("say goodbye"),nextScene:"end"}}},cloth:{reward:{cloth:20},text:[d("the beggar expresses his thanks."),d("leaves some scraps of cloth behind.")],buttons:{leave:{text:d("say goodbye"),nextScene:"end"}}}}},{title:d("The Shady Builder"),isAvailable:function(t){return t.engine.activeSpace===e.GameSpace.Room&&t.game.buildings.hut>=5&&t.game.buildings.hut<20},scenes:{start:{text:[d("a shady builder passes through"),d("says he can build you a hut for less wood")],notification:d("a shady builder passes through"),buttons:{build:{text:d("300 wood"),cost:{wood:300},nextScene:{.6:"steal",1:"build"}},deny:{text:d("say goodbye"),nextScene:"end"}}},steal:{text:[d("the shady builder has made off with your wood")],notification:d("the shady builder has made off with your wood"),buttons:{end:{text:d("go home"),nextScene:"end"}}},build:{text:[d("the shady builder builds a hut")],notification:d("the shady builder builds a hut"),onLoad:function(e){var t,n,r=(null==(t=e.store)?void 0:t.getState()).game.buildings.hut;r<20&&(null==(n=e.store)||n.dispatch(e.actions.game.buildings.setM({hut:r+1})))},buttons:{end:{text:d("go home"),nextScene:"end"}}}}},{title:d("The Mysterious Wanderer"),isAvailable:function(t){return t.engine.activeSpace===e.GameSpace.Room&&!!t.stores.wood},scenes:{start:{text:[d("a wanderer arrives with an empty cart. says if he leaves with wood, he'll be back with more."),d("builder's not sure he's to be trusted.")],notification:d("a mysterious wanderer arrives"),blink:!0,buttons:{wood100:{text:d("give 100"),cost:{wood:100},nextScene:{1:"wood100"}},wood500:{text:d("give 500"),cost:{wood:500},nextScene:{1:"wood500"}},deny:{text:d("turn him away"),nextScene:"end"}}},wood100:{text:[d("the wanderer leaves, cart loaded with wood")],action:function(t,n){n.events.saveDelay((function(t){var n;null==(n=t.store)||n.dispatch(t.actions.stores.addM({wood:300})),t.notify("the mysterious wanderer returns, cart piled high with wood.",e.GameSpace.Room)}),e.GameSpace.Room+"[4].scenes.wood100.action",t)},onLoad:function(e){Math.random()<.5&&this.action(60,e)},buttons:{leave:{text:d("say goodbye"),nextScene:"end"}}},wood500:{text:[d("the wanderer leaves, cart loaded with wood")],action:function(t,n){n.events.saveDelay((function(t){var n;null==(n=t.store)||n.dispatch(t.actions.stores.addM({wood:1500})),t.notify("the mysterious wanderer returns, cart piled high with wood.",e.GameSpace.Room)}),e.GameSpace.Room+"[4].scenes.wood500.action",t)},onLoad:function(e){Math.random()<.3&&this.action(60,e)},buttons:{leave:{text:d("say goodbye"),nextScene:"end"}}}}},{title:d("The Mysterious Wanderer"),isAvailable:function(t){return t.engine.activeSpace===e.GameSpace.Room&&!!t.stores.fur},scenes:{start:{text:[d("a wanderer arrives with an empty cart. says if she leaves with furs, she'll be back with more."),d("builder's not sure she's to be trusted.")],notification:d("a mysterious wanderer arrives"),blink:!0,buttons:{fur100:{text:d("give 100"),cost:{fur:100},nextScene:{1:"fur100"}},fur500:{text:d("give 500"),cost:{fur:500},nextScene:{1:"fur500"}},deny:{text:d("turn her away"),nextScene:"end"}}},fur100:{text:[d("the wanderer leaves, cart loaded with furs")],action:function(t,n){n.events.saveDelay((function(t){var n;null==(n=t.store)||n.dispatch(t.actions.stores.addM({fur:300})),t.notify("the mysterious wanderer returns, cart piled high with furs.",e.GameSpace.Room)}),e.GameSpace.Room+"[5].scenes.fur100.action",t)},onLoad:function(e){Math.random()<.5&&this.action(60,e)},buttons:{leave:{text:d("say goodbye"),nextScene:"end"}}},fur500:{text:[d("the wanderer leaves, cart loaded with furs")],action:function(t,n){n.events.saveDelay((function(t){var n;null==(n=t.store)||n.dispatch(t.actions.stores.addM({fur:1500})),t.notify("the mysterious wanderer returns, cart piled high with furs.",e.GameSpace.Room)}),e.GameSpace.Room+"[5].scenes.fur500.action",t)},onLoad:function(e){Math.random()<.3&&this.action(60,e)},buttons:{leave:{text:d("say goodbye"),nextScene:"end"}}}}},{title:d("The Scout"),isAvailable:function(t){return t.engine.activeSpace===e.GameSpace.Room&&t.features.location.World},scenes:{start:{text:[d("the scout says she's been all over."),d("willing to talk about it, for a price.")],notification:d("a scout stops for the night"),blink:!0,buttons:{buyMap:{text:d("buy map"),cost:{fur:200,scales:10},available:function(e){return!e.game.world.seenAll},notification:d("the map uncovers a bit of the world"),onChoose:function(t){t.spaces[e.GameSpace.World].applyMap()}},learn:{text:d("learn scouting"),cost:{fur:1e3,scales:50,teeth:20},available:function(e){return!e.character.perks.scout},onChoose:function(t){var n;null==(n=t.store)||n.dispatch(t.actions.character.perks.addPerk(e.PerkCategory.scout))}},leave:{text:d("say goodbye"),nextScene:"end"}}}}},{title:d("The Master"),isAvailable:function(t){return t.engine.activeSpace===e.GameSpace.Room&&t.features.location.World},scenes:{start:{text:[d("an old wanderer arrives."),d("he smiles warmly and asks for lodgings for the night.")],notification:d("an old wanderer arrives"),blink:!0,buttons:{agree:{text:d("agree"),cost:{cured_meat:100,fur:100,torch:1},nextScene:{1:"agree"}},deny:{text:d("turn him away"),nextScene:"end"}}},agree:{text:[d("in exchange, the wanderer offers his wisdom.")],buttons:{evasion:{text:d("evasion"),available:function(e){return!e.character.perks.evasive},onChoose:function(t){var n;null==(n=t.store)||n.dispatch(t.actions.character.perks.addPerk(e.PerkCategory.evasive))},nextScene:"end"},precision:{text:d("precision"),available:function(e){return!e.character.perks.precise},onChoose:function(t){var n;null==(n=t.store)||n.dispatch(t.actions.character.perks.addPerk(e.PerkCategory.precise))},nextScene:"end"},force:{text:d("force"),available:function(e){return!e.character.perks.barbarian},onChoose:function(t){var n;null==(n=t.store)||n.dispatch(t.actions.character.perks.addPerk(e.PerkCategory.barbarian))},nextScene:"end"},nothing:{text:d("nothing"),nextScene:"end"}}}}},{title:d("The Sick Man"),isAvailable:function(t){return t.engine.activeSpace===e.GameSpace.Room&&!!t.stores.medicine},scenes:{start:{text:[d("a man hobbles up, coughing."),d("he begs for medicine.")],notification:d("a sick man hobbles up"),blink:!0,buttons:{help:{text:d("give 1 medicine"),cost:{medicine:1},notification:d("the man swallows the medicine eagerly"),nextScene:{.1:"alloy",.3:"cells",.5:"scales",1:"nothing"}},ignore:{text:d("tell him to leave"),nextScene:"end"}}},alloy:{text:[d("the man is thankful."),d("he leaves a reward."),d("some weird metal he picked up on his travels.")],onLoad:function(t){var n,r;null==(n=t.store)||n.dispatch(t.actions.stores.addM(((r={})[e.StoreCategory.alien_alloy]=1,r)))},buttons:{bye:{text:d("say goodbye"),nextScene:"end"}}},cells:{text:[d("the man is thankful."),d("he leaves a reward."),d("some weird glowing boxes he picked up on his travels.")],onLoad:function(t){var n,r;null==(n=t.store)||n.dispatch(t.actions.stores.addM(((r={})[e.StoreCategory.energy_cell]=3,r)))},buttons:{bye:{text:d("say goodbye"),nextScene:"end"}}},scales:{text:[d("the man is thankful."),d("he leaves a reward."),d("all he has are some scales.")],onLoad:function(t){var n,r;null==(n=t.store)||n.dispatch(t.actions.stores.addM(((r={})[e.StoreCategory.scales]=5,r)))},buttons:{bye:{text:d("say goodbye"),nextScene:"end"}}},nothing:{text:[d("the man expresses his thanks and hobbles off.")],buttons:{bye:{text:d("say goodbye"),nextScene:"end"}}}}}],Lr=[{title:d("A Ruined Trap"),isAvailable:function(t){return t.engine.activeSpace===e.GameSpace.Outside&&t.game.buildings.trap>0},scenes:{start:{text:[d("some of the traps have been torn apart."),d("large prints lead away, into the forest.")],onLoad:function(e){var t,n,r=null==(t=e.store)?void 0:t.getState(),a=Math.floor(Math.random()*r.game.buildings.trap)+1;null==(n=e.store)||n.dispatch(e.actions.game.buildings.addM({trap:-a}))},notification:d("some traps have been destroyed"),blink:!0,buttons:{track:{text:d("track them"),nextScene:{.5:"nothing",1:"catch"}},ignore:{text:d("ignore them"),nextScene:"end"}}},nothing:{text:[d("the tracks disappear after just a few minutes."),d("the forest is silent.")],notification:d("nothing was found"),buttons:{end:{text:d("go home"),nextScene:"end"}}},catch:{text:[d("not far from the village lies a large beast, its fur matted with blood."),d("it puts up little resistance before the knife.")],notification:d("there was a beast. it's dead now"),reward:{fur:100,meat:100,teeth:10},buttons:{end:{text:d("go home"),nextScene:"end"}}}}},{title:d("Fire"),isAvailable:function(t){return t.engine.activeSpace==e.GameSpace.Outside&&t.game.buildings.hut>0&&t.game.population.value>50},scenes:{start:{text:[d("a fire rampages through one of the huts, destroying it."),d("all residents in the hut perished in the fire.")],notification:d("a fire has started"),blink:!0,onLoad:function(e){e.spaces.Outside.destroyHuts(1)},buttons:{mourn:{text:d("mourn"),notification:d("some villagers have died"),nextScene:"end"}}}}},{title:d("Sickness"),isAvailable:function(t){return t.engine.activeSpace==e.GameSpace.Outside&&t.game.population.value>10&&t.game.population.value<50&&!!t.stores.medicine},scenes:{start:{text:[d("a sickness is spreading through the village."),d("medicine is needed immediately.")],notification:d("some villagers are ill"),blink:!0,buttons:{heal:{text:d("1 medicine"),cost:{medicine:1},nextScene:{1:"healed"}},ignore:{text:d("ignore it"),nextScene:{1:"death"}}}},healed:{text:[d("the sickness is cured in time.")],notification:d("sufferers are healed"),buttons:{end:{text:d("go home"),nextScene:"end"}}},death:{text:[d("the sickness spreads through the village."),d("the days are spent with burials."),d("the nights are rent with screams.")],notification:d("sufferers are left to die"),onLoad:function(e){var t,n=null==(t=e.store)?void 0:t.getState(),r=Math.floor(Math.random()*Math.floor(n.game.population.value/2))+1;e.spaces.Outside.killVillagers(r)},buttons:{end:{text:d("go home"),nextScene:"end"}}}}},{title:d("Plague"),isAvailable:function(t){return t.engine.activeSpace==e.GameSpace.Outside&&t.game.population.value>50&&!!t.stores.medicine},scenes:{start:{text:[d("a terrible plague is fast spreading through the village."),d("medicine is needed immediately.")],notification:d("a plague afflicts the village"),blink:!0,buttons:{buyMedicine:{text:d("buy medicine"),cost:{scales:70,teeth:50},reward:{medicine:1}},heal:{text:d("5 medicine"),cost:{medicine:5},nextScene:{1:"healed"}},ignore:{text:d("do nothing"),nextScene:{1:"death"}}}},healed:{text:[d("the plague is kept from spreading."),d("only a few die."),d("the rest bury them.")],notification:d("epidemic is eradicated eventually"),onLoad:function(e){var t=Math.floor(5*Math.random())+2;e.spaces.Outside.killVillagers(t)},buttons:{end:{text:d("go home"),nextScene:"end"}}},death:{text:[d("the plague rips through the village."),d("the nights are rent with screams."),d("the only hope is a quick death.")],notification:d("population is almost exterminated"),onLoad:function(e){var t=Math.floor(80*Math.random())+10;e.spaces.Outside.killVillagers(t)},buttons:{end:{text:d("go home"),nextScene:"end"}}}}},{title:d("A Beast Attack"),isAvailable:function(t){return t.engine.activeSpace==e.GameSpace.Outside&&t.game.population.value>0},scenes:{start:{text:[d("a pack of snarling beasts pours out of the trees."),d("the fight is short and bloody, but the beasts are repelled."),d("the villagers retreat to mourn the dead.")],notification:d("wild beasts attack the villagers"),onLoad:function(e){var t=Math.floor(10*Math.random())+1;e.spaces.Outside.killVillagers(t)},reward:{fur:100,meat:100,teeth:10},blink:!0,buttons:{end:{text:d("go home"),notification:d("predators become prey. price is unfair"),nextScene:"end"}}}}},{title:d("A Military Raid"),isAvailable:function(t){return t.engine.activeSpace==e.GameSpace.Outside&&t.game.population.value>0&&t.game.city.cleared},scenes:{start:{text:[d("a gunshot rings through the trees."),d("well armed men charge out of the forest, firing into the crowd."),d("after a skirmish they are driven away, but not without losses.")],notification:d("troops storm the village"),onLoad:function(e){var t=Math.floor(40*Math.random())+1;e.spaces.Outside.killVillagers(t)},reward:(hr={},hr[e.StoreCategory.bullets]=10,hr[e.StoreCategory.cured_meat]=50,hr),blink:!0,buttons:{end:{text:d("go home"),notification:d("warfare is bloodthirsty"),nextScene:"end"}}}}}],Wr=[],Dr={outpost:{title:d("An Outpost"),id:"outpost",scenes:{start:{text:[d("a safe place in the wilds.")],notification:d("a safe place in the wilds."),loot:{cured_meat:{min:5,max:10,chance:1}},onLoad:function(e){e.spaces.World.useOutpost()},buttons:{leave:{text:d("leave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}}}},swamp:{title:d("A Murky Swamp"),id:"swamp",scenes:{start:{text:[d("rotting reeds rise out of the swampy earth."),d("a lone frog sits in the muck, silently.")],notification:d("a swamp festers in the stagnant air."),buttons:{enter:{text:d("enter"),nextScene:{1:"cabin"}},leave:{text:d("leave"),nextScene:"end"}}},cabin:{text:[d("deep in the swamp is a moss-covered cabin."),d("an old wanderer sits inside, in a seeming trance.")],buttons:{talk:{cost:{charm:1},text:d("talk"),nextScene:{1:"talk"}},leave:{text:d("leave"),nextScene:"end"}}},talk:{text:[d("the wanderer takes the charm and nods slowly."),d("he speaks of once leading the great fleets to fresh worlds."),d("unfathomable destruction to fuel wanderer hungers."),d("his time here, now, is his penance.")],onLoad:function(t){var n=t.store.getState();t.dispatch(t.actions.character.perks.addPerk(e.PerkCategory.gastronome)),t.spaces.World.markVisited(null==n?void 0:n.game.world.curPos[0],null==n?void 0:n.game.world.curPos[1])},buttons:{leave:{text:d("leave"),nextScene:"end"}}}}},cave:{title:d("A Damp Cave"),id:"cave",scenes:{start:{text:[d("the mouth of the cave is wide and dark."),d("can't see what's inside.")],notification:d("the earth here is split, as if bearing an ancient wound"),buttons:{enter:{text:d("go inside"),cost:{torch:1},nextScene:{.3:"a1",.6:"a2",1:"a3"}},leave:{text:d("leave"),nextScene:"end"}}},a1:{combat:!0,enemy:"beast",chara:"R",damage:1,hit:.8,attackDelay:1,health:5,notification:d("a startled beast defends its home"),loot:{fur:{min:1,max:10,chance:1},teeth:{min:1,max:5,chance:.8}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"b1",1:"b2"}},leave:{text:d("leave cave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},a2:{text:[d("the cave narrows a few feet in."),d("the walls are moist and moss-covered")],buttons:{continue:{text:d("squeeze"),nextScene:{.5:"b2",1:"b3"}},leave:{text:d("leave cave"),nextScene:"end"}}},a3:{text:[d("the remains of an old camp sits just inside the cave."),d("bedrolls, torn and blackened, lay beneath a thin layer of dust.")],loot:{cured_meat:{min:1,max:5,chance:1},torch:{min:1,max:5,chance:.5},leather:{min:1,max:5,chance:.3}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"b3",1:"b4"}},leave:{text:d("leave cave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},b1:{text:[d("the body of a wanderer lies in a small cavern."),d("rot's been to work on it, and some of the pieces are missing."),d("can't tell what left it here.")],loot:{iron_sword:{min:1,max:1,chance:1},cured_meat:{min:1,max:5,chance:.8},torch:{min:1,max:3,chance:.5},medicine:{min:1,max:2,chance:.1}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"c1"}},leave:{text:d("leave cave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},b2:{text:[d("the torch sputters and dies in the damp air"),d("the darkness is absolute")],notification:d("the torch goes out"),buttons:{continue:{text:d("continue"),cost:{torch:1},nextScene:{1:"c1"}},leave:{text:d("leave cave"),nextScene:"end"}}},b3:{combat:!0,enemy:"beast",chara:"R",damage:1,hit:.8,attackDelay:1,health:5,notification:d("a startled beast defends its home"),loot:{fur:{min:1,max:3,chance:1},teeth:{min:1,max:2,chance:.8}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"c2"}},leave:{text:d("leave cave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},b4:{combat:!0,enemy:"cave lizard",chara:"R",damage:3,hit:.8,attackDelay:2,health:6,notification:d("a cave lizard attacks"),loot:{scales:{min:1,max:3,chance:1},teeth:{min:1,max:2,chance:.8}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"c2"}},leave:{text:d("leave cave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},c1:{combat:!0,enemy:"beast",chara:"R",damage:3,hit:.8,attackDelay:2,health:10,notification:d("a large beast charges out of the dark"),loot:{fur:{min:1,max:3,chance:1},teeth:{min:1,max:3,chance:1}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"end1",1:"end2"}},leave:{text:d("leave cave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},c2:{combat:!0,enemy:"lizard",chara:"T",damage:4,hit:.8,attackDelay:2,health:10,notification:d("a giant lizard shambles forward"),loot:{scales:{min:1,max:3,chance:1},teeth:{min:1,max:3,chance:1}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.7:"end2",1:"end3"}},leave:{text:d("leave cave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end1:{text:[d("the nest of a large animal lies at the back of the cave.")],onLoad:function(e){e.spaces.World.clearDungeon()},loot:{meat:{min:5,max:10,chance:1},fur:{min:5,max:10,chance:1},scales:{min:5,max:10,chance:1},teeth:{min:5,max:10,chance:1},cloth:{min:5,max:10,chance:.5}},buttons:{leave:{text:d("leave cave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end2:{text:[d("a small supply cache is hidden at the back of the cave.")],loot:{cloth:{min:5,max:10,chance:1},leather:{min:5,max:10,chance:1},iron:{min:5,max:10,chance:1},cured_meat:{min:5,max:10,chance:1},steel:{min:5,max:10,chance:.5},bolas:{min:1,max:3,chance:.3},medicine:{min:1,max:4,chance:.15}},onLoad:function(e){e.spaces.World.clearDungeon()},buttons:{leave:{text:d("leave cave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end3:{text:[d("an old case is wedged behind a rock, covered in a thick layer of dust.")],loot:{steel_sword:{min:1,max:1,chance:1},bolas:{min:1,max:3,chance:.5},medicine:{min:1,max:3,chance:.3}},onLoad:function(e){e.spaces.World.clearDungeon()},buttons:{leave:{text:d("leave cave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}}}},town:{title:d("A Deserted Town"),id:"town",scenes:{start:{text:[d("a small suburb lays ahead, empty houses scorched and peeling."),d("broken streetlights stand, rusting. light hasn't graced this place in a long time.")],notification:d("the town lies abandoned, its citizens long dead"),buttons:{enter:{text:d("explore"),nextScene:{.3:"a1",.7:"a3",1:"a2"}},leave:{text:d("leave"),nextScene:"end"}}},a1:{text:[d("where the windows of the schoolhouse aren't shattered, they're blackened with soot."),d("the double doors creak endlessly in the wind.")],buttons:{enter:{text:d("enter"),nextScene:{.5:"b1",1:"b2"},cost:{torch:1}},leave:{text:d("leave town"),nextScene:"end"}}},a2:{combat:!0,enemy:"thug",chara:"E",damage:4,hit:.8,attackDelay:2,health:30,loot:{cloth:{min:5,max:10,chance:.8},leather:{min:5,max:10,chance:.8},cured_meat:{min:1,max:5,chance:.5}},notification:d("ambushed on the street."),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"b3",1:"b4"}},leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},a3:{text:[d("a squat building up ahead."),d("a green cross barely visible behind grimy windows.")],buttons:{enter:{text:d("enter"),nextScene:{.5:"b5",1:"end5"},cost:{torch:1}},leave:{text:d("leave town"),nextScene:"end"}}},b1:{text:[d("a small cache of supplies is tucked inside a rusting locker.")],loot:{cured_meat:{min:1,max:5,chance:1},torch:{min:1,max:3,chance:.8},bullets:{min:1,max:5,chance:.3},medicine:{min:1,max:3,chance:.05}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"c1",1:"c2"}},leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},b2:{combat:!0,enemy:"scavenger",chara:"E",damage:4,hit:.8,attackDelay:2,health:30,loot:{cloth:{min:5,max:10,chance:.8},leather:{min:5,max:10,chance:.8},cured_meat:{min:1,max:5,chance:.5}},notification:d("a scavenger waits just inside the door."),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"c2",1:"c3"}},leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},b3:{combat:!0,enemy:"beast",chara:"R",damage:3,hit:.8,attackDelay:1,health:25,loot:{teeth:{min:1,max:5,chance:1},fur:{min:5,max:10,chance:1}},notification:d("a beast stands alone in an overgrown park."),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"c4",1:"c5"}},leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},b4:{text:[d("an overturned caravan is spread across the pockmarked street."),d("it's been picked over by scavengers, but there's still some things worth taking.")],loot:{cured_meat:{min:1,max:5,chance:.8},torch:{min:1,max:3,chance:.5},bullets:{min:1,max:5,chance:.3},medicine:{min:1,max:3,chance:.1}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"c5",1:"c6"}},leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},b5:{combat:!0,enemy:"madman",chara:"E",damage:6,hit:.3,attackDelay:1,health:10,loot:{cloth:{min:2,max:4,chance:.3},cured_meat:{min:1,max:5,chance:.9},medicine:{min:1,max:2,chance:.4}},notification:d("a madman attacks, screeching."),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.3:"end5",1:"end6"}},leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},c1:{combat:!0,enemy:"thug",chara:"E",damage:4,hit:.8,attackDelay:2,health:30,loot:{cloth:{min:5,max:10,chance:.8},leather:{min:5,max:10,chance:.8},cured_meat:{min:1,max:5,chance:.5}},notification:d("a thug moves out of the shadows."),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"d1"}},leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},c2:{combat:!0,enemy:"beast",chara:"R",damage:3,hit:.8,attackDelay:1,health:25,loot:{teeth:{min:1,max:5,chance:1},fur:{min:5,max:10,chance:1}},notification:d("a beast charges out of a ransacked classroom."),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"d1"}},leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},c3:{text:[d("through the large gymnasium doors, footsteps can be heard."),d("the torchlight casts a flickering glow down the hallway."),d("the footsteps stop.")],buttons:{continue:{text:d("enter"),nextScene:{1:"d1"}},leave:{text:d("leave town"),nextScene:"end"}}},c4:{combat:!0,enemy:"beast",chara:"R",damage:4,hit:.8,attackDelay:1,health:25,loot:{teeth:{min:1,max:5,chance:1},fur:{min:5,max:10,chance:1}},notification:d("another beast, draw by the noise, leaps out of a copse of trees."),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"d2"}},leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},c5:{text:[d("something's causing a commotion a ways down the road."),d("a fight, maybe.")],buttons:{continue:{text:d("continue"),nextScene:{1:"d2"}},leave:{text:d("leave town"),nextScene:"end"}}},c6:{text:[d("a small basket of food is hidden under a park bench, with a note attached."),d("can't read the words.")],loot:{cured_meat:{min:1,max:5,chance:1}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"d2"}},leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},d1:{combat:!0,enemy:"scavenger",chara:"E",damage:5,hit:.8,attackDelay:2,health:30,loot:{cured_meat:{min:1,max:5,chance:1},leather:{min:5,max:10,chance:.8},steel_sword:{min:1,max:1,chance:.5}},notification:d("a panicked scavenger bursts through the door, screaming."),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"end1",1:"end2"}},leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},d2:{combat:!0,enemy:"vigilante",chara:"D",damage:6,hit:.8,attackDelay:2,health:30,loot:{cured_meat:{min:1,max:5,chance:1},leather:{min:5,max:10,chance:.8},steel_sword:{min:1,max:1,chance:.5}},notification:d("a man stands over a dead wanderer. notices he's not alone."),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"end3",1:"end4"}},leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end1:{text:[d("scavenger had a small camp in the school."),d("collected scraps spread across the floor like they fell from heaven.")],onLoad:function(e){e.spaces.World.clearDungeon()},loot:{steel_sword:{min:1,max:1,chance:1},steel:{min:5,max:10,chance:1},cured_meat:{min:5,max:10,chance:1},bolas:{min:1,max:5,chance:.5},medicine:{min:1,max:2,chance:.3}},buttons:{leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end2:{text:[d("scavenger'd been looking for supplies in here, it seems."),d("a shame to let what he'd found go to waste.")],onLoad:function(e){e.spaces.World.clearDungeon()},loot:{coal:{min:5,max:10,chance:1},cured_meat:{min:5,max:10,chance:1},leather:{min:5,max:10,chance:1}},buttons:{leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end3:{text:[d("beneath the wanderer's rags, clutched in one of its many hands, a glint of steel."),d("worth killing for, it seems.")],onLoad:function(e){e.spaces.World.clearDungeon()},loot:{rifle:{min:1,max:1,chance:1},bullets:{min:1,max:5,chance:1}},buttons:{leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end4:{text:[d("eye for an eye seems fair."),d("always worked before, at least."),d("picking the bones finds some useful trinkets.")],onLoad:function(e){e.spaces.World.clearDungeon()},loot:{cured_meat:{min:5,max:10,chance:1},iron:{min:5,max:10,chance:1},torch:{min:1,max:5,chance:1},bolas:{min:1,max:5,chance:.5},medicine:{min:1,max:2,chance:.1}},buttons:{leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end5:{text:[d("some medicine abandoned in the drawers.")],onLoad:function(e){e.spaces.World.clearDungeon()},loot:{medicine:{min:2,max:5,chance:1}},buttons:{leave:{text:d("leave town"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end6:{text:[d("the clinic has been ransacked."),d("only dust and stains remain.")],onLoad:function(e){e.spaces.World.clearDungeon()},buttons:{leave:{text:d("leave town"),nextScene:"end"}}}}},city:{title:d("A Ruined City"),id:"city",scenes:{start:{text:[d("a battered highway sign stands guard at the entrance to this once-great city."),d("the towers that haven't crumbled jut from the landscape like the ribcage of some ancient beast."),d("might be things worth having still inside.")],notification:d("the towers of a decaying city dominate the skyline"),buttons:{enter:{text:d("explore"),nextScene:{.2:"a1",.5:"a2",.8:"a3",1:"a4"}},leave:{text:d("leave"),nextScene:"end"}}},a1:{text:[d("the streets are empty."),d("the air is filled with dust, driven relentlessly by the hard winds.")],buttons:{continue:{text:d("continue"),nextScene:{.5:"b1",1:"b2"}},leave:{text:d("leave city"),nextScene:"end"}}},a2:{text:[d("orange traffic cones are set across the street, faded and cracked."),d("lights flash through the alleys between buildings.")],buttons:{continue:{text:d("continue"),nextScene:{.5:"b3",1:"b4"}},leave:{text:d("leave city"),nextScene:"end"}}},a3:{text:[d("a large shanty town sprawls across the streets."),d("faces, darkened by soot and blood, stare out from crooked huts.")],buttons:{continue:{text:d("continue"),nextScene:{.5:"b5",1:"b6"}},leave:{text:d("leave city"),nextScene:"end"}}},a4:{text:[d("the shell of an abandoned hospital looms ahead.")],buttons:{enter:{text:d("enter"),cost:{torch:1},nextScene:{.5:"b7",1:"b8"}},leave:{text:d("leave city"),nextScene:"end"}}},b1:{text:[d("the old tower seems mostly intact."),d("the shell of a burned out car blocks the entrance."),d("most of the windows at ground level are busted anyway.")],buttons:{enter:{text:d("enter"),nextScene:{.5:"c1",1:"c2"}},leave:{text:d("leave city"),nextScene:"end"}}},b2:{combat:!0,notification:d("a huge lizard scrambles up out of the darkness of an old metro station."),enemy:"lizard",chara:"R",damage:5,hit:.8,attackDelay:2,health:20,loot:{scales:{min:5,max:10,chance:.8},teeth:{min:5,max:10,chance:.5},meat:{min:5,max:10,chance:.8}},buttons:{descend:{text:d("descend"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"c2",1:"c3"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},b3:{notification:d("the shot echoes in the empty street."),combat:!0,enemy:"sniper",chara:"D",damage:15,hit:.8,attackDelay:4,health:30,ranged:!0,loot:{cured_meat:{min:1,max:5,chance:.8},bullets:{min:1,max:5,chance:.5},rifle:{min:1,max:1,chance:.2}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"c4",1:"c5"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},b4:{notification:d("the soldier steps out from between the buildings, rifle raised."),combat:!0,enemy:"soldier",ranged:!0,chara:"D",damage:8,hit:.8,attackDelay:2,health:50,loot:{cured_meat:{min:1,max:5,chance:.8},bullets:{min:1,max:5,chance:.5},rifle:{min:1,max:1,chance:.2}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"c5",1:"c6"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},b5:{notification:d("a frail man stands defiantly, blocking the path."),combat:!0,enemy:"frail man",chara:"E",damage:1,hit:.8,attackDelay:2,health:10,loot:{cured_meat:{min:1,max:5,chance:.8},cloth:{min:1,max:5,chance:.5},leather:{min:1,max:1,chance:.2},medicine:{min:1,max:3,chance:.05}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"c7",1:"c8"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},b6:{text:[d("nothing but downcast eyes."),d("the people here were broken a long time ago.")],buttons:{continue:{text:d("continue"),nextScene:{.5:"c8",1:"c9"}},leave:{text:d("leave city"),nextScene:"end"}}},b7:{text:[d("empty corridors."),d("the place has been swept clean by scavengers.")],buttons:{continue:{text:d("continue"),nextScene:{.3:"c12",.7:"c10",1:"c11"}},leave:{text:d("leave city"),nextScene:"end"}}},b8:{notification:d("an old man bursts through a door, wielding a scalpel."),combat:!0,enemy:"old man",chara:"E",damage:3,hit:.5,attackDelay:2,health:10,loot:{cured_meat:{min:1,max:3,chance:.5},cloth:{min:1,max:5,chance:.8},medicine:{min:1,max:2,chance:.5}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.3:"c13",.7:"c11",1:"end15"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},c1:{notification:d("a thug is waiting on the other side of the wall."),combat:!0,enemy:"thug",chara:"E",damage:3,hit:.8,attackDelay:2,health:30,loot:{steel_sword:{min:1,max:1,chance:.5},cured_meat:{min:1,max:3,chance:.5},cloth:{min:1,max:5,chance:.8}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"d1",1:"d2"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},c2:{notification:d("a snarling beast jumps out from behind a car."),combat:!0,enemy:"beast",chara:"R",damage:2,hit:.8,attackDelay:1,health:30,loot:{meat:{min:1,max:5,chance:.8},fur:{min:1,max:5,chance:.8},teeth:{min:1,max:5,chance:.5}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"d2"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},c3:{text:[d("street above the subway platform is blown away."),d("lets some light down into the dusty haze."),d("a sound comes from the tunnel, just ahead.")],buttons:{enter:{text:d("investigate"),cost:{torch:1},nextScene:{.5:"d2",1:"d3"}},leave:{text:d("leave city"),nextScene:"end"}}},c4:{text:[d("looks like a camp of sorts up ahead."),d("rusted chainlink is pulled across an alleyway."),d("fires burn in the courtyard beyond.")],buttons:{enter:{text:d("continue"),nextScene:{.5:"d4",1:"d5"}},leave:{text:d("leave city"),nextScene:"end"}}},c5:{text:[d("more voices can be heard ahead."),d("they must be here for a reason.")],buttons:{enter:{text:d("continue"),nextScene:{1:"d5"}},leave:{text:d("leave city"),nextScene:"end"}}},c6:{text:[d("the sound of gunfire carries on the wind."),d("the street ahead glows with firelight.")],buttons:{enter:{text:d("continue"),nextScene:{.5:"d5",1:"d6"}},leave:{text:d("leave city"),nextScene:"end"}}},c7:{text:[d("more squatters are crowding around now."),d("someone throws a stone.")],buttons:{enter:{text:d("continue"),nextScene:{.5:"d7",1:"d8"}},leave:{text:d("leave city"),nextScene:"end"}}},c8:{text:[d("an improvised shop is set up on the sidewalk."),d("the owner stands by, stoic.")],loot:{steel_sword:{min:1,max:1,chance:.8},rifle:{min:1,max:1,chance:.5},bullets:{min:1,max:8,chance:.25},alien_alloy:{min:1,max:1,chance:.01},medicine:{min:1,max:4,chance:.5}},buttons:{enter:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"d8"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},c9:{text:[d("strips of meat hang drying by the side of the street."),d("the people back away, avoiding eye contact.")],loot:{cured_meat:{min:5,max:10,chance:1}},buttons:{enter:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"d8",1:"d9"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},c10:{text:[d("someone has locked and barricaded the door to this operating theatre.")],buttons:{enter:{text:d("continue"),nextScene:{.2:"end12",.6:"d10",1:"d11"}},leave:{text:d("leave city"),nextScene:"end"}}},c11:{notification:d("a tribe of elderly squatters is camped out in this ward."),combat:!0,enemy:"squatters",plural:!0,chara:"EEE",damage:2,hit:.7,attackDelay:.5,health:40,loot:{cured_meat:{min:1,max:3,chance:.5},cloth:{min:3,max:8,chance:.8},medicine:{min:1,max:3,chance:.3}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"end10"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},c12:{notification:d("a pack of lizards rounds the corner."),combat:!0,enemy:"lizards",plural:!0,chara:"RRR",damage:4,hit:.7,attackDelay:.7,health:30,loot:{meat:{min:3,max:8,chance:1},teeth:{min:2,max:4,chance:1},scales:{min:3,max:5,chance:1}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"end10"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},c13:{text:[d("strips of meat are hung up to dry in this ward.")],loot:{cured_meat:{min:3,max:10,chance:1}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"end10",1:"end11"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},d1:{notification:d("a large bird nests at the top of the stairs."),combat:!0,enemy:"bird",chara:"R",damage:5,hit:.7,attackDelay:1,health:45,loot:{meat:{min:5,max:10,chance:.8}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"end1",1:"end2"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},d2:{text:[d("the debris is denser here."),d("maybe some useful stuff in the rubble.")],loot:{bullets:{min:1,max:5,chance:.5},steel:{min:1,max:10,chance:.8},alien_alloy:{min:1,max:1,chance:.01},cloth:{min:1,max:10,chance:1}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"end2"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},d3:{notification:d("a swarm of rats rushes up the tunnel."),combat:!0,enemy:"rats",plural:!0,chara:"RRR",damage:1,hit:.8,attackDelay:.25,health:60,loot:{fur:{min:5,max:10,chance:.8},teeth:{min:5,max:10,chance:.5}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"end2",1:"end3"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},d4:{notification:d("a large man attacks, waving a bayonet."),combat:!0,enemy:"veteran",chara:"D",damage:6,hit:.8,attackDelay:2,health:45,loot:{bayonet:{min:1,max:1,chance:.5},cured_meat:{min:1,max:5,chance:.8}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"end4",1:"end5"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},d5:{notification:d("a second soldier opens fire."),combat:!0,enemy:"soldier",ranged:!0,chara:"D",damage:8,hit:.8,attackDelay:2,health:50,loot:{cured_meat:{min:1,max:5,chance:.8},bullets:{min:1,max:5,chance:.5},rifle:{min:1,max:1,chance:.2}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"end5"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},d6:{notification:d("a masked soldier rounds the corner, gun drawn"),combat:!0,enemy:"commando",chara:"D",ranged:!0,damage:3,hit:.9,attackDelay:2,health:55,loot:{rifle:{min:1,max:1,chance:.5},bullets:{min:1,max:5,chance:.8},cured_meat:{min:1,max:5,chance:.8}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"end5",1:"end6"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},d7:{notification:d("the crowd surges forward."),combat:!0,enemy:"squatters",plural:!0,chara:"EEE",damage:2,hit:.7,attackDelay:.5,health:40,loot:{cloth:{min:1,max:5,chance:.8},teeth:{min:1,max:5,chance:.5}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"end7",1:"end8"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},d8:{notification:d("a youth lashes out with a tree branch."),combat:!0,enemy:"youth",chara:"E",damage:2,hit:.7,attackDelay:1,health:45,loot:{cloth:{min:1,max:5,chance:.8},teeth:{min:1,max:5,chance:.5}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"end8"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},d9:{notification:d("a squatter stands firmly in the doorway of a small hut."),combat:!0,enemy:"squatter",chara:"E",damage:3,hit:.8,attackDelay:2,health:20,loot:{cloth:{min:1,max:5,chance:.8},teeth:{min:1,max:5,chance:.5}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{.5:"end8",1:"end9"}},leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},d10:{notification:d("behind the door, a deformed figure awakes and attacks."),combat:!0,enemy:"deformed",chara:"T",damage:8,hit:.6,attackDelay:2,health:40,loot:{cloth:{min:1,max:5,chance:.8},teeth:{min:2,max:2,chance:1},steel:{min:1,max:3,chance:.6},scales:{min:2,max:3,chance:.1}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"end14"}}}},d11:{notification:d("as soon as the door is open a little bit, hundreds of tentacles erupt."),combat:!0,enemy:"tentacles",plural:!0,chara:"TTT",damage:2,hit:.6,attackDelay:.5,health:60,loot:{meat:{min:10,max:20,chance:1}},buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"end13"}}}},end1:{text:[d("bird must have liked shiney things."),d("some good stuff woven into its nest.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{bullets:{min:5,max:10,chance:.8},bolas:{min:1,max:5,chance:.5},alien_alloy:{min:1,max:1,chance:.5}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end2:{text:[d("not much here."),d("scavengers must have gotten to this place already.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{torch:{min:1,max:5,chance:.8},cured_meat:{min:1,max:5,chance:.5}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end3:{text:[d("the tunnel opens up at another platform."),d("the walls are scorched from an old battle."),d("bodies and supplies from both sides litter the ground.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{rifle:{min:1,max:1,chance:.8},bullets:{min:1,max:5,chance:.8},laser_rifle:{min:1,max:1,chance:.3},energy_cell:{min:1,max:5,chance:.3},alien_alloy:{min:1,max:1,chance:.3}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end4:{text:[d("the small military outpost is well supplied."),d("arms and munitions, relics from the war, are neatly arranged on the store-room floor."),d("just as deadly now as they were then.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{rifle:{min:1,max:1,chance:1},bullets:{min:1,max:10,chance:1},grenade:{min:1,max:5,chance:.8}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end5:{text:[d("searching the bodies yields a few supplies."),d("more soldiers will be on their way."),d("time to move on.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{rifle:{min:1,max:1,chance:1},bullets:{min:1,max:10,chance:1},cured_meat:{min:1,max:5,chance:.8},medicine:{min:1,max:4,chance:.1}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end6:{text:[d("the small settlement has clearly been burning a while."),d("the bodies of the wanderers that lived here are still visible in the flames."),d("still time to rescue a few supplies.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{laser_rifle:{min:1,max:1,chance:.5},energy_cell:{min:1,max:5,chance:.5},cured_meat:{min:1,max:10,chance:1}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end7:{text:[d("the remaining settlers flee from the violence, their belongings forgotten."),d("there's not much, but some useful things can still be found.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{steel_sword:{min:1,max:1,chance:.8},energy_cell:{min:1,max:5,chance:.5},cured_meat:{min:1,max:10,chance:1}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end8:{text:[d("the young settler was carrying a canvas sack."),d("it contains travelling gear, and a few trinkets."),d("there's nothing else here.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{steel_sword:{min:1,max:1,chance:.8},bolas:{min:1,max:5,chance:.5},cured_meat:{min:1,max:10,chance:1}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end9:{text:[d("inside the hut, a child cries."),d("a few belongings rest against the walls."),d("there's nothing else here.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{rifle:{min:1,max:1,chance:.8},bullets:{min:1,max:5,chance:.8},bolas:{min:1,max:5,chance:.5},alien_alloy:{min:1,max:1,chance:.2}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end10:{text:[d("the stench of rot and death fills the operating theatres."),d("a few items are scattered on the ground."),d("there is nothing else here.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{energy_cell:{min:1,max:1,chance:.3},medicine:{min:1,max:5,chance:.3},teeth:{min:3,max:8,chance:1},scales:{min:4,max:7,chance:.9}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end11:{text:[d("a pristine medicine cabinet at the end of a hallway."),d("the rest of the hospital is empty.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{energy_cell:{min:1,max:1,chance:.2},medicine:{min:3,max:10,chance:1},teeth:{min:1,max:2,chance:.2}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end12:{text:[d("someone had been stockpiling loot here.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{energy_cell:{min:1,max:3,chance:.2},medicine:{min:3,max:10,chance:.5},bullets:{min:2,max:8,chance:1},torch:{min:1,max:3,chance:.5},grenade:{min:1,max:1,chance:.5},alien_alloy:{min:1,max:2,chance:.8}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end13:{text:[d("the tentacular horror is defeated."),d("inside, the remains of its victims are everywhere.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{steel_sword:{min:1,max:3,chance:.5},rifle:{min:1,max:2,chance:.3},teeth:{min:2,max:8,chance:1},cloth:{min:3,max:6,chance:.5},alien_alloy:{min:1,max:1,chance:.1}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end14:{text:[d("the warped man lies dead."),d("the operating theatre has a lot of curious equipment.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{energy_cell:{min:2,max:5,chance:.8},medicine:{min:3,max:12,chance:1},cloth:{min:1,max:3,chance:.5},steel:{min:2,max:3,chance:.3},alien_alloy:{min:1,max:1,chance:.3}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},end15:{text:[d("the old man had a small cache of interesting items.")],onLoad:function(e){e.spaces.World.clearDungeon(),e.dispatch(e.actions.game.city.setM({cleared:!0}))},loot:{alien_alloy:{min:1,max:1,chance:.8},medicine:{min:1,max:4,chance:1},cured_meat:{min:3,max:7,chance:1},bolas:{min:1,max:3,chance:.5},fur:{min:1,max:5,chance:.8}},buttons:{leave:{text:d("leave city"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}}}},house:{title:d("An Old House"),id:"house",scenes:{start:{text:[d("an old house remains here, once white siding yellowed and peeling."),d("the door hangs open.")],notification:d("the remains of an old house stand as a monument to simpler times"),buttons:{enter:{text:d("go inside"),nextScene:{.25:"medicine",.5:"supplies",1:"occupied"}},leave:{text:d("leave"),nextScene:"end"}}},supplies:{text:[d("the house is abandoned, but not yet picked over."),d("still a few drops of water in the old well.")],onLoad:function(e){var t=e.getState().game.world.curPos;e.spaces.World.markVisited(t[0],t[1]),e.spaces.World.setWater(e.spaces.World.getMaxWater()),e.notify("water replenished")},loot:{cured_meat:{min:1,max:10,chance:.8},leather:{min:1,max:10,chance:.2},cloth:{min:1,max:10,chance:.5}},buttons:{leave:{text:d("leave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},medicine:{text:[d("the house has been ransacked."),d("but there is a cache of medicine under the floorboards.")],onLoad:function(e){var t=e.getState().game.world.curPos;e.spaces.World.markVisited(t[0],t[1])},loot:{medicine:{min:2,max:5,chance:1}},buttons:{leave:{text:d("leave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},occupied:{combat:!0,enemy:"squatter",chara:"E",damage:3,hit:.8,attackDelay:2,health:10,notification:d("a man charges down the hall, a rusty blade in his hand"),onLoad:function(e){var t=e.getState().game.world.curPos;e.spaces.World.markVisited(t[0],t[1])},loot:{cured_meat:{min:1,max:10,chance:.8},leather:{min:1,max:10,chance:.2},cloth:{min:1,max:10,chance:.5}},buttons:{leave:{text:d("leave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}}}},battlefield:{title:d("A Forgotten Battlefield"),id:"battlefield",scenes:{start:{text:[d("a battle was fought here, long ago."),d("battered technology from both sides lays dormant on the blasted landscape.")],onLoad:function(e){var t=e.getState().game.world.curPos;e.spaces.World.markVisited(t[0],t[1])},loot:{rifle:{min:1,max:3,chance:.5},bullets:{min:5,max:20,chance:.8},laser_rifle:{min:1,max:3,chance:.3},energy_cell:{min:5,max:10,chance:.5},grenade:{min:1,max:5,chance:.5},alien_alloy:{min:1,max:1,chance:.3}},buttons:{leave:{text:d("leave"),nextScene:"end"}}}}},borehole:{title:d("A Huge Borehole"),id:"borehole",scenes:{start:{text:[d("a huge hole is cut deep into the earth, evidence of the past harvest."),d("they took what they came for, and left."),d("castoff from the mammoth drills can still be found by the edges of the precipice.")],onLoad:function(e){var t=e.getState().game.world.curPos;e.spaces.World.markVisited(t[0],t[1])},loot:{alien_alloy:{min:1,max:3,chance:1}},buttons:{leave:{text:d("leave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}}}},ship:{title:d("A Crashed Ship"),id:"ship",scenes:{start:{onLoad:function(){var e=n(h.mark((function e(t){var n,r;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getState(),r=n.game.world.curPos,e.next=4,t.spaces.World.markVisited(r[0],r[1]);case 4:return e.next=6,t.spaces.World.drawRoad();case 6:return e.next=8,t.dispatch(t.actions.features.location.enableSpaceShip());case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),text:[d("the familiar curves of a wanderer vessel rise up out of the dust and ash. "),d("lucky that the natives can't work the mechanisms."),d("with a little effort, it might fly again.")],buttons:{leavel:{text:d("salvage"),nextScene:"end"}}}}},sulphurmine:{title:d("The Sulphur Mine"),id:"sulphurmine",scenes:{start:{text:[d("the military is already set up at the mine's entrance."),d("soldiers patrol the perimeter, rifles slung over their shoulders.")],notification:d("a military perimeter is set up around the mine."),buttons:{attack:{text:d("attack"),nextScene:{1:"a1"}},leave:{text:d("leave"),nextScene:"end"}}},a1:{combat:!0,enemy:"soldier",ranged:!0,chara:"D",damage:8,hit:.8,attackDelay:2,health:50,loot:{cured_meat:{min:1,max:5,chance:.8},bullets:{min:1,max:5,chance:.5},rifle:{min:1,max:1,chance:.2}},notification:d("a soldier, alerted, opens fire."),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"a2"}},run:{text:d("run"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},a2:{combat:!0,enemy:"soldier",ranged:!0,chara:"D",damage:8,hit:.8,attackDelay:2,health:50,loot:{cured_meat:{min:1,max:5,chance:.8},bullets:{min:1,max:5,chance:.5},rifle:{min:1,max:1,chance:.2}},notification:d("a second soldier joins the fight."),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"a3"}},run:{text:d("run"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},a3:{combat:!0,enemy:"veteran",chara:"D",damage:10,hit:.8,attackDelay:2,health:65,loot:{bayonet:{min:1,max:1,chance:.5},cured_meat:{min:1,max:5,chance:.8}},notification:d("a grizzled soldier attacks, waving a bayonet."),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"cleared"}}}},cleared:{text:[d("the military presence has been cleared."),d("the mine is now safe for workers.")],notification:d("the sulphur mine is clear of dangers"),onLoad:function(){var e=n(h.mark((function e(t){var n,r;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getState(),r=n.game.world.curPos,e.next=4,t.spaces.World.drawRoad();case 4:return e.next=6,t.dispatch(t.actions.game.world.setM({sulphurmine:!0}));case 6:return e.next=8,t.spaces.World.markVisited(r[0],r[1]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),buttons:{leave:{text:d("leave"),nextScene:"end"}}}}},coalmine:{title:d("The Coal Mine"),id:"coalmine",scenes:{start:{text:[d("camp fires burn by the entrance to the mine."),d("men mill about, weapons at the ready.")],notification:d("this old mine is not abandoned"),buttons:{attack:{text:d("attack"),nextScene:{1:"a1"}},leave:{text:d("leave"),nextScene:"end"}}},a1:{combat:!0,enemy:"man",chara:"E",damage:3,hit:.8,attackDelay:2,health:10,loot:{cured_meat:{min:1,max:5,chance:.8},cloth:{min:1,max:5,chance:.8}},notification:d("a man joins the fight"),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"a2"}},run:{text:d("run"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},a2:{combat:!0,enemy:"man",chara:"E",damage:3,hit:.8,attackDelay:2,health:10,loot:{cured_meat:{min:1,max:5,chance:.8},cloth:{min:1,max:5,chance:.8}},notification:d("a man joins the fight"),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"a3"}},run:{text:d("run"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:"end"}}},a3:{combat:!0,enemy:"chief",chara:"D",damage:5,hit:.8,attackDelay:2,health:20,loot:{cured_meat:{min:5,max:10,chance:1},cloth:{min:5,max:10,chance:.8},iron:{min:1,max:5,chance:.8}},notification:d("only the chief remains."),buttons:{continue:{text:d("continue"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"cleared"}}}},cleared:{text:[d("the camp is still, save for the crackling of the fires."),d("the mine is now safe for workers.")],notification:d("the coal mine is clear of dangers"),onLoad:function(){var e=n(h.mark((function e(t){var n,r;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getState(),r=n.game.world.curPos,e.next=4,t.spaces.World.drawRoad();case 4:return e.next=6,t.dispatch(t.actions.game.world.setM({coalmine:!0}));case 6:return e.next=8,t.spaces.World.markVisited(r[0],r[1]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),buttons:{leave:{text:d("leave"),nextScene:"end"}}}}},ironmine:{title:d("The Iron Mine"),id:"ironmine",scenes:{start:{text:[d("an old iron mine sits here, tools abandoned and left to rust."),d("bleached bones are strewn about the entrance. many, deeply scored with jagged grooves."),d("feral howls echo out of the darkness.")],notification:d("the path leads to an abandoned mine"),buttons:{enter:{text:d("go inside"),nextScene:{1:"enter"},cost:{torch:1}},leave:{text:d("leave"),nextScene:"end"}}},enter:{combat:!0,enemy:"beastly matriarch",chara:"T",damage:4,hit:.8,attackDelay:2,health:10,loot:{teeth:{min:5,max:10,chance:1},scales:{min:5,max:10,chance:.8},cloth:{min:5,max:10,chance:.5}},notification:d("a large creature lunges, muscles rippling in the torchlight"),buttons:{leave:{text:d("leave"),cooldown:Mt.Event.LEAVE_COOLDOWN,nextScene:{1:"cleared"}}}},cleared:{text:[d("the beast is dead."),d("the mine is now safe for workers.")],notification:d("the iron mine is clear of dangers"),onLoad:function(){var e=n(h.mark((function e(t){var n,r;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getState(),r=n.game.world.curPos,e.next=4,t.spaces.World.drawRoad();case 4:return e.next=6,t.dispatch(t.actions.game.world.setM({ironmine:!0}));case 6:return e.next=8,t.spaces.World.markVisited(r[0],r[1]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),buttons:{leave:{text:d("leave"),nextScene:"end"}}}}},cache:{title:d("A Destroyed Village"),id:"cache",scenes:{start:{text:[d("a destroyed village lies in the dust."),d("charred bodies litter the ground.")],notification:d("the metallic tang of wanderer afterburner hangs in the air."),buttons:{enter:{text:d("enter"),nextScene:{1:"underground"}},leave:{text:d("leave"),nextScene:"end"}}},underground:{text:[d("a shack stands at the center of the village."),d("there are still supplies inside.")],buttons:{take:{text:d("take"),nextScene:{1:"exit"}}}},exit:{text:[d("all the work of a previous generation is here."),d("ripe for the picking.")],onLoad:function(e){var t=e.getState().game.world.curPos;e.spaces.World.markVisited(t[0],t[1]),e.prestige.collectStores()},buttons:{leave:{text:d("leave"),nextScene:"end"}}}}}},Mr=[{title:d("A Snarling Beast"),isAvailable:function(e,t){return t.spaces.World.getDistance()<=10&&t.spaces.World.getTerrain()===Mt.World.TILE.FOREST},scenes:{start:{combat:!0,enemy:"snarling beast",enemyName:d("snarling beast"),deathMessage:d("the snarling beast is dead"),chara:"R",damage:1,hit:.8,attackDelay:1,health:5,loot:{fur:{min:1,max:3,chance:1},meat:{min:1,max:3,chance:1},teeth:{min:1,max:3,chance:.8}},notification:d("a snarling beast leaps out of the underbrush")}}},{title:d("A Gaunt Man"),isAvailable:function(e,t){return t.spaces.World.getDistance()<=10&&t.spaces.World.getTerrain()===Mt.World.TILE.BARRENS},scenes:{start:{combat:!0,enemy:"gaunt man",enemyName:d("gaunt man"),deathMessage:d("the gaunt man is dead"),chara:"E",damage:2,hit:.8,attackDelay:2,health:6,loot:{cloth:{min:1,max:3,chance:.8},teeth:{min:1,max:2,chance:.8},leather:{min:1,max:2,chance:.5}},notification:d("a gaunt man approaches, a crazed look in his eye")}}},{title:d("A Strange Bird"),isAvailable:function(e,t){return t.spaces.World.getDistance()<=10&&t.spaces.World.getTerrain()===Mt.World.TILE.FIELD},scenes:{start:{combat:!0,enemy:"strange bird",enemyName:d("strange bird"),deathMessage:d("the strange bird is dead"),chara:"R",damage:3,hit:.8,attackDelay:2,health:4,loot:{scales:{min:1,max:3,chance:.8},teeth:{min:1,max:2,chance:.5},meat:{min:1,max:3,chance:.8}},notification:d("a strange looking bird speeds across the plains")}}},{title:d("A Shivering Man"),isAvailable:function(e,t){var n=t.spaces.World.getDistance();return n>10&&n<=20&&t.spaces.World.getTerrain()===Mt.World.TILE.BARRENS},scenes:{start:{combat:!0,enemy:"shivering man",enemyName:d("shivering man"),deathMessage:d("the shivering man is dead"),chara:"E",damage:5,hit:.5,attackDelay:1,health:20,loot:{cloth:{min:1,max:1,chance:.2},teeth:{min:1,max:2,chance:.8},leather:{min:1,max:1,chance:.2},medicine:{min:1,max:3,chance:.7}},notification:d("a shivering man approaches and attacks with surprising strength")}}},{title:d("A Man-Eater"),isAvailable:function(e,t){var n=t.spaces.World.getDistance();return n>10&&n<=20&&t.spaces.World.getTerrain()===Mt.World.TILE.FOREST},scenes:{start:{combat:!0,enemy:"man-eater",enemyName:d("man-eater"),deathMessage:d("the man-eater is dead"),chara:"T",damage:3,hit:.8,attackDelay:1,health:25,loot:{fur:{min:5,max:10,chance:1},meat:{min:5,max:10,chance:1},teeth:{min:5,max:10,chance:.8}},notification:d("a large creature attacks, claws freshly bloodied")}}},{title:d("A Scavenger"),isAvailable:function(e,t){var n=t.spaces.World.getDistance();return n>10&&n<=20&&t.spaces.World.getTerrain()===Mt.World.TILE.BARRENS},scenes:{start:{combat:!0,enemy:"scavenger",enemyName:d("scavenger"),deathMessage:d("the scavenger is dead"),chara:"E",damage:4,hit:.8,attackDelay:2,health:30,loot:{cloth:{min:5,max:10,chance:.8},leather:{min:5,max:10,chance:.8},iron:{min:1,max:5,chance:.5},medicine:{min:1,max:2,chance:.1}},notification:d("a scavenger draws close, hoping for an easy score")}}},{title:d("A Huge Lizard"),isAvailable:function(e,t){var n=t.spaces.World.getDistance();return n>10&&n<=20&&t.spaces.World.getTerrain()===Mt.World.TILE.FIELD},scenes:{start:{combat:!0,enemy:"lizard",enemyName:d("lizard"),deathMessage:d("the lizard is dead"),chara:"T",damage:5,hit:.8,attackDelay:2,health:20,loot:{scales:{min:5,max:10,chance:.8},teeth:{min:5,max:10,chance:.5},meat:{min:5,max:10,chance:.8}},notification:d("the grass thrashes wildly as a huge lizard pushes through")}}},{title:d("A Feral Terror"),isAvailable:function(e,t){return t.spaces.World.getDistance()>20&&t.spaces.World.getTerrain()===Mt.World.TILE.FOREST},scenes:{start:{combat:!0,enemy:"feral terror",enemyName:d("feral terror"),deathMessage:d("the feral terror is dead"),chara:"T",damage:6,hit:.8,attackDelay:1,health:45,loot:{fur:{min:5,max:10,chance:1},meat:{min:5,max:10,chance:1},teeth:{min:5,max:10,chance:.8}},notification:d("a beast, wilder than imagining, erupts out of the foliage")}}},{title:d("A Soldier"),isAvailable:function(e,t){return t.spaces.World.getDistance()>20&&t.spaces.World.getTerrain()===Mt.World.TILE.BARRENS},scenes:{start:{combat:!0,enemy:"soldier",enemyName:d("soldier"),deathMessage:d("the soldier is dead"),ranged:!0,chara:"D",damage:8,hit:.8,attackDelay:2,health:50,loot:{cloth:{min:5,max:10,chance:.8},bullets:{min:1,max:5,chance:.5},rifle:{min:1,max:1,chance:.2},medicine:{min:1,max:2,chance:.1}},notification:d("a soldier opens fire from across the desert")}}},{title:d("A Sniper"),isAvailable:function(e,t){return t.spaces.World.getDistance()>20&&t.spaces.World.getTerrain()===Mt.World.TILE.FIELD},scenes:{start:{combat:!0,enemy:"sniper",enemyName:d("sniper"),deathMessage:d("the sniper is dead"),chara:"D",damage:15,hit:.8,attackDelay:4,health:30,ranged:!0,loot:{cloth:{min:5,max:10,chance:.8},bullets:{min:1,max:5,chance:.5},rifle:{min:1,max:1,chance:.2},medicine:{min:1,max:2,chance:.1}},notification:d("a shot rings out, from somewhere in the long grass")}}}],Rr=function(){function e(e){this.engine=e}var t=e.prototype;return t.onArrival=function(){},t.clean=function(){},e}(),Cr=function(){function e(e,t){this.engine=e,this.manager=t,this.listeners={}}var t=e.prototype;return t.clearCooldown=function(){var e=n(h.mark((function e(t){var n;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.manager.findById(t))){e.next=4;break}return e.next=4,this.engine.dispatch(this.engine.actions.operation.clearCooldown(n.id));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.cooldown=function(){var e=n(h.mark((function e(t){var n;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.manager.findById(t))){e.next=4;break}return e.next=4,this.engine.dispatch(this.engine.actions.operation.record(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.availableOperations=function(){var e=this,t=[],n=this.engine.getState();return this.manager.operations.forEach((function(r){if(!r.isAvailable||r.isAvailable(e.engine,r)){var a={name:r.name,id:r.id};r.desc&&(a.desc=r.desc),r.help&&(a.help=r.help(e.engine,r)),a.history=n.operation[r.id],a.cooldown=r.cooldown?r.cooldown(e.engine,r):0,a.meta=r.meta,t.push(a)}})),t},t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(this.listeners[e]){var n=this.listeners[e].indexOf(t);n>-1&&this.listeners[e].splice(n,1)}},t.emit=function(e,t){(this.listeners[e]||[]).forEach((function(e){e(t)}))},t.exec=function(){var e=n(h.mark((function e(t){var n,r,a,o,i,c,s,u=arguments;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.manager.findById(t),r=this.engine.getState(),!n){e.next=19;break}if(!(a=r.operation[t])||!n.cooldown){e.next=7;break}if(!(Date.now()<=a.cooldownAt)){e.next=7;break}return e.abrupt("return");case 7:if(!n.isAvailable||n.isAvailable(this.engine,n)){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,this.engine.dispatch(this.engine.actions.operation.record(n));case 11:for(o=u.length,i=new Array(o>1?o-1:0),c=1;c<o;c++)i[c-1]=u[c];return fr("operation "+t+" start",i),e.next=15,n.exec.apply(n,[this.engine,n].concat(i));case 15:return this.emit(t,s=e.sent),fr("operation "+t+" finish",s),e.abrupt("return",s);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}(),jr=new(function(){function e(){this.operations=[]}var t=e.prototype;return t.findById=function(e){return this.operations.find((function(t){return t.id===e}))},t.add=function(e){return this.findById(e.id)||(this.operations.push(e),e)},e}());jr.add({id:"Combat.takeLoot",name:"take",isAvailable:function(t){var n=t.getState();return!At.isEmpty(n.events.loot)&&n.events.won&&n.engine.activeSpace===e.GameSpace.World},meta:{space:e.GameSpace.World},help:function(e){var t=e.getState(),n=[];return Object.keys(t.events.loot).forEach((function(e){t.events.loot[e]>0&&n.push(e)})),{desc:"take "+n.join(", "),parms:[n]}},exec:(vr=n(h.mark((function e(t,n,r){var a,o,i,c,s,u;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.getState(),o=t.spaces.Path,!(a.events.loot[r]>0)){e.next=12;break}if(i=o.getWeight(r),c=t.spaces.World.getFreeSpace(),!(i<=c)){e.next=11;break}return e.next=9,t.dispatch(t.actions.events.addM(((s={})["loot."+r]=-1,s)));case 9:return e.next=11,t.dispatch(t.actions.game.world.addM(((u={})["outfit."+r]=1,u)));case 11:return e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e)}))),function(e,t,n){return vr.apply(this,arguments)})}),jr.add({id:"Combat.takeAllLoot",name:"take all",isAvailable:function(t){var n=t.getState();return!At.isEmpty(n.events.loot)&&n.events.won&&n.engine.activeSpace===e.GameSpace.World},meta:{space:e.GameSpace.World},help:function(e){var t=e.getState(),n=[];return Object.keys(t.events.loot).forEach((function(e){t.events.loot[e]>0&&n.push(e)})),{desc:"take all "+n.join(", "),parms:[n]}},exec:(yr=n(h.mark((function e(t,n,r){var a,o,i;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.getState(),o=a.events.loot[r],i=0;case 3:if(!(i<o)){e.next=12;break}return e.next=6,t.operationExecutor.exec("Combat.takeLoot",r);case 6:if(e.sent){e.next=9;break}return e.abrupt("break",12);case 9:i++,e.next=3;break;case 12:return e.abrupt("return",[i===o,i]);case 13:case"end":return e.stop()}}),e)}))),function(e,t,n){return yr.apply(this,arguments)})}),jr.add({id:"Combat.takeEverything",name:"take everything",isAvailable:function(t){var n=t.getState();return!At.isEmpty(n.events.loot)&&n.events.won&&n.engine.activeSpace===e.GameSpace.World},meta:{space:e.GameSpace.World},exec:(br=n(h.mark((function e(t){var n,r,a,o,i;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.getState(),r={},a=!0,e.t0=h.keys(n.events.loot);case 5:if((e.t1=e.t0()).done){e.next=16;break}return o=e.t1.value,e.next=9,t.operationExecutor.exec("Combat.takeAllLoot",o);case 9:if(r[o]=(i=e.sent)[1],i[0]){e.next=14;break}return a=!1,e.abrupt("break",16);case 14:e.next=5;break;case 16:return e.abrupt("return",[a,r]);case 17:case"end":return e.stop()}}),e)}))),function(e){return br.apply(this,arguments)})}),jr.add({id:"Combat.dropStuff",name:"drop stuff",isAvailable:function(t){var n=t.getState();return!At.isEmpty(n.game.world.outfit)&&n.events.won&&n.engine.activeSpace===e.GameSpace.World},meta:{space:e.GameSpace.World},help:function(e){var t=e.getState(),n=[];return Object.keys(t.game.world.outfit).forEach((function(e){t.events.loot[e]>0&&n.push(e)})),{desc:"drop "+n.join(", "),parms:[n]}},exec:(xr=n(h.mark((function e(t,n,r){var a,o,i,c;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.getState(),!((o=Math.min(a.game.world.outfit[r],1))>0)){e.next=9;break}return e.next=7,t.dispatch(t.actions.events.addM(((i={})["loot."+r]=o,i)));case 7:return e.next=9,t.dispatch(t.actions.game.world.addM(((c={})["outfit."+r]=-o,c)));case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)}))),function(e,t,n){return xr.apply(this,arguments)})}),jr.add({id:"Combat.eatMeatInFight",name:"eat meat",cooldown:function(){return Mt.Event.EAT_COOLDOWN},isAvailable:function(t){var n=t.getState();return n.events.enemys.length>0&&!n.events.won&&n.engine.activeSpace===e.GameSpace.World},meta:{space:e.GameSpace.World,cost:(dr={},dr[e.StoreCategory.cured_meat]=1,dr)},exec:(wr=n(h.mark((function t(n){return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.events.doHeal(e.StoreCategory.cured_meat,n.spaces.World.meatHeal());case 2:t.sent||n.operationExecutor.clearCooldown("Combat.eatMeatInFight");case 4:case"end":return t.stop()}}),t)}))),function(e){return wr.apply(this,arguments)})}),jr.add({id:"Combat.eatMeat",name:"eat meat",isAvailable:function(t){var n=t.getState();return n.events.won&&n.engine.activeSpace===e.GameSpace.World},meta:{space:e.GameSpace.World,cost:(pr={},pr[e.StoreCategory.cured_meat]=1,pr)},exec:(Sr=n(h.mark((function t(n){return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.events.doHeal(e.StoreCategory.cured_meat,n.spaces.World.meatHeal());case 2:t.sent||n.operationExecutor.clearCooldown("Combat.eatMeat");case 4:case"end":return t.stop()}}),t)}))),function(e){return Sr.apply(this,arguments)})}),jr.add({id:"Combat.useMedsInFight",name:"use meds",cooldown:function(){return Mt.Event.MEDS_COOLDOWN},isAvailable:function(t){var n=t.getState();return n.events.enemys.length>0&&!n.events.won&&n.engine.activeSpace===e.GameSpace.World},meta:{space:e.GameSpace.World,cost:(mr={},mr[e.StoreCategory.medicine]=1,mr)},exec:(_r=n(h.mark((function t(n){return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.events.doHeal(e.StoreCategory.medicine,n.spaces.World.medsHeal());case 2:t.sent||n.operationExecutor.clearCooldown("Combat.useMedsInFight");case 4:case"end":return t.stop()}}),t)}))),function(e){return _r.apply(this,arguments)})}),jr.add({id:"Combat.useMeds",name:"use meds",isAvailable:function(t){var n=t.getState();return n.events.won&&n.engine.activeSpace===e.GameSpace.World},meta:{space:e.GameSpace.World,cost:(gr={},gr[e.StoreCategory.cured_meat]=1,gr)},exec:(Er=n(h.mark((function t(n){return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.events.doHeal(e.StoreCategory.medicine,n.spaces.World.medsHeal());case 2:t.sent||n.operationExecutor.clearCooldown("Combat.useMeds");case 4:case"end":return t.stop()}}),t)}))),function(e){return Er.apply(this,arguments)})}),jr.add({id:"Combat.leave",name:"leave",isAvailable:function(t){var n=t.getState();return n.events.won&&n.engine.activeSpace===e.GameSpace.World},meta:{space:e.GameSpace.World},exec:(Or=n(h.mark((function e(t){return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.events.endEvent();case 1:case"end":return e.stop()}}),e)}))),function(e){return Or.apply(this,arguments)})}),Object.keys(e.WeaponCategory).forEach((function(t){var a,o,i=Mt.items[t];jr.add({id:"Combat.useWeapon."+t,name:t,cooldown:function(e,t){var n=t.meta.weapon.cooldown;return e.getState().character.perks.unarmed_master&&(n/=2),n},isAvailable:function(t,n){var r=t.getState(),a=0;for(var o in e.WeaponCategory){var i=Mt.items[o].weapon;if(r.game.world.outfit[o]){if("number"!=typeof(null==i?void 0:i.damage)||0===i.damage)a--;else if(i.cost)for(var c in i.cost)r.game.world.outfit[c]<i.cost[c]&&a--;a++}}var s=n.meta.name;return 0===a&&"fists"===s?r.events.enemys.length>0&&!r.events.won&&r.engine.activeSpace===e.GameSpace.World:!!r.path.outfit[s]&&r.events.enemys.length>0&&!r.events.won&&r.engine.activeSpace===e.GameSpace.World},meta:{space:e.GameSpace.World,cost:null==(a=i.trade)?void 0:a.cost,weapon:i.weapon,name:t},exec:(o=n(h.mark((function t(n,a){var o,i,c,s,u,l,f,d;return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=a.meta.name,i=n.events.getActiveEvent(),c=n.getState(),i&&!(c.game.world.stunned&&c.game.world.stunned>=Date.now())){t.next=6;break}return n.operationExecutor.clearCooldown("Combat.useWeapon."+o),t.abrupt("return");case 6:if("unarmed"===(s=Mt.items[o].weapon).type&&(n.dispatch(n.actions.character.statistics.setM({punches:u=(c.character.statistics.punches||0)+1})),50!==u||c.character.perks.boxer?150!==u||c.character.perks.martial_artist?300!==u||c.character.perks.unarmed_master||n.dispatch(n.actions.character.perks.addPerk(e.PerkCategory.unarmed_master)):n.dispatch(n.actions.character.perks.addPerk(e.PerkCategory.martial_artist)):n.dispatch(n.actions.character.perks.addPerk(e.PerkCategory.boxer))),null==s||!s.cost){t.next=21;break}l=r({},c.game.world.outfit),t.t0=h.keys(s.cost);case 12:if((t.t1=t.t0()).done){t.next=20;break}if(!(l[f=t.t1.value]<s.cost[f])){t.next=17;break}return n.operationExecutor.clearCooldown("Combat.useWeapon."+o),t.abrupt("return");case 17:l[f]=l[f]-s.cost[f],t.next=12;break;case 20:n.dispatch(n.actions.game.world.setM({outfit:l}));case 21:return d=-1,Math.random()<=n.events.getHitChance()&&"number"==typeof(d=null==s?void 0:s.damage)&&("unarmed"===(null==s?void 0:s.type)&&c.character.perks.boxer&&(d*=2),"unarmed"===(null==s?void 0:s.type)&&c.character.perks.martial_artist&&(d*=3),"unarmed"===(null==s?void 0:s.type)&&c.character.perks.unarmed_master&&(d*=2),"melee"===(null==s?void 0:s.type)&&c.character.perks.barbarian&&(d=Math.floor(1.5*d))),t.next=25,n.events.damageEnemy(d,s);case 25:n.getState().events.enemys[0].health<=0&&!c.events.won&&n.events.winFight();case 27:case"end":return t.stop()}}),t)}))),function(e,t){return o.apply(this,arguments)})})})),jr.add({id:"Events.choice",name:"choice",isAvailable:function(e){var t=e.events.getActiveScene();return t&&t.buttons},help:function(e){var t=e.events.getActiveScene(),n=[];return Object.keys((null==t?void 0:t.buttons)||{}).forEach((function(e){n.push(e)})),{desc:"choice "+n.join(", "),parms:[n]}},exec:function(){var t=n(h.mark((function t(n,r,a){var o,i,c,s,u,l,f,d,p,m;return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n.events.getActiveEvent()){t.next=3;break}return t.abrupt("return");case 3:if(i=n.getState(),s={},!(c=o.scenes[i.events.activeScene].buttons[a]).cost){t.next=25;break}t.t0=h.keys(c.cost);case 8:if((t.t1=t.t0()).done){t.next=18;break}if(u=t.t1.value,!((i.engine.activeSpace===e.GameSpace.World?i.path.outfit[u]||0:i.stores[u]||0)<(c.cost[u]||0))){t.next=15;break}return n.notify("not enough "+u),t.abrupt("return",!1);case 15:s[u]=-(c.cost[u]||0),t.next=8;break;case 18:if(i.engine.activeSpace!==e.GameSpace.World){t.next=23;break}return t.next=21,n.dispatch(n.actions.path.outfit.addM(s));case 21:t.next=25;break;case 23:return t.next=25,n.dispatch(n.actions.stores.addM(s));case 25:if("function"==typeof c.onChoose&&c.onChoose(n),!c.reward){t.next=29;break}return t.next=29,n.dispatch(n.actions.stores.addM(c.reward));case 29:if(c.notification&&n.notify(c.notification),!c.nextScene){t.next=47;break}if("end"!==(l=c.nextScene)){t.next=36;break}n.events.endEvent(),t.next=47;break;case 36:if("string"!=typeof l){t.next=40;break}n.events.loadScene(l),t.next=47;break;case 40:for(p in f=Math.random(),d=null,l)m=parseFloat(p),f<m&&(null==d||p<d)&&(d=p);if(null===d){t.next=46;break}return n.events.loadScene(l[d]),t.abrupt("return");case 46:n.events.endEvent();case 47:return t.abrupt("return",!0);case 48:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()});var Pr=function(t){function r(e){var n;return(n=t.call(this,e)||this)._enemyAttackTimer=null,n.eventPool={Global:kr,Room:Ar,Outside:Lr,World:Object.values(Dr),Fight:Mr,Ship:[]},n.eventMap={Global:kr,Room:Ar,Outside:Lr,Market:Wr},n.scheduleNextEvent(),n.initDelay(),n}a(r,t);var o=r.prototype;return o.winFight=function(){clearInterval(this._enemyAttackTimer),this.engine.dispatch(this.engine.actions.events.winFight())},o.getHitChance=function(){return this.engine.getState().character.perks.precise?Mt.World.BASE_HIT_CHANCE+.1:Mt.World.BASE_HIT_CHANCE},o.doHeal=function(){var e=n(h.mark((function e(t,n){var r,a,o,i;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.engine.getState()).game.world.outfit[t]){e.next=11;break}return(a={})["outfit."+t]=(r.path.outfit[t]||0)-1,o=a,i=r.game.world.health+n,i=Math.min(this.engine.spaces.World.getMaxHealth(),i),o.health=i,e.next=8,this.engine.dispatch(this.engine.actions.game.world.setM(o));case 8:return e.abrupt("return",!0);case 11:this.engine.notify("not enough "+t);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),o.getCurrentSpaceEventsPool=function(){var t=this.engine.getState().engine.activeSpace;return t===e.GameSpace.World?[].concat(this.eventPool.World,this.eventPool.Fight):t===e.GameSpace.Ship?[].concat(this.eventPool.Ship,this.eventPool.Global):[].concat(this.eventPool.Global,this.eventPool[t]||[])},o.triggerEvent=function(){if(this.engine.getState().engine.activeSpace!==e.GameSpace.World&&null===this.getActiveEvent()){var t=this.getCurrentSpaceEventsPool(),n=[];for(var r in t){var a=t[r];a.isAvailable&&a.isAvailable(this.engine.store.getState(),this.engine)&&n.push(a)}if(0===n.length)return void this.scheduleNextEvent(.5);var o=Math.floor(Math.random()*n.length);this.startEvent(n[o])}this.scheduleNextEvent()},o.startEvent=function(){var e=n(h.mark((function e(t){var n,r,a;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(n=this.getCurrentSpaceEventsPool(),-1===(r=n.indexOf(t))&&(r=n.findIndex((function(e){return e.id===t.id&&void 0!==e.id}))),!(a=r>-1?n[r].title:"")){e.next=11;break}return e.next=9,this.engine.dispatch(this.engine.actions.events.push(a));case 9:return e.next=11,this.loadScene("start");case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o.loadScene=function(){var e=n(h.mark((function e(t){var n,r,a,o,i;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.engine.getState(),r=n.events.eventStack[0],a=this.getCurrentSpaceEventsPool(),(o=a.find((function(e){return e.title===r})))||(t="end"),e.next=7,this.engine.dispatch(this.engine.actions.events.cleanEnemys());case 7:if(this.engine.dispatch(this.engine.actions.events.setM({activeScene:t})),i=null==o?void 0:o.scenes[t]){e.next=11;break}return e.abrupt("return");case 11:i.onLoad&&i.onLoad(this.engine),i.notification&&this.engine.notify(i.notification),i.reward&&this.engine.dispatch(this.engine.actions.stores.addM(i.reward)),i.combat?this.startCombat(i):this.startStory(i);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o.addEvent=function(e,t){this.eventPool[e].find((function(e){return e.id===t.id}))||this.eventPool[e].push(t)},o.startCombat=function(e){this.setRandomLoots(e.loot),this.engine.dispatch(this.engine.actions.events.setSceneEnemy(e)),clearInterval(this._enemyAttackTimer),this._enemyAttackTimer=this.engine.setInterval(this.enemyAttack.bind(this),1e3*e.attackDelay)},o.startStory=function(e){this.setRandomLoots(e.loot)},o.enemyAttack=function(){var e=n(h.mark((function e(){var t,n,r,a,o,i,c,s;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getActiveEvent()){e.next=3;break}return e.abrupt("return");case 3:if(n=this.engine.getState(),r=t.scenes[n.events.activeScene]){e.next=7;break}return e.abrupt("return");case 7:a=0,o=n.events.enemys.length;case 8:if(!(a<o)){e.next=20;break}if((i=n.events.enemys[a]).stunned){e.next=17;break}return c=r.hit,c*=n.character.perks.evasive?.8:1,s=-1,Math.random()<=c&&(s=r.damage),e.next=17,this.damageAdventurer(i,s);case 17:a++,e.next=8;break;case 20:this.engine.getState().game.world.health<=0&&(clearInterval(this._enemyAttackTimer),this.endEvent(),this.engine.spaces.World.die());case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.damageEnemy=function(){var e=n(h.mark((function e(t,n){var r,a;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.engine.getState(),a=r.events.enemys[0].health,"number"==typeof t?t<0?(t=0,this.engine.dispatch(this.engine.actions.events.logFight({time:Date.now(),type:"miss",target:"enemy",meta:{weapon:n}}))):(this.engine.dispatch(this.engine.actions.events.setM({"enemys[0].health":a=a-t<0?0:a-t})),this.engine.dispatch(this.engine.actions.events.logFight({time:Date.now(),type:"damage",target:"enemy",meta:{dmg:t,weapon:n}}))):"stun"==t&&(this.engine.dispatch(this.engine.actions.events.setM({"enemys[0].stunned":Date.now()+Mt.Event.STUN_DURATION})),this.engine.dispatch(this.engine.actions.events.logFight({time:Date.now(),type:"stunned",target:"enemy",meta:{weapon:n}})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),o.damageAdventurer=function(e,t){var n=this.engine.getState().game.world.health;"number"==typeof t?t<0?(this.engine.dispatch(this.engine.actions.events.logFight({time:Date.now(),type:"miss",target:"player"})),t=0):(this.engine.spaces.World.setHp(n=n-t<0?0:n-t),this.engine.dispatch(this.engine.actions.events.logFight({time:Date.now(),type:"damage",target:"player",meta:{dmg:t}}))):"stun"==t&&(this.engine.dispatch(this.engine.actions.game.world.setM({stunned:Date.now()+Mt.Event.STUN_DURATION})),this.engine.dispatch(this.engine.actions.events.logFight({time:Date.now(),type:"stunned",target:"player"})))},o.setRandomLoots=function(e){var t={};for(var n in e=e||{}){var r=e[n];if(Math.random()<r.chance){var a=Math.floor(Math.random()*(r.max-r.min))+r.min;t[n]=a}}this.engine.dispatch(this.engine.actions.events.setM({loot:t}))},o.triggerFight=function(){var e=[],t=this.engine.getState();for(var n in this.eventPool.Fight){var r=this.eventPool.Fight[n];r.isAvailable&&r.isAvailable(t,this.engine)&&e.push(r)}var a=Math.floor(Math.random()*e.length);this.startEvent(e[a])},o.scheduleNextEvent=function(e){var t=Math.floor(Math.random()*(Mt.Event.EVENT_TIME_RANGE[1]-Mt.Event.EVENT_TIME_RANGE[0]))+Mt.Event.EVENT_TIME_RANGE[0];e&&e>0&&(t*=e),fr("next event scheduled in "+t+" minutes"),this.engine.setTimeout(this.triggerEvent.bind(this),60*t*1e3)},o.saveDelay=function(e,t,r){var a,o,i,c=this;r?null==(a=this.engine.store)||a.dispatch(this.engine.actions.delay.setM(((o={})[t]=r,o))):r=(null==(i=this.engine.store)?void 0:i.getState().delay[t])||0;var s=this.engine.setInterval((function(){var e,n,r;null==(e=c.engine.store)||e.dispatch(c.engine.actions.delay.setM(((r={})[t]=((null==(n=c.engine.store)?void 0:n.getState().delay[t])||0)-.5,r)))}),500);this.engine.setTimeout(n(h.mark((function n(){var r,a,o,i;return h.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return clearInterval(s),n.next=3,null==(r=c.engine.store)?void 0:r.dispatch(c.engine.actions.delay.setM(((a={})[t]=void 0,a)));case 3:return n.next=5,null==(o=c.engine.store)?void 0:o.dispatch(c.engine.actions.delay.removeM([t]));case 5:null==(i=c.engine.store)||i.dispatch(c.engine.actions.delay.clean()),e(c.engine);case 7:case"end":return n.stop()}}),n)}))),1e3*(r||0))},o.clean=function(){clearInterval(this._enemyAttackTimer),t.prototype.clean.call(this)},o.recallDelay=function(e,t){var n,r=At.get(null==(n=this.engine.store)?void 0:n.getState().events,e);for(var a in r)At.isObject(r[a])?this.recallDelay(e+'["'+a+'"]',t[a]):"function"==typeof t[a]&&t[a](this.engine)},o.initDelay=function(){var e,t=null==(e=this.engine.store)?void 0:e.getState().delay;for(var n in t)At.isObject(t[n])&&this.recallDelay(n,this.eventMap[n])},o.getActiveScene=function(){var e=this.engine.getState(),t=this.getActiveEvent();return t&&t.scenes[e.events.activeScene]||null},o.getActiveEvent=function(){var e=this.engine.getState();return e.events.eventStack.length>0&&this.getCurrentSpaceEventsPool().find((function(t){return t.title===e.events.eventStack[0]}))||null},o.endEvent=function(){this.engine.dispatch(this.engine.actions.events.end({}))},r}(Rr);jr.add({id:"World.moveSouth",name:"south",isAvailable:function(t){var n=t.getState(),r=t.events.getActiveEvent();return n.engine.activeSpace===e.GameSpace.World&&!r},meta:{space:e.GameSpace.World},exec:function(){var e=n(h.mark((function e(t){return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.getState().game.world.curPos[1]<2*Mt.World.RADIUS&&t.spaces.World.move(Mt.World.SOUTH);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),jr.add({id:"World.moveNorth",name:"north",isAvailable:function(t){var n=t.getState(),r=t.events.getActiveEvent();return n.engine.activeSpace===e.GameSpace.World&&!r},meta:{space:e.GameSpace.World},exec:function(){var e=n(h.mark((function e(t){return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.getState().game.world.curPos[1]>0&&t.spaces.World.move(Mt.World.NORTH);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),jr.add({id:"World.moveWest",name:"west",isAvailable:function(t){var n=t.getState(),r=t.events.getActiveEvent();return n.engine.activeSpace===e.GameSpace.World&&!r},meta:{space:e.GameSpace.World},exec:function(){var e=n(h.mark((function e(t){return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.getState().game.world.curPos[0]>0&&t.spaces.World.move(Mt.World.WEST);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),jr.add({id:"World.moveEast",name:"east",isAvailable:function(t){var n=t.getState(),r=t.events.getActiveEvent();return n.engine.activeSpace===e.GameSpace.World&&!r},meta:{space:e.GameSpace.World},exec:function(){var e=n(h.mark((function e(t){return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.getState().game.world.curPos[0]<2*Mt.World.RADIUS&&t.spaces.World.move(Mt.World.EAST);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});var Tr,Nr,Ir=function(t){function r(e){var n;n=t.call(this,e)||this;var r=e.store.getState();if(r.previous.stores&&(Mt.World.LANDMARKS[Mt.World.TILE.CACHE]={num:1,minRadius:10,maxRadius:1.5*Mt.World.RADIUS,scene:"cache",label:"A&nbsp;Destroyed&nbsp;Village"}),!r.features.location.Path){var a,o=n.generateMap(),i=n.newMask(),c=n.mapSearch(Mt.World.TILE.SHIP,o,1);c&&(a=n.compassDir(c[0])),e.dispatch(e.actions.game.world.setM({map:o,mask:i,ship:c,dir:a})),n.testMap()}return n}a(r,t);var o=r.prototype;return o.newMask=function(){for(var e=Mt.World.RADIUS,t=new Array(2*e+1),n=0;n<=2*e;n++)t[n]=new Array(2*e+1);return this.lightMap(e,e,t),t},o.lightMap=function(e,t,n){var r,a=null==(r=this.engine.store)?void 0:r.getState(),o=Mt.World.LIGHT_RADIUS;return this.uncoverMap(e,t,o*=null!=a&&a.character.perks.scout?2:1,n),n},o.uncoverMap=function(e,t,n,r){r[e][t]=!0;for(var a=-n;a<=n;a++)for(var o=-n+Math.abs(a);o<=n-Math.abs(a);o++)t+o>=0&&t+o<=2*Mt.World.RADIUS&&e+a<=2*Mt.World.RADIUS&&e+a>=0&&(r[e+a][t+o]=!0)},o.getTerrain=function(){var e=this.engine.getState(),t=e.game.world.curPos;return e.game.world.map[t[0]][t[1]]},o.markVisited=function(e,t){this.engine.dispatch(this.engine.actions.game.world.visit({x:e,y:t}))},o.clearDungeon=function(){var e=this.engine.getState();this.engine.dispatch(this.engine.actions.game.world.setMap({pos:e.game.world.curPos,value:Mt.World.TILE.OUTPOST})),this.drawRoad()},o.findClosestRoad=function(e){for(var t,n,r,a=this.engine.getState(),o=0,i=0,c=1,s=-1,u=0;u<Math.pow(this.getDistance(e,Mt.World.VILLAGE_POS)+2,2);u++){if(n=e[1]+i,0<(t=e[0]+o)&&t<2*Mt.World.RADIUS&&0<n&&n<2*Mt.World.RADIUS){var l=a.game.world.map[t][n];if(l===Mt.World.TILE.ROAD||l===Mt.World.TILE.OUTPOST&&(0!==o||0!==i)||l===Mt.World.TILE.VILLAGE)return[t,n]}0!==o&&0!==i||(r=c,c=-s,s=r),0===o&&i<=0?o++:(o+=c,i+=s)}return Mt.World.VILLAGE_POS},o.drawRoad=function(){var e=this.engine.getState().game.world,t=e.curPos,n=e.map;n=At.cloneDeep(n);var r,a,o=this.findClosestRoad(t),i=t[0]-o[0],c=t[1]-o[1],s=Math.abs(i)/i,u=Math.abs(c)/c;Math.abs(i)>Math.abs(c)?(r=o[0],a=o[1]+c):(r=o[0]+i,a=o[1]);for(var l=0;l<Math.abs(i);l++)this.isTerrain(n[o[0]+s*l][a])&&(n[o[0]+s*l][a]=Mt.World.TILE.ROAD);for(var f=0;f<Math.abs(c);f++)this.isTerrain(n[r][o[1]+u*f])&&(n[r][o[1]+u*f]=Mt.World.TILE.ROAD);this.engine.dispatch(this.engine.actions.game.world.setM({map:n}))},o.getMaxHealth=function(){var e=this.engine.store.getState();return e.stores.s_armour?Mt.World.BASE_HEALTH+35:e.stores.i_armour?Mt.World.BASE_HEALTH+15:e.stores.l_armou?Mt.World.BASE_HEALTH+5:Mt.World.BASE_HEALTH},o.applyMap=function(){var e=n(h.mark((function e(){var t,n,r,a,o;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=null==(t=this.engine.store)?void 0:t.getState())&&n.game.world.seenAll){e.next=7;break}o=n.game.world.mask;do{r=Math.floor(Math.random()*(2*Mt.World.RADIUS+1)),a=Math.floor(Math.random()*(2*Mt.World.RADIUS+1))}while(o[r][a]);return this.uncoverMap(r,a,5,o),e.next=7,this.engine.dispatch(this.engine.actions.game.world.setM({mask:o}));case 7:this.testMap();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.testMap=function(){var e=n(h.mark((function e(){var t,n,r,a,o,i,c;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=null==(t=this.engine.store)?void 0:t.getState())&&n.game.world.seenAll){e.next=18;break}o=n.game.world.mask,i=0;case 4:if(!(i<o.length)){e.next=16;break}c=0;case 6:if(!(c<o[i].length)){e.next=13;break}if(o[i][c]){e.next=10;break}return a=!0,e.abrupt("break",16);case 10:c++,e.next=6;break;case 13:i++,e.next=4;break;case 16:return e.next=18,null==(r=this.engine.store)?void 0:r.dispatch(this.engine.actions.game.world.seeAll(!a));case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.onArrival=function(){this.engine.dispatch(this.engine.actions.game.world.setM({water:this.getMaxWater(),health:this.getMaxHealth(),foodMove:0,waterMove:0,starvation:!1,thirst:!1,usedOutposts:{},curPos:At.cloneDeep(Mt.World.VILLAGE_POS),dead:!1}))},o.setHp=function(e){this.engine.dispatch(this.engine.actions.game.world.setM({health:Math.min(e,this.getMaxHealth())}))},o.setWater=function(e){var t=e,n=this.getMaxWater();t>n&&(t=n),this.engine.dispatch(this.engine.actions.game.world.setM({water:t}))},o.moveSouth=function(){this.engine.getState().game.world.curPos[1]<2*Mt.World.RADIUS&&this.move(Mt.World.SOUTH)},o.moveWest=function(){this.engine.getState().game.world.curPos[0]>0&&this.move(Mt.World.WEST)},o.moveEast=function(){this.engine.getState().game.world.curPos[0]<2*Mt.World.RADIUS&&this.move(Mt.World.EAST)},o.moveNorth=function(){this.engine.getState().game.world.curPos[1]>0&&this.move(Mt.World.NORTH)},o.move=function(){var t=n(h.mark((function t(n){var r,a,o,i,c,s;return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.engine.getState().game.world,a=r.map,i=r.curPos,c=r.danger,o=At.cloneDeep(o=r.mask),i=At.cloneDeep(i),s=a[i[0]][i[1]],i[0]+=n[0],i[1]+=n[1],this.narrateMove(s,a[i[0]][i[1]]),this.lightMap(i[0],i[1],o),t.next=10,this.engine.dispatch(this.engine.actions.game.world.setM({mask:o,curPos:i}));case 10:return t.next=12,this.doSpace();case 12:this.checkDanger()&&this.engine.notify(c?"dangerous to be this far from the village without proper protection":"safer here",e.GameSpace.World);case 13:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),o.useOutpost=function(){this.engine.dispatch(this.engine.actions.game.world.useOutpost()),this.setWater(this.getMaxWater()),this.engine.notify("water replenished")},o.getMaxWater=function(){var e=this.engine.store.getState();return e.stores.water_tank?Mt.World.BASE_WATER+50:e.stores.cask?Mt.World.BASE_WATER+20:e.stores.waterskin?Mt.World.BASE_WATER+10:Mt.World.BASE_WATER},o.generateMap=function(){for(var e=Mt.World.RADIUS,t=new Array(2*e+1),n=0;n<=2*e;n++)t[n]=new Array(2*e+1);t[e][e]=Mt.World.TILE.VILLAGE;for(var r=1;r<=e;r++)for(var a=0;a<8*r;a++){var o,i;a<2*r?(o=e-r+a,i=e-r):a<4*r?(o=e+r,i=e-3*r+a):a<6*r?(o=e+5*r-a,i=e+r):(o=e-r,i=e+7*r-a),t[o][i]=this.chooseTile(o,i,t)}for(var c in Mt.World.LANDMARKS)for(var s=Mt.World.LANDMARKS[c],u=0;u<s.num;u++)this.placeLandmark(s.minRadius,s.maxRadius,c,t);return t},o.chooseTile=function(e,t,n){var r,a=[t>0?n[e][t-1]:null,t<2*Mt.World.RADIUS?n[e][t+1]:null,e<2*Mt.World.RADIUS?n[e+1][t]:null,e>0?n[e-1][t]:null],o={},i=1;for(var c in a){if(a[c]==Mt.World.TILE.VILLAGE)return Mt.World.TILE.FOREST;"string"==typeof a[c]&&(o[a[c]]=(r="number"==typeof(r=o[a[c]])?r:0)+Mt.World.STICKINESS,i-=Mt.World.STICKINESS)}for(var s in Mt.World.TILE){var u=Mt.World.TILE[s];this.isTerrain(u)&&(r="number"==typeof(r=o[u])?r:0,o[u]=r+=Mt.World.TILE_PROBS[u]*i)}var l=[];for(var f in o)l.push(o[f]+""+f);l.sort((function(e,t){var n=parseFloat(e.substring(0,e.length-1));return parseFloat(t.substring(0,t.length-1))-n}));var h=0,d=Math.random();for(var p in l){var m=l[p];if(d<(h+=parseFloat(m.substring(0,m.length-1))))return m.charAt(m.length-1)}return Mt.World.TILE.BARRENS},o.placeLandmark=function(e,t,n,r){for(var a=Mt.World.RADIUS,o=Mt.World.RADIUS;!this.isTerrain(r[a][o]);){var i=Math.floor(Math.random()*(t-e))+e,c=Math.floor(Math.random()*i),s=i-c;Math.random()<.5&&(c=-c),Math.random()<.5&&(s=-s),(a=Mt.World.RADIUS+c)<0&&(a=0),a>2*Mt.World.RADIUS&&(a=2*Mt.World.RADIUS),(o=Mt.World.RADIUS+s)<0&&(o=0),o>2*Mt.World.RADIUS&&(o=2*Mt.World.RADIUS)}return r[a][o]=n,[a,o]},o.isTerrain=function(e){return e==Mt.World.TILE.FOREST||e==Mt.World.TILE.FIELD||e==Mt.World.TILE.BARRENS},o.mapSearch=function(e,t,n){var r=Mt.World.LANDMARKS[e].num;if(!r)return null;r=n?Math.min(n,r):r;var a=0,o=[],i=Mt.World.RADIUS;e:for(var c=0;c<=2*i;c++)for(var s=0;s<=2*i;s++)if(t[c][s].charAt(0)===e&&(o[a]={x:c-i,y:s-i},++a===r))break e;return o},o.compassDir=function(e){var t=e.x<0?"west":"east",n=e.y<0?"north":"south";return Math.abs(e.x)/2>Math.abs(e.y)?t:Math.abs(e.y)/2>Math.abs(e.x)?n:n+t},o.goHome=function(){var t=n(h.mark((function t(){var n;return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=this.engine.getState()).game.world.sulphurmine&&!n.game.buildings.sulphur_mine&&this.engine.dispatch(this.engine.actions.game.buildings.addM({sulphur_mine:1})),n.game.world.ironmine&&!n.game.buildings.iron_mine&&this.engine.dispatch(this.engine.actions.game.buildings.addM({iron_mine:1})),n.game.world.coalmine&&!n.game.buildings.coal_mine&&this.engine.dispatch(this.engine.actions.game.buildings.addM({coal_mine:1})),this.engine.dispatch(this.engine.actions.stores.addM(n.game.world.outfit)),this.engine.travelTo(e.GameSpace.Path);case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o.getFreeSpace=function(){var e=this.engine.getState(),t=0;for(var n in e.game.world.outfit)t+=(e.game.world.outfit[n]||0)*this.engine.spaces.Path.getWeight(n);return this.engine.spaces.Path.getCapacity()-t},o.die=function(){this.engine.getState().game.world.dead||(this.engine.dispatch(this.engine.actions.game.world.setM({dead:!0})),this.engine.notify("the world fades",e.GameSpace.World),this.engine.dispatch(this.engine.actions.path.outfit.empty()),this.engine.travelTo(e.GameSpace.Room))},o.checkFight=function(){var e=this.engine.getState(),t=e.game.world.fightMove+1;if(t>Mt.World.FIGHT_DELAY){var n=Mt.World.FIGHT_CHANCE;n*=e.character.perks.stealthy?.5:1,Math.random()<n&&(t=0,this.engine.events.triggerFight())}this.engine.dispatch(this.engine.actions.game.world.setM({fightMove:t}))},o.narrateMove=function(t,n){var r=null;switch(t){case Mt.World.TILE.FOREST:switch(n){case Mt.World.TILE.FIELD:r="the trees yield to dry grass. the yellowed brush rustles in the wind.";break;case Mt.World.TILE.BARRENS:r="the trees are gone. parched earth and blowing dust are poor replacements."}break;case Mt.World.TILE.FIELD:switch(n){case Mt.World.TILE.FOREST:r="trees loom on the horizon. grasses gradually yield to a forest floor of dry branches and fallen leaves.";break;case Mt.World.TILE.BARRENS:r="the grasses thin. soon, only dust remains."}break;case Mt.World.TILE.BARRENS:switch(n){case Mt.World.TILE.FIELD:r="the barrens break at a sea of dying grass, swaying in the arid breeze.";break;case Mt.World.TILE.FOREST:r="a wall of gnarled trees rises from the dust. their branches twist into a skeletal canopy overhead."}}null!=r&&this.engine.notify(r,e.GameSpace.World)},o.getDistance=function(e,t){return e||(e=this.engine.getState().game.world.curPos),t=t||Mt.World.VILLAGE_POS,Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1])},o.outpostUsed=function(e,t){var n=this.engine.getState().game.world,r=n.curPos;return!0===n.usedOutposts[(e="number"==typeof e?e:r[0])+","+(t="number"==typeof t?t:r[1])]},o.useSupplies=function(){var t=n(h.mark((function t(){var n,r,a,o,i,c,s,u,l,f;return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.engine.getState(),o={foodMove:r=n.game.world.foodMove+1,waterMove:a=n.game.world.waterMove+1},i=Mt.World.MOVES_PER_FOOD,!(r>=(i*=n.character.perks.slow_metabolism?2:1))){t.next=33;break}if(r=0,o.foodMove=0,c=n.game.world.outfit.cured_meat||0,0!=--c){t.next=15;break}this.engine.notify("the meat has run out",e.GameSpace.World),t.next=32;break;case 15:if(!(c<0)){t.next=30;break}if(c=0,n.game.world.starvation){t.next=22;break}this.engine.notify("starvation sets in",e.GameSpace.World),o.starvation=!0,t.next=28;break;case 22:return this.engine.dispatch(this.engine.actions.character.statistics.setM({starved:s=n.character.statistics.starved+1})),s>=10&&!n.character.perks.slow_metabolism&&this.engine.dispatch(this.engine.actions.character.perks.addPerk(e.PerkCategory.slow_metabolism)),this.engine.dispatch(this.engine.actions.game.world.setM(o)),this.die(),t.abrupt("return",!1);case 28:t.next=32;break;case 30:o.starvation=!1,o.health=Math.min(n.game.world.health+this.meatHeal(),this.getMaxHealth());case 32:o["outfit.cured_meat"]=c;case 33:if(u=Mt.World.MOVES_PER_WATER,!(a>=(u*=n.character.perks.desert_rat?2:1))){t.next=61;break}if(a=0,o.waterMove=0,l=n.game.world.water,0!=--l){t.next=44;break}this.engine.notify("there is no more water",e.GameSpace.World),t.next=60;break;case 44:if(!(l<0)){t.next=59;break}if(l=0,n.game.world.thirst){t.next=51;break}this.engine.notify("the thirst becomes unbearable",e.GameSpace.World),o.thirst=!0,t.next=57;break;case 51:return this.engine.dispatch(this.engine.actions.character.statistics.setM({dehydrated:f=n.character.statistics.dehydrated+1})),f>=10&&!n.character.perks.desert_rat&&this.engine.dispatch(this.engine.actions.character.perks.addPerk(e.PerkCategory.desert_rat)),this.engine.dispatch(this.engine.actions.game.world.setM(o)),this.die(),t.abrupt("return",!1);case 57:t.next=60;break;case 59:o.thirst=!1;case 60:o.water=l;case 61:return t.next=63,this.engine.dispatch(this.engine.actions.game.world.setM(o));case 63:return t.abrupt("return",!0);case 64:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o.meatHeal=function(){var e=this.engine.getState();return Mt.World.MEAT_HEAL*(e.character.perks.gastronome?2:1)},o.medsHeal=function(){return Mt.World.MEDS_HEAL},o.checkDanger=function(){var e=this.engine.getState();if(e.game.world.danger){if(this.getDistance()<8)return this.engine.dispatch(this.engine.actions.game.world.setM({danger:!1})),!0;if(this.getDistance()<18&&(e.stores.i_armour||0)>0)return this.engine.dispatch(this.engine.actions.game.world.setM({danger:!1})),!0}else{if(!e.stores.i_armour&&this.getDistance()>=8)return this.engine.dispatch(this.engine.actions.game.world.setM({danger:!0})),!0;if(!e.stores.s_armour&&this.getDistance()>=18)return this.engine.dispatch(this.engine.actions.game.world.setM({danger:!0})),!0}return!1},o.doSpace=function(){var e=n(h.mark((function e(){var t,n,r,a;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.engine.getState().game.world,(r=t.map[(n=t.curPos)[0]][n[1]])!==Mt.World.TILE.VILLAGE){e.next=6;break}this.goHome(),e.next=14;break;case 6:if(void 0===Mt.World.LANDMARKS[r]){e.next=10;break}r===Mt.World.TILE.OUTPOST&&this.outpostUsed()||(a=this.engine.events.eventPool.World.find((function(e){return e.id===Mt.World.LANDMARKS[r].scene})))&&this.engine.events.startEvent(a),e.next=14;break;case 10:return e.next=12,this.useSupplies();case 12:e.sent&&this.checkFight();case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r}(Rr);function Fr(e){return"weapon"==e||"upgrade"==e||"tool"==e}jr.add({id:"Room.lightFire",name:"light fire",isAvailable:function(t){var n=t.getState();return!n.engine.activeSubSpace&&n.engine.activeSpace===e.GameSpace.Room&&n.game.fire.status.value===Mt.Room.FireStatus.Dead.value},exec:function(){var t=n(h.mark((function t(n){var r,a,o,i;return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.spaces.Room,a=n.getState(),i=a.game.fire.status,void 0===(o=a.stores.wood)){t.next=17;break}if(!((o=o||0)<5)){t.next=12;break}return n.notify("not enough wood to get the fire going",e.GameSpace.Room),n.operationExecutor.clearCooldown("Room.lightFire"),t.abrupt("return",i);case 12:if(!(o>4)){t.next=15;break}return t.next=15,n.dispatch(n.actions.stores.addM({wood:-5}));case 15:t.next=21;break;case 17:return t.next=19,n.dispatch(n.actions.stores.addM({wood:5}));case 19:return t.next=21,n.operationExecutor.cooldown("Room.stokeFire");case 21:return i=Mt.Room.FireStatus.Burning,t.next=24,n.dispatch(n.actions.game.fire.changeFire(i));case 24:return r.onFireChange(i),t.abrupt("return",i);case 26:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),cooldown:function(){return Mt.Room.STOKE_COOLDOWN},meta:{space:e.GameSpace.Room,cost:(Tr={},Tr[e.StoreCategory.wood]=5,Tr)}}),jr.add({id:"Room.stokeFire",name:"stoke fire",isAvailable:function(t){var n=t.getState();return!n.engine.activeSubSpace&&n.engine.activeSpace===e.GameSpace.Room&&n.game.fire.status.value!==Mt.Room.FireStatus.Dead.value},exec:function(){var t=n(h.mark((function t(n){var r,a,o,i;return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.getState(),a=n.spaces.Room,o=r.game.fire.status,r.stores.wood){t.next=8;break}return n.notify("the wood has run out",e.GameSpace.Room),n.operationExecutor.clearCooldown("Room.stokeFire"),t.abrupt("return",o);case 8:return t.next=10,n.dispatch(n.actions.stores.addM({wood:-1}));case 10:if(!(o.value<Mt.Room.FireStatus.Roaring.value)){t.next=16;break}if(!(i=At.findKey(Mt.Room.FireStatus,(function(e){return e.value===o.value+1})))){t.next=16;break}return o=Mt.Room.FireStatus[i],t.next=16,n.dispatch(n.actions.game.fire.changeFire(o));case 16:return a.onFireChange(o),t.abrupt("return",o);case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),cooldown:function(){return Mt.Room.STOKE_COOLDOWN},meta:{space:e.GameSpace.Room,cost:(Nr={},Nr[e.StoreCategory.wood]=1,Nr)}}),jr.add({id:"Room.stores",name:"warehouse",isAvailable:function(t){var n=t.getState();return!n.engine.activeSubSpace&&n.engine.activeSpace===e.GameSpace.Room&&void 0!==n.stores.wood},exec:function(){var e=n(h.mark((function e(t){var n,r,a,o,i,c,s;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.getState(),r=Object.keys(n.stores),a=[],o=0,i=r.length;o<i;o++)(s=n.stores[c=r[o]])&&Mt.items[c]&&"building"!==Mt.items[c].type&&a.push({name:c,count:s,info:Mt.items[c]});return e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),meta:{space:e.GameSpace.Room}}),jr.add({id:"Room.trading_post",name:"trading post",isAvailable:function(t){var n=t.getState();return!n.engine.activeSubSpace&&n.engine.activeSpace===e.GameSpace.Room&&!!n.game.buildings.trading_post},meta:{space:e.GameSpace.Room},exec:function(){var e=n(h.mark((function e(t,n){return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.travelToSubSpace(n.name);case 2:return e.abrupt("return",n.name);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),jr.add({id:"Room.workshop",name:"workshop",isAvailable:function(t){var n=t.getState();return!n.engine.activeSubSpace&&n.engine.activeSpace===e.GameSpace.Room&&!!n.game.buildings.workshop},meta:{space:e.GameSpace.Room},exec:function(){var e=n(h.mark((function e(t,n){return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.travelToSubSpace(n.name);case 2:return e.abrupt("return",n.name);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),Object.keys(e.TradeCategory).forEach((function(t){jr.add({id:"Room.buy."+t,name:t,isAvailable:function(e,t){return"trading post"===e.getState().engine.activeSubSpace&&e.spaces.Room.buyUnlocked(t.meta.thing)},meta:{thing:t,space:e.GameSpace.Room,group:"buy"},exec:function(){var t=n(h.mark((function t(n,r){var a,o,i,c,s,u,l,f,d;return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=r.meta.thing,i=n.getState(),(s=i.stores[o]||0)<0&&(s=0),(c=Mt.items[o]).trade){t.next=7;break}return t.abrupt("return",!1);case 7:if(!(c.trade.maximum&&c.trade.maximum<s)){t.next=10;break}return n.notify("can't buy any more of "+c.name,e.GameSpace.Room),t.abrupt("return",!1);case 10:u={},l=c.trade.cost(),t.t0=h.keys(l);case 13:if((t.t1=t.t0()).done){t.next=24;break}if(!((d=i.stores[f=t.t1.value]||0)<l[f])){t.next=21;break}return n.notify("not enough "+f+", need "+l[f]+", stock "+d,e.GameSpace.Room),t.abrupt("return",!1);case 21:u[f]=d-l[f];case 22:t.next=13;break;case 24:return t.next=26,n.dispatch(n.actions.stores.addM(u));case 26:return t.next=28,t.sent;case 28:return c.trade.tradeMsg&&n.notify(c.trade.tradeMsg),t.next=31,n.dispatch(n.actions.stores.addM(((a={})[o]=1,a)));case 31:return n.notify("bought "+o,e.GameSpace.Room),t.abrupt("return",!0);case 33:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()})})),Object.keys(e.CraftableCategory).forEach((function(t){var r=Fr(Mt.items[t].craft.type)?"craft":"build";jr.add({id:"Room."+r+"."+t,name:t,isAvailable:function(t,n){var r=t.getState(),a=n.meta.thing;return"craft"===n.meta.group?"workshop"===r.engine.activeSubSpace&&r.engine.activeSpace===e.GameSpace.Room&&t.spaces.Room.craftUnlocked(a):!r.engine.activeSubSpace&&r.engine.activeSpace===e.GameSpace.Room&&t.spaces.Room.craftUnlocked(a)},meta:{thing:t,space:e.GameSpace.Room,group:r},exec:function(){var t=n(h.mark((function t(n,r){var a,o,i,c,s,u,l,f,d,p,m,g;return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=r.meta.thing,!((s=n.getState()).game.temperature.status.value<=Mt.Room.TemperatureStatus.Cold.value)){t.next=5;break}return n.notify("builder just shivers",e.GameSpace.Room),t.abrupt("return",!1);case 5:if((u=Mt.items[c]).craft){t.next=8;break}return t.abrupt("return",!1);case 8:l=0,t.t0=u.type,t.next="good"===t.t0||"weapon"===t.t0||"tool"===t.t0||"upgrade"===t.t0?12:"building"===t.t0?14:16;break;case 12:return l=s.stores[c]||0,t.abrupt("break",16);case 14:return l=s.game.buildings[c]||0,t.abrupt("break",16);case 16:if(l<0&&(l=0),!(u.craft.maximum&&u.craft.maximum<=l)){t.next=20;break}return n.notify("can't build any more of "+u.name,e.GameSpace.Room),t.abrupt("return",!1);case 20:f={},d=u.craft.cost(s),t.t1=h.keys(d);case 23:if((t.t2=t.t1()).done){t.next=34;break}if(!((m=s.stores[p=t.t2.value]||0)<d[p])){t.next=31;break}return n.notify("not enough "+p+", need "+d[p]+", stock "+m,e.GameSpace.Room),t.abrupt("return",!1);case 31:f[p]=m-d[p];case 32:t.next=23;break;case 34:return t.next=36,n.setToStore(f);case 36:u.craft.buildMsg&&n.notify(null==(g=u.craft)?void 0:g.buildMsg,e.GameSpace.Room),t.t3=null==(a=u.craft)?void 0:a.type,t.next="good"===t.t3||"weapon"===t.t3||"upgrade"===t.t3||"tool"===t.t3?40:"building"===t.t3?43:46;break;case 40:return t.next=42,n.addToStore(((o={})[c]=1,o));case 42:return t.abrupt("break",46);case 43:return t.next=45,n.dispatch(n.actions.game.buildings.addM(((i={})[c]=1,i)));case 45:return t.abrupt("break",46);case 46:return t.abrupt("return",!0);case 47:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()})}));var Gr=function(t){function n(e){var n;(n=t.call(this,e)||this)._fireTimer=null,n._tempTimer=null,n._builderTimer=null;var r=e.getState();r.features.location.Room||(e.dispatch(e.actions.features.location.enableRoom()),e.dispatch(e.actions.game.builder.setM({level:-1}))),n._fireTimer=e.setTimeout(n.coolFire.bind(o(n)),Mt.Room.FIRE_COOL_DELAY),n._tempTimer=e.setTimeout(n.adjustTemp.bind(o(n)),Mt.Room.ROOM_WARM_DELAY);var a=r.game.builder.level;return a>=0&&a<3&&(n._builderTimer=e.setTimeout(n.updateBuilderState.bind(o(n)),Mt.Room.BUILDER_STATE_DELAY)),1==a&&void 0===r.stores.wood&&n.engine.setTimeout(n.unlockForest.bind(o(n)),Mt.Room.NEED_WOOD_DELAY),n.engine.observer((function(e){return{wood:e.stores.wood,meat:e.stores.meat,fur:e.stores.fur,thieves:e.game.thieves,enableWorld:e.features.location.World}}),(function(e){!e.thieves&&e.enableWorld&&((e.wood||0)>5e3||(e.meat||0)>5e3||(e.fur||0)>5e3)&&n.startThieves()})),n}a(n,t);var r=n.prototype;return r.coolFire=function(){var t=this.engine.getState(),n=t.game.fire.status;n.value<=Mt.Room.FireStatus.Flickering.value&&t.game.builder.level>3&&t.stores.wood&&(this.engine.notify("builder stokes the fire",e.GameSpace.Room,!0),this.engine.dispatch(this.engine.actions.stores.addM({wood:-1})),n=Mt.Room.FireStatus[At.findKey(Mt.Room.FireStatus,(function(e){return e.value===n.value+1}))]),n.value>0&&(n=Mt.Room.FireStatus[At.findKey(Mt.Room.FireStatus,(function(e){return e.value===n.value-1}))],this.engine.dispatch(this.engine.actions.game.fire.changeFire(n)),this.onFireChange(n))},r.onArrival=function(){var t=this.engine.getState();t.room.changed&&(this.engine.notify("the fire is "+t.game.fire.status.text),this.engine.notify("the room is "+t.game.temperature.status.text),this.engine.dispatch(this.engine.actions.room.setChanged(!1))),3===t.game.builder.level&&(this.engine.dispatch(this.engine.actions.game.builder.addM({level:1})),this.engine.setIncome("builder",{delay:10,stores:{wood:2}}),this.engine.notify("the stranger is standing by the fire. she says she can help. says she builds things.",e.GameSpace.Room))},r.canTrade=function(t){var n=this.engine.getState();return!!n.room.crafts[t]||n.game.buildings.trading_post>0&&(t===e.StoreCategory.compass||void 0!==n.stores[t])},r.buyUnlocked=function(t){var n=this.engine.getState();return!!n.room.buys[t]||!(!n.game.buildings.trading_post||t!==e.StoreCategory.compass&&void 0===n.stores[t])},r.clean=function(){clearTimeout(this._fireTimer),clearTimeout(this._tempTimer),clearTimeout(this._builderTimer),t.prototype.clean.call(this)},r.craftUnlocked=function(t){var n=this.engine.getState();if(n.room.crafts[t])return!0;if(n.game.builder.level<4)return!1;var r=Mt.items[t];if(!r.craft)return!1;if(Fr(r.type)&&0===n.game.buildings.workshop)return!1;var a=r.craft.cost(n);if(n.game.buildings[t]>0)return this.engine.dispatch(this.engine.actions.room.addCraft({name:t})),!0;if(a.wood&&(n.stores.wood||0)<.5*a.wood)return!1;for(var o in a)if(!n.stores[o])return!1;return this.engine.dispatch(this.engine.actions.room.addCraft({name:t})),r.craft.availableMsg&&!n.game.buildings[t]&&this.engine.notify(r.craft.availableMsg,e.GameSpace.Room),!0},r.adjustTemp=function(){var t=this.engine.getState(),n=t.game.temperature.status,r=n,a=t.game.fire.status;n.value>0&&n.value>a.value&&(r=Mt.Room.TemperatureStatus[At.findKey(Mt.Room.TemperatureStatus,(function(e){return e.value===r.value-1}))],this.engine.notify("the room is "+r.text,e.GameSpace.Room,!0)),r.value<4&&r.value<a.value&&(r=Mt.Room.TemperatureStatus[At.findKey(Mt.Room.TemperatureStatus,(function(e){return e.value===r.value+1}))],this.engine.notify("the room is "+r.text,e.GameSpace.Room,!0)),r.value!=n.value&&(this.engine.dispatch(this.engine.actions.room.setChanged(!0)),this.engine.dispatch(this.engine.actions.game.temperature.change(r))),this._tempTimer=this.engine.setTimeout(this.adjustTemp.bind(this),Mt.Room.ROOM_WARM_DELAY)},r.onFireChange=function(t){var n=this.engine.getState();n.engine.activeSpace!==e.GameSpace.Room&&this.engine.dispatch(this.engine.actions.room.setChanged(!0)),this.engine.notify("the fire is "+t.text,e.GameSpace.Room,!0),t.value>Mt.Room.FireStatus.Smoldering.value&&n.game.builder.level<0&&(this.engine.dispatch(this.engine.actions.game.builder.setM({level:0})),this.engine.notify("the light from the fire spills from the windows, out into the dark",e.GameSpace.Room),this.engine.setTimeout(this.updateBuilderState.bind(this),Mt.Room.BUILDER_STATE_DELAY)),clearTimeout(this._fireTimer),this._fireTimer=this.engine.setTimeout(this.coolFire.bind(this),Mt.Room.FIRE_COOL_DELAY)},r.updateBuilderState=function(){if(this.engine){var t=this.engine.getState(),n=t.game.builder.level;if(0===n)this.engine.notify("a ragged stranger stumbles through the door and collapses in the corner",e.GameSpace.Room),n=1,this.engine.dispatch(this.engine.actions.game.builder.setM({level:1})),this.engine.setTimeout(this.unlockForest.bind(this),Mt.Room.NEED_WOOD_DELAY);else if(n<3&&t.game.temperature.status.value>=Mt.Room.TemperatureStatus.Warm.value){var r="";switch(n){case 1:r="the stranger shivers, and mumbles quietly. her words are unintelligible.";break;case 2:r="the stranger in the corner stops shivering. her breathing calms."}this.engine.notify(r,e.GameSpace.Room),n<3&&this.engine.dispatch(this.engine.actions.game.builder.setM({level:n+=1}))}n<3&&this.engine.setTimeout(this.updateBuilderState.bind(this),Mt.Room.BUILDER_STATE_DELAY)}},r.unlockForest=function(){this.engine.dispatch(this.engine.actions.stores.setM({wood:4})),this.engine.dispatch(this.engine.actions.features.location.enableOutside()),this.engine.notify("the wind howls outside",e.GameSpace.Room),this.engine.notify("the wood is running out",e.GameSpace.Room)},r.startThieves=function(){this.engine.dispatch(this.engine.actions.game.thieves.change(1)),this.engine.setIncome("thieves",{delay:10,stores:{wood:-10,fur:-5,meat:-5}})},n}(Rr);jr.add({id:"Path.perks",name:"perks",isAvailable:function(t){var n=t.getState();if(n.engine.activeSubSpace||n.engine.activeSpace!==e.GameSpace.Path)return!1;var r=!1;for(var a in n.character.perks)if(n.character.perks[a]){r=!0;break}return r},exec:function(){var e=n(h.mark((function e(t){var n,r,a;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in n=t.getState(),r=[],n.character.perks)n.character.perks[a]&&r.push({name:a,desc:y[a].desc});return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),meta:{space:e.GameSpace.Path}}),jr.add({id:"Path.embark",name:"embark",cooldown:function(){return Mt.World.DEATH_COOLDOWN},isAvailable:function(t){return t.getState().engine.activeSpace===e.GameSpace.Path},meta:{space:e.GameSpace.Path},exec:function(){var t=n(h.mark((function t(n){var r,a,o,i,c,s;return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i in r=n.getState(),a=r.path.outfit,o={},r)o[i]=-1*(a[i]||0);return t.next=6,n.dispatch(n.actions.stores.addM(o));case 6:for(s in c={},a)a[s]&&(c[s]=a[s]);return t.next=10,n.dispatch(n.actions.game.world.setM({outfit:At.cloneDeep(c)}));case 10:return t.next=12,n.travelTo(e.GameSpace.World);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()});var Vr,Ur,Br=function(t){function r(e){var n;return(n=t.call(this,e)||this).engine.observer((function(e){return{compass:e.stores.compass,pathEnable:e.features.location.Path}}),(function(e){e.compass&&!e.pathEnable&&n.openPath()})),n}a(r,t);var o=r.prototype;return o.onArrival=function(){this.updateOutfitting()},o.openPath=function(){var e=n(h.mark((function e(){var t;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.engine.getState(),e.next=3,this.engine.dispatch(this.engine.actions.features.location.enablePath());case 3:this.engine.notify("the compass points "+t.game.world.dir);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.getWeight=function(e){var t=Mt.Path.Weight[e];return"number"!=typeof t&&(t=1),t},o.getCapacity=function(){var e=this.engine.getState();return e.stores.convoy?Mt.Path.DEFAULT_BAG_SPACE+60:e.stores.wagon?Mt.Path.DEFAULT_BAG_SPACE+30:e.stores.rucksack?Mt.Path.DEFAULT_BAG_SPACE+10:Mt.Path.DEFAULT_BAG_SPACE},o.getFreeSpace=function(){var e=this.engine.getState(),t=0;for(var n in e.path.outfit)t+=(e.path.outfit[n]||0)*this.getWeight(n);return this.getCapacity()-t},o.updateOutfitting=function(){var t=this.engine.getState(),n=Object.keys(mt).concat(Object.keys(e.CraftableCategory)),r=!1,a={};for(var o in n){var i=t.stores[o]||0,c=t.path.outfit[o]||0;i<(c="number"==typeof c?c:0)&&(r=!0,a[o]=c=i)}r&&this.engine.dispatch(this.engine.actions.path.outfit.setM(a))},o.increaseSupply=function(){var e=n(h.mark((function e(t,n){var r,a,o,i,c,s,u,l;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.engine.getState(),a=r.path.outfit[t]||0,o=this.getFreeSpace(),i=this.getWeight(t),c=r.stores[t]||0,s=0,!(o>=i&&a<c)){e.next=14;break}if(u=Math.floor(o/i),!(s=Math.min(n,u,c-a))){e.next=14;break}return e.next=13,this.engine.dispatch(this.engine.actions.path.outfit.addM(((l={})[t]=s,l)));case 13:this.updateOutfitting();case 14:return e.abrupt("return",a+s);case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),o.decreaseSupply=function(){var e=n(h.mark((function e(t,n){var r,a,o,i;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.engine.getState(),!(a=r.path.outfit[t]||0)){e.next=8;break}if(o=Math.max(0,a-n),a===o){e.next=8;break}return e.next=7,this.engine.dispatch(this.engine.actions.path.outfit.setM(((i={})[t]=o,i)));case 7:this.updateOutfitting();case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),r}(Rr);jr.add({id:"Ship.reinforceHull",name:"reinforce hull",cooldown:function(){return Mt.Ship.ALLOY_PER_HULL},isAvailable:function(t){return t.getState().engine.activeSpace===e.GameSpace.Ship},meta:{space:e.GameSpace.Ship,cost:(Vr={},Vr[e.StoreCategory.alien_alloy]=Mt.Ship.ALLOY_PER_HULL,Vr)},exec:function(){var t=n(h.mark((function t(n){return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((n.getState().stores.alien_alloy||0)<Mt.Ship.ALLOY_PER_HULL)){t.next=4;break}return n.notify("not enough alien alloy",e.GameSpace.Ship),t.abrupt("return",!1);case 4:return t.next=6,n.dispatch(n.actions.stores.addM({alien_alloy:-1*Mt.Ship.ALLOY_PER_HULL}));case 6:return t.next=8,n.dispatch(n.actions.game.spaceShip.addM({hull:1}));case 8:return t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}),jr.add({id:"Ship.upgradeEngine",name:"upgrade engine",cooldown:function(){return Mt.Ship.ALLOY_PER_THRUSTER},isAvailable:function(t){return t.getState().engine.activeSpace===e.GameSpace.Ship},meta:{space:e.GameSpace.Ship,cost:(Ur={},Ur[e.StoreCategory.alien_alloy]=Mt.Ship.ALLOY_PER_THRUSTER,Ur)},exec:function(){var t=n(h.mark((function t(n){return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((n.getState().stores.alien_alloy||0)<Mt.Ship.ALLOY_PER_THRUSTER)){t.next=4;break}return n.notify("not enough alien alloy",e.GameSpace.Ship),t.abrupt("return",!1);case 4:return t.next=6,n.dispatch(n.actions.stores.addM({alien_alloy:-1*Mt.Ship.ALLOY_PER_THRUSTER}));case 6:return t.next=8,n.dispatch(n.actions.game.spaceShip.addM({thrusters:1}));case 8:return t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}),jr.add({id:"Ship.checkLiftOff",name:"lift off",cooldown:function(){return 0},isAvailable:function(t){return t.getState().engine.activeSpace===e.GameSpace.Ship},meta:{space:e.GameSpace.Ship},exec:function(){var e=n(h.mark((function e(t){var n;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={title:"Ready to Leave?",id:"ship_check_lift_off",scenes:{start:{text:["time to get out of this place. won't be coming back."],buttons:{fly:{text:"lift off",onChoose:function(e){e.dispatch(e.actions.game.spaceShip.setM({seenWarning:!0}));var t=e.prestige.calculateScore();e.notify("game end"),e.notify("score for this game: "+t),e.notify("https://adarkroom.doublespeakgames.com"),e.spaces.Ship.liftOff()},nextScene:"end"},wait:{text:"linger",onChoose:function(){},nextScene:"end"}}}}},t.events.addEvent("Ship",n),t.events.startEvent(n);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});var Hr,zr=function(t){function n(e){return t.call(this,e)||this}a(n,t);var r=n.prototype;return r.onArrival=function(){this.engine.getState().game.spaceShip.seenShip||(this.engine.notify("somewhere above the debris cloud, the wanderer fleet hovers. been on this rock too long.",e.GameSpace.Ship),this.engine.dispatch(this.engine.actions.game.spaceShip.setM({seenShip:!0})))},r.getMaxHull=function(){return this.engine.getState().game.spaceShip.hull||0},r.liftOff=function(){this.engine.travelTo(e.GameSpace.Space)},n}(Rr),$r=function(e){function t(t){return e.call(this,t)||this}return a(t,e),t.prototype.onArrival=function(){this.engine.endGame()},t}(Rr);jr.add({id:"Outside.checkTraps",name:"check traps",isAvailable:function(t){return t.getState().engine.activeSpace===e.GameSpace.Outside},cooldown:function(){return Mt.Outside.TRAPS_DELAY},exec:function(){var t=n(h.mark((function t(n){var r,a,o,i,c,s,u,l,f,d,p,m,g;return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.getState(),a={},o=[],i=r.game.buildings.trap||0){t.next=9;break}return n.notify("not enough trap"),t.next=8,n.operationExecutor.clearCooldown("Outside.checkTraps");case 8:return t.abrupt("return");case 9:s=i+((c=r.stores.bait||0)<i?c:i),u=0;case 12:if(!(u<s)){t.next=28;break}l=Math.random(),t.t0=h.keys(Mt.Outside.TrapDrops);case 15:if((t.t1=t.t0()).done){t.next=25;break}if(!(l<(f=Mt.Outside.TrapDrops[t.t1.value]).rollUnder)){t.next=23;break}return void 0===(d=a[f.name])&&(d=0,o.push(f.message)),a[f.name]=d+1,t.abrupt("break",25);case 23:t.next=15;break;case 25:u++,t.next=12;break;case 28:for(p="the traps contain ",m=0,g=o.length;m<g;m++)g>1&&m>0&&m<g-1?p+=", ":g>1&&m==g-1&&(p+=" and "),p+=o[m];return a.bait=-(c<i?c:i),n.notify(p,e.GameSpace.Outside),t.next=35,n.dispatch(n.actions.stores.addM(a));case 35:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),meta:{buildings:(Hr={},Hr[e.Building.trap]=1,Hr),space:e.GameSpace.Outside}}),jr.add({id:"Outside.gatherWood",name:"gather wood",isAvailable:function(t){return t.getState().engine.activeSpace===e.GameSpace.Outside},cooldown:function(){return Mt.Outside.GATHER_DELAY},exec:function(){var t=n(h.mark((function t(n){var r,a;return h.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.notify("dry brush and dead branches litter the forest floor",e.GameSpace.Outside),r=n.getState(),a=r.game.buildings.cart?50:10,t.next=5,n.dispatch(n.actions.stores.addM({wood:a}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),meta:{space:e.GameSpace.Outside}}),jr.add({id:"Outside.building",name:"Buildings",isAvailable:function(t){var n=t.getState();if(n.engine.activeSpace!==e.GameSpace.Outside)return!1;for(var r=!1,a=Object.keys(n.stores),o=0,i=a.length;o<i;o++){var c=a[o];if(n.stores[c]&&Mt.items[c]&&"building"===Mt.items[c].type){r=!0;break}}return r},exec:function(){var e=n(h.mark((function e(t){var n,r,a,o,i,c,s;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.getState(),r=Object.keys(n.stores),a=[],o=0,i=r.length;o<i;o++)(s=n.stores[c=r[o]])&&Mt.items[c]&&"building"===Mt.items[c].type&&a.push({name:c,count:s,info:Mt.items[c]});return e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),meta:{space:e.GameSpace.Outside}});var qr=function(t){function r(e){var n;return(n=t.call(this,e)||this)._popTimeout=null,n.unsubBuilding=function(){},n.updateVillageIncome(),n.schedulePopIncrease(),n.unsubBuilding=e.observer((function(e){return e.game.buildings}),(function(){n.enableBuildingWorker()})),n}a(r,t);var o=r.prototype;return o.onArrival=function(){this.engine.getState().game.outside.seenForest||(this.engine.notify("the sky is grey and the wind blows relentlessly",e.GameSpace.Outside),this.engine.dispatch(this.engine.actions.game.outside.setM({seenForest:!0})))},o.increaseWorker=function(e,t){var n=this.getNumGatherers();if(n>0){var r,a=Math.min(n,t);fr("increasing "+e+" by "+a),this.engine.dispatch(this.engine.actions.game.workers.addM(((r={})[e]=a,r)))}},o.getTitle=function(){var e=this.engine.getState().game.buildings.hut||0;return 0===e?"A Silent Forest":1==e?"A Lonely Hut":e<=4?"A Tiny Village":e<=8?"A Modest Village":e<=14?"A Large Village":"A Raucous Village"},o.decreaseWorker=function(e,t){var n=this.engine.getState().game.workers[e]||0;if(n>0){var r,a=Math.min(n,t);fr("decreasing "+e+" by "+a),this.engine.dispatch(this.engine.actions.game.workers.addM(((r={})[e]=-1*a,r)))}},o.clean=function(){clearTimeout(this._popTimeout),this.unsubBuilding(),t.prototype.clean.call(this)},o.destroyHuts=function(){var e=n(h.mark((function e(t,n){var r,a,o,i,c,s,u,l,f,d,p;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.engine.getState(),a=0,i=o=r.game.buildings.hut,c=0;case 5:if(!(c<t)){e.next=20;break}if(u=(s=r.game.population.value)/Mt.Outside.HUT_ROOM,l=Math.floor(u),f=n?i:Math.ceil(u)){e.next=12;break}return e.abrupt("break",20);case 12:d=Math.floor(Math.random()*f)+1,p=0,d<=l?p=Mt.Outside.HUT_ROOM:d===l+1&&(p=s%Mt.Outside.HUT_ROOM),i--,p&&(a+=p);case 17:c++,e.next=5;break;case 20:if(!a){e.next=23;break}return e.next=23,this.killVillagers(a);case 23:if(i===o){e.next=26;break}return e.next=26,this.engine.dispatch(this.engine.actions.game.buildings.setM({hut:i}));case 26:return e.abrupt("return",{dead:a,destroyHut:i-o});case 27:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),o.killVillagers=function(){var e=n(h.mark((function e(t){var n,r,a,o,i,c,s,u;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.engine.getState(),(a=(r=n.game.population.value)- -1*t)<0&&(a=0),a===r){e.next=7;break}return e.next=7,this.engine.dispatch(this.engine.actions.game.population.setM({value:a}));case 7:if(o=this.getNumGatherers(),i={},!(o<0)){e.next=25;break}c=-o,e.t0=h.keys(n.game.workers);case 12:if((e.t1=e.t0()).done){e.next=24;break}if(!((u=At.get(n.game.workers,s=e.t1.value,0))<c)){e.next=20;break}c-=u,i[s]=0,e.next=22;break;case 20:return i[s]=u+-1*c,e.abrupt("break",24);case 22:e.next=12;break;case 24:At.isPlainObject(i)||this.engine.dispatch(this.engine.actions.game.workers.setM(i));case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o.getNumGatherers=function(){var e=this.engine.getState(),t=e.game.population.value;for(var n in e.game.workers)t-=At.get(e.game.workers,n,0);return t},o.getMaxPopulation=function(){return(this.engine.getState().game.buildings.hut||0)*Mt.Outside.HUT_ROOM},o.schedulePopIncrease=function(){var e=Math.floor(Math.random()*(Mt.Outside.POP_DELAY[1]-Mt.Outside.POP_DELAY[0]))+Mt.Outside.POP_DELAY[0];fr("next population increase scheduled in "+e+" minutes"),this._popTimeout=this.engine.setTimeout(this.increasePopulation.bind(this),60*e*1e3)},o.increasePopulation=function(){var e=this.engine.getState();if(e.features.location.Outside){var t=this.getMaxPopulation()-e.game.population.value;if(t>0){var n=Math.floor(Math.random()*(t/2)+t/2);0===n&&(n=1),this.engine.notify(1==n?"a stranger arrives in the night":n<5?"a weathered family takes up in one of the huts.":n<10?"a small group arrives, all dust and bones.":n<30?"a convoy lurches in, equal parts worry and hope.":"the town's booming. word does get around."),fr("population increased by "+n),this.engine.dispatch(this.engine.actions.game.population.addM({value:n}))}}this.schedulePopIncrease()},o.enableBuildingWorker=function(){var e=this.engine.getState(),t={lodge:["hunter","trapper"],tannery:["tanner"],smokehouse:["charcutier"],"iron mine":["iron miner"],"coal mine":["coal miner"],"sulphur mine":["sulphur miner"],steelworks:["steelworker"],armoury:["armourer"]},n=!1;for(var r in e.game.buildings)if("trap"!==r){var a=t[r];if(a)for(var o=0,i=a.length;o<i;o++){var c,s=a[o];void 0!==e.game.buildings[r]&&void 0===e.game.workers[s]&&(this.engine.dispatch(this.engine.actions.game.workers.setM(((c={})[s]=0,c))),n=!0)}}return n},o.updateVillageIncome=function(){var e=this.engine.getState();for(var t in Mt.Outside.INCOME){var n=Mt.Outside.INCOME[t],r="gatherer"==t?this.getNumGatherers():e.game.workers[t]||0;if("number"==typeof r){var a={};r<0&&(r=0);var o=!1,i=this.engine.getIncome(t);for(var c in n.stores)a[c]=(n.stores[c]||0)*r,i[c]!==a[c]&&(o=!0);o&&this.engine.setIncome(t,{delay:n.delay,stores:a})}}},r}(Rr),Yr=function(e){function t(t){return e.call(this,t)||this}a(t,e);var n=t.prototype;return n.collectStores=function(){var e,t,n,r=(null==(e=this.engine.store)?void 0:e.getState()).previous.stores;if(r&&r.length>0){var a,o,i={};for(var c in Mt.Prestige.storesMap)i[Mt.Prestige.storesMap[c].store.toString()]=r[c];null==(a=this.engine)||null==(o=a.store)||o.dispatch(this.engine.actions.stores.addM(i))}null==(t=this.engine)||null==(n=t.store)||n.dispatch(this.engine.actions.previous.setM({stores:[]}))},n.save=function(){var e,t=this.getStores(!0),n=this.totalScore();null==(e=this.engine.store)||e.dispatch(this.engine.actions.previous.setM({stores:t,score:n}))},n.totalScore=function(){var e,t=null==(e=this.engine.store)?void 0:e.getState();return((null==t?void 0:t.previous.score)||0)+this.calculateScore()},n.calculateScore=function(){for(var e,t=null==(e=this.engine.store)?void 0:e.getState(),n=this.getStores(!1),r=0,a=[1,1.5,1,2,2,3,3,2,2,2,2,1.5,1,1,10,30,50,100,150,150,3,3,5,4],o=0;o<a.length;o++)r+=n[o]*a[o];return r+=10*((null==t?void 0:t.stores.alien_alloy)||0),r+=50*t.game.spaceShip.hull,Math.floor(r)},n.getStores=function(e){var t=this.engine.store.getState(),n=[];for(var r in Mt.Prestige.storesMap){var a=Mt.Prestige.storesMap[r];n.push(Math.floor((t.stores[a.store]||0)/(e?this.randGen(a.type):1)))}return n},n.randGen=function(e){var t;switch(e){case"g":t=Math.floor(10*Math.random());break;case"w":t=Math.floor(Math.floor(10*Math.random())/2);break;case"a":t=Math.ceil(10*Math.random()*Math.ceil(10*Math.random()));break;default:return 1}return 0!==t?t:1},t}(Rr);jr.add({id:"Engine.travelTo",name:"travel to",isAvailable:function(t){var n=t.getState(),r=0;return Object.keys(n.features.location).forEach((function(e){n.features.location[e]&&r++})),!n.engine.activeSubSpace&&r>1&&n.engine.activeSpace!==e.GameSpace.World&&n.engine.activeSpace!==e.GameSpace.Space},exec:function(){var e=n(h.mark((function e(t,n,r){return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.travelTo(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),help:function(e){var t=e.getState(),n=[];return Object.keys(t.features.location).forEach((function(e){t.features.location[e]&&n.push(e)})),{desc:"travel to "+n.join(", "),parms:[n]}}}),jr.add({id:"Engine.SubSpace.back",name:"Back",isAvailable:function(e){return!!e.getState().engine.activeSubSpace},meta:{},exec:function(){var e=n(h.mark((function e(t){return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.travelToSubSpace("");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});var Kr,Jr=function(){function t(e){this.GAME_OVER=!1,this.options={debug:!1,doubleTime:!1},this.actions=sr,this.paused=!1,this._incomeTimeout=null,Object.assign(this.options,e||{}),function(e){lr=e.enable||!1}({enable:this.options.debug}),this.operationExecutor=new Cr(this,jr),this.startGame(null==e?void 0:e.state)}var r=t.prototype;return r.notify=function(e,t,n){var r;null==(r=this.store)||r.dispatch(this.actions.notifications.notify({message:{text:e,module:t},noQueue:n}))},r.dispatch=function(){var e=n(h.mark((function e(t){return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.store.dispatch(t);case 2:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.operation=function(){var e=n(h.mark((function e(t,n){return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.operationExecutor.exec(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),r.operations=function(){return this.operationExecutor.availableOperations()},r.startGame=function(t){var n;this.GAME_OVER=!1,this.paused=!1,this.loadGame(t),this.events=new Pr(this),this.spaces=((n={})[e.GameSpace.World]=new Ir(this),n[e.GameSpace.Room]=new Gr(this),n[e.GameSpace.Outside]=new qr(this),n[e.GameSpace.Path]=new Br(this),n[e.GameSpace.Ship]=new zr(this),n[e.GameSpace.Space]=new $r(this),n),this.prestige=new Yr(this),this._incomeTimeout=this.setTimeout(this.collectIncome.bind(this),1e3);var r=this.getState();this.travelTo(null!=r&&r.engine.activeSpace?null==r?void 0:r.engine.activeSpace:e.GameSpace.Room,!0)},r.clean=function(){var e=this;this.events&&(clearTimeout(this._incomeTimeout),this.events.clean(),Object.keys(this.spaces).forEach((function(t){e.spaces[t].clean()})),this.prestige.clean())},r.endGame=function(){this.GAME_OVER||(this.GAME_OVER=!0,this.clean())},r.addToStore=function(e){this.dispatch(this.actions.stores.addM(e))},r.setToStore=function(e){this.dispatch(this.actions.stores.setM(e))},r.observer=function(e,t){var n,r=this.store;function a(){var a=e(r.getState());At.isEqual(a,n)||t(n=a)}var o=r.subscribe(a);return a(),o},r.getIncome=function(e){var t=this.getState();return At.get(t.income,e,{})},r.setIncome=function(e,t){var n,r=this.getState(),a=At.get(r.income,e);a&&(t.timeLeft=a.timeLeft),this.dispatch(this.actions.income.setM(((n={})[e]=t,n)))},r.pauseGame=function(){this.paused=!0,this.clean()},r.continueGame=function(){var e;this.paused=!1,this.startGame(null==(e=this.store)?void 0:e.getState())},r.saveGame=function(){},r.getActionSpace=function(){var e;return null==(e=this.store)?void 0:e.getState().engine.activeSpace},r.getState=function(){return this.store.getState()},r.switchLanguage=function(){},r.travelTo=function(){var e=n(h.mark((function e(t,n){var r;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.getActionSpace()===t&&!n){e.next=7;break}return e.next=4,this.travelToSubSpace("");case 4:return e.next=6,null==(r=this.store)?void 0:r.dispatch(this.actions.engine.changeSpace(t));case 6:this.spaces[t].onArrival();case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),r.travelToSubSpace=function(){var e=n(h.mark((function e(t){var n;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(n=this.store)?void 0:n.dispatch(this.actions.engine.changeSubSpace(t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.getGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},r.setTimeout=function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n){return this.options.doubleTime&&!n&&(fr("Double time, cutting timeout in half"),t/=2),setTimeout(e,t)})),r.setInterval=function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n){return this.options.doubleTime&&!n&&(fr("Double time, cutting timeout in half"),t/=2),setInterval(e,t)})),r.loadGame=function(e){this.store=function(e,t){return He({reducer:cr,preloadedState:t,middleware:function(t){return t({thunk:{extraArgument:{engine:e}}}).concat(ur)}})}(this,e)},r.collectIncome=function(){var t=!1,n=[],r=At.cloneDeep(this.getState());if(r.engine.activeSpace!==e.GameSpace.Space)for(var a in r.income){var o=r.income[a];if(o&&("number"!=typeof o.timeLeft&&(o.timeLeft=0),o.timeLeft--,o.timeLeft<=0)){fr("collection income from "+a),"thieves"===a&&this.addStolen(o.stores);var i=o.stores,c=!0;if("thieves"!==a)for(var s in i)if((r.stores[s]||0)+i[s]<0){c=!1;break}c&&n.push(o.stores),t=!0,"number"==typeof o.delay&&(o.timeLeft=o.delay)}}if(t){var u={};n.forEach((function(e){Object.keys(e).forEach((function(t){(u[t]||0+e[t])&&(u[t]=u[t]||0+e[t]||0)}))})),this.dispatch(this.actions.stores.addM(u))}this.dispatch(this.actions.income.setM(r.income)),this._incomeTimeout=this.setTimeout(this.collectIncome.bind(this),1e3)},r.addStolen=function(e){var t=this.getState(),n={};for(var r in e){var a=(t.stores[r]||0)+e[r];n[r]=a<0?-1*e[r]+a:-1*e[r]}this.dispatch(this.actions.game.stolen.addM(n))},t}(),Zr=Object.prototype.toString,Qr=function(e){var t=Zr.call(e),n="[object Arguments]"===t;return n||(n="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===Zr.call(e.callee)),n};if(!Object.keys){var Xr=Object.prototype.hasOwnProperty,ea=Object.prototype.toString,ta=Qr,na=Object.prototype.propertyIsEnumerable,ra=!na.call({toString:null},"toString"),aa=na.call((function(){}),"prototype"),oa=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],ia=function(e){var t=e.constructor;return t&&t.prototype===e},ca={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},sa=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!ca["$"+e]&&Xr.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{ia(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();Kr=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===ea.call(e),r=ta(e),a=t&&"[object String]"===ea.call(e),o=[];if(!t&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var i=aa&&n;if(a&&e.length>0&&!Xr.call(e,0))for(var c=0;c<e.length;++c)o.push(String(c));if(r&&e.length>0)for(var s=0;s<e.length;++s)o.push(String(s));else for(var u in e)i&&"prototype"===u||!Xr.call(e,u)||o.push(String(u));if(ra)for(var l=function(e){if("undefined"==typeof window||!sa)return ia(e);try{return ia(e)}catch(e){return!1}}(e),f=0;f<oa.length;++f)l&&"constructor"===oa[f]||!Xr.call(e,oa[f])||o.push(oa[f]);return o}}var ua=Array.prototype.slice,la=Object.keys,fa=la?function(e){return la(e)}:Kr,ha=Object.keys;fa.shim=function(){return Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return Qr(e)?ha(ua.call(e)):ha(e)}):Object.keys=fa,Object.keys||fa};var da=fa,pa="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),ma=Object.prototype.toString,ga=Array.prototype.concat,va=Object.defineProperty,ya=va&&function(){var e={};try{for(var t in va(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),ba=function(e,t,n,r){(!(t in e)||function(e){return"function"==typeof e&&"[object Function]"===ma.call(e)}(r)&&r())&&(ya?va(e,t,{configurable:!0,enumerable:!1,value:n,writable:!0}):e[t]=n)},xa=function(e,t){var n=arguments.length>2?arguments[2]:{},r=da(t);pa&&(r=ga.call(r,Object.getOwnPropertySymbols(t)));for(var a=0;a<r.length;a+=1)ba(e,r[a],t[r[a]],n[r[a]])};xa.supportsDescriptors=!!ya;var wa=xa,Sa="Function.prototype.bind called on incompatible ",_a=Array.prototype.slice,Ea=Object.prototype.toString,Oa=Function.prototype.bind||function(e){var t=this;if("function"!=typeof t||"[object Function]"!==Ea.call(t))throw new TypeError(Sa+t);for(var n,r=_a.call(arguments,1),a=function(){if(this instanceof n){var a=t.apply(this,r.concat(_a.call(arguments)));return Object(a)===a?a:this}return t.apply(e,r.concat(_a.call(arguments)))},o=Math.max(0,t.length-r.length),i=[],c=0;c<o;c++)i.push("$"+c);if(n=Function("binder","return function ("+i.join(",")+"){ return binder.apply(this,arguments); }")(a),t.prototype){var s=function(){};s.prototype=t.prototype,n.prototype=new s,s.prototype=null}return n},ka=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var a=Object.getOwnPropertyDescriptor(e,t);if(42!==a.value||!0!==a.enumerable)return!1}return!0},Aa="undefined"!=typeof Symbol&&Symbol,La=function(){return"function"==typeof Aa&&"function"==typeof Symbol&&"symbol"==typeof Aa("foo")&&"symbol"==typeof Symbol("bar")&&ka()},Wa=Oa.call(Function.call,Object.prototype.hasOwnProperty),Da=SyntaxError,Ma=Function,Ra=TypeError,Ca=function(e){try{return Ma('"use strict"; return ('+e+").constructor;")()}catch(e){}},ja=Object.getOwnPropertyDescriptor;if(ja)try{ja({},"")}catch(e){ja=null}var Pa=function(){throw new Ra},Ta=ja?function(){try{return Pa}catch(e){try{return ja(arguments,"callee").get}catch(e){return Pa}}}():Pa,Na=La(),Ia=Object.getPrototypeOf||function(e){return e.__proto__},Fa={},Ga="undefined"==typeof Uint8Array?void 0:Ia(Uint8Array),Va={"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":Na?Ia([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":Fa,"%AsyncGenerator%":Fa,"%AsyncGeneratorFunction%":Fa,"%AsyncIteratorPrototype%":Fa,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":Ma,"%GeneratorFunction%":Fa,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Na?Ia(Ia([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&Na?Ia((new Map)[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&Na?Ia((new Set)[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Na?Ia(""[Symbol.iterator]()):void 0,"%Symbol%":Na?Symbol:void 0,"%SyntaxError%":Da,"%ThrowTypeError%":Ta,"%TypedArray%":Ga,"%TypeError%":Ra,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet},Ua={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ba=Oa.call(Function.call,Array.prototype.concat),Ha=Oa.call(Function.apply,Array.prototype.splice),za=Oa.call(Function.call,String.prototype.replace),$a=Oa.call(Function.call,String.prototype.slice),qa=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Ya=/\\(\\)?/g,Ka=function(e){var t=$a(e,0,1),n=$a(e,-1);if("%"===t&&"%"!==n)throw new Da("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new Da("invalid intrinsic syntax, expected opening `%`");var r=[];return za(e,qa,(function(e,t,n,a){r[r.length]=n?za(a,Ya,"$1"):t||e})),r},Ja=function(e,t){var n,r=e;if(Wa(Ua,r)&&(r="%"+(n=Ua[r])[0]+"%"),Wa(Va,r)){var a=Va[r];if(a===Fa&&(a=function e(t){var n;if("%AsyncFunction%"===t)n=Ca("async function () {}");else if("%GeneratorFunction%"===t)n=Ca("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=Ca("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var a=e("%AsyncGenerator%");a&&(n=Ia(a.prototype))}return Va[t]=n,n}(r)),void 0===a&&!t)throw new Ra("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:a}}throw new Da("intrinsic "+e+" does not exist!")},Za=function(e,t){if("string"!=typeof e||0===e.length)throw new Ra("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new Ra('"allowMissing" argument must be a boolean');var n=Ka(e),r=n.length>0?n[0]:"",a=Ja("%"+r+"%",t),o=a.name,i=a.value,c=!1,s=a.alias;s&&(r=s[0],Ha(n,Ba([0,1],s)));for(var u=1,l=!0;u<n.length;u+=1){var f=n[u],h=$a(f,0,1),d=$a(f,-1);if(('"'===h||"'"===h||"`"===h||'"'===d||"'"===d||"`"===d)&&h!==d)throw new Da("property names with quotes must have matching quotes");if("constructor"!==f&&l||(c=!0),Wa(Va,o="%"+(r+="."+f)+"%"))i=Va[o];else if(null!=i){if(!(f in i)){if(!t)throw new Ra("base intrinsic for "+e+" exists, but the property is not available.");return}if(ja&&u+1>=n.length){var p=ja(i,f);i=(l=!!p)&&"get"in p&&!("originalValue"in p.get)?p.get:i[f]}else l=Wa(i,f),i=i[f];l&&!c&&(Va[o]=i)}}return i},Qa=c((function(e){var t=Za("%Function.prototype.apply%"),n=Za("%Function.prototype.call%"),r=Za("%Reflect.apply%",!0)||Oa.call(n,t),a=Za("%Object.getOwnPropertyDescriptor%",!0),o=Za("%Object.defineProperty%",!0),i=Za("%Math.max%");if(o)try{o({},"a",{value:1})}catch(e){o=null}e.exports=function(e){var t=r(Oa,n,arguments);if(a&&o){var c=a(t,"length");c.configurable&&o(t,"length",{value:1+i(0,e.length-(arguments.length-1))})}return t};var c=function(){return r(Oa,t,arguments)};o?o(e.exports,"apply",{value:c}):e.exports.apply=c})),Xa=Qa(Za("String.prototype.indexOf")),eo=function(e,t){var n=Za(e,!!t);return"function"==typeof n&&Xa(e,".prototype.")>-1?Qa(n):n},to=Za("%TypeError%"),no=function(e,t){if(null==e)throw new to(t||"Cannot call method on "+e);return e},ro=Za("%Array%"),ao=!ro.isArray&&eo("Object.prototype.toString"),oo=ro.isArray||function(e){return"[object Array]"===ao(e)},io=Za("%TypeError%"),co=Za("%Reflect.apply%",!0)||eo("%Function.prototype.apply%"),so=function(e,t){var n=arguments.length>2?arguments[2]:[];if(!oo(n))throw new io("Assertion failed: optional `argumentsList`, if provided, must be a List");return co(e,t,n)},uo=function(e){return e&&e.default||e}({__proto__:null,default:{}}),lo="function"==typeof Map&&Map.prototype,fo=Object.getOwnPropertyDescriptor&&lo?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,ho=lo&&fo&&"function"==typeof fo.get?fo.get:null,po=lo&&Map.prototype.forEach,mo="function"==typeof Set&&Set.prototype,go=Object.getOwnPropertyDescriptor&&mo?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,vo=mo&&go&&"function"==typeof go.get?go.get:null,yo=mo&&Set.prototype.forEach,bo="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,xo="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,wo="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,So=Boolean.prototype.valueOf,_o=Object.prototype.toString,Eo=Function.prototype.toString,Oo=String.prototype.match,ko="function"==typeof BigInt?BigInt.prototype.valueOf:null,Ao=Object.getOwnPropertySymbols,Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,Wo="function"==typeof Symbol&&"object"==typeof Symbol.iterator,Do=Object.prototype.propertyIsEnumerable,Mo=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null),Ro=uo.custom,Co=Ro&&Io(Ro)?Ro:null,jo="function"==typeof Symbol&&void 0!==Symbol.toStringTag?Symbol.toStringTag:null;function Po(e,t,n){var r="double"===(n.quoteStyle||t)?'"':"'";return r+e+r}function To(e){return String(e).replace(/"/g,"&quot;")}function No(e){return!("[object Array]"!==Vo(e)||jo&&"object"==typeof e&&jo in e)}function Io(e){if(Wo)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!Lo)return!1;try{return Lo.call(e),!0}catch(e){}return!1}var Fo=Object.prototype.hasOwnProperty||function(e){return e in this};function Go(e,t){return Fo.call(e,t)}function Vo(e){return _o.call(e)}function Uo(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function Bo(e){var t=e.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return n?"\\"+n:"\\x"+(t<16?"0":"")+t.toString(16).toUpperCase()}function Ho(e){return"Object("+e+")"}function zo(e){return e+" { ? }"}function $o(e,t,n,r){return e+" ("+t+") {"+(r?qo(n,r):n.join(", "))+"}"}function qo(e,t){if(0===e.length)return"";var n="\n"+t.prev+t.base;return n+e.join(","+n)+"\n"+t.prev}function Yo(e,t){var n=No(e),r=[];if(n){r.length=e.length;for(var a=0;a<e.length;a++)r[a]=Go(e,a)?t(e[a],e):""}var o,i="function"==typeof Ao?Ao(e):[];if(Wo){o={};for(var c=0;c<i.length;c++)o["$"+i[c]]=i[c]}for(var s in e)Go(e,s)&&(n&&String(Number(s))===s&&s<e.length||Wo&&o["$"+s]instanceof Symbol||(/[^\w$]/.test(s)?r.push(t(s,e)+": "+t(e[s],e)):r.push(s+": "+t(e[s],e))));if("function"==typeof Ao)for(var u=0;u<i.length;u++)Do.call(e,i[u])&&r.push("["+t(i[u])+"]: "+t(e[i[u]],e));return r}var Ko,Jo,Zo=function(e){return"string"==typeof e||"symbol"==typeof e},Qo=function(e){return"symbol"==typeof e?"Symbol":"bigint"==typeof e?"BigInt":function(e){return null===e?"Null":void 0===e?"Undefined":"function"==typeof e||"object"==typeof e?"Object":"number"==typeof e?"Number":"boolean"==typeof e?"Boolean":"string"==typeof e?"String":void 0}(e)},Xo=Za("%TypeError%"),ei=function(e,t){if("Object"!==Qo(e))throw new Xo("Assertion failed: Type(O) is not Object");if(!Zo(t))throw new Xo("Assertion failed: IsPropertyKey(P) is not true, got "+function e(t,n,r,a){var o=n||{};if(Go(o,"quoteStyle")&&"single"!==o.quoteStyle&&"double"!==o.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Go(o,"maxStringLength")&&("number"==typeof o.maxStringLength?o.maxStringLength<0&&Infinity!==o.maxStringLength:null!==o.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var i=!Go(o,"customInspect")||o.customInspect;if("boolean"!=typeof i&&"symbol"!==i)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Go(o,"indent")&&null!==o.indent&&"\t"!==o.indent&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('options "indent" must be "\\t", an integer > 0, or `null`');if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return function e(t,n){if(t.length>n.maxStringLength){var r=t.length-n.maxStringLength,a="... "+r+" more character"+(r>1?"s":"");return e(t.slice(0,n.maxStringLength),n)+a}return Po(t.replace(/(['\\])/g,"\\$1").replace(/[\x00-\x1f]/g,Bo),"single",n)}(t,o);if("number"==typeof t)return 0===t?Infinity/t>0?"0":"-0":String(t);if("bigint"==typeof t)return String(t)+"n";var c=void 0===o.depth?5:o.depth;if(void 0===r&&(r=0),r>=c&&c>0&&"object"==typeof t)return No(t)?"[Array]":"[Object]";var s=function(e,t){var n;if("\t"===e.indent)n="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;n=Array(e.indent+1).join(" ")}return{base:n,prev:Array(t+1).join(n)}}(o,r);if(void 0===a)a=[];else if(Uo(a,t)>=0)return"[Circular]";function u(t,n,i){if(n&&(a=a.slice()).push(n),i){var c={depth:o.depth};return Go(o,"quoteStyle")&&(c.quoteStyle=o.quoteStyle),e(t,c,r+1,a)}return e(t,o,r+1,a)}if("function"==typeof t){var l=function(e){if(e.name)return e.name;var t=Oo.call(Eo.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}(t),f=Yo(t,u);return"[Function"+(l?": "+l:" (anonymous)")+"]"+(f.length>0?" { "+f.join(", ")+" }":"")}if(Io(t)){var h=Wo?String(t).replace(/^(Symbol\(.*\))_[^)]*$/,"$1"):Lo.call(t);return"object"!=typeof t||Wo?h:Ho(h)}if(function(e){return!(!e||"object"!=typeof e)&&("undefined"!=typeof HTMLElement&&e instanceof HTMLElement||"string"==typeof e.nodeName&&"function"==typeof e.getAttribute)}(t)){for(var d="<"+String(t.nodeName).toLowerCase(),p=t.attributes||[],m=0;m<p.length;m++)d+=" "+p[m].name+"="+Po(To(p[m].value),"double",o);return d+=">",t.childNodes&&t.childNodes.length&&(d+="..."),d+"</"+String(t.nodeName).toLowerCase()+">"}if(No(t)){if(0===t.length)return"[]";var g=Yo(t,u);return s&&!function(e){for(var t=0;t<e.length;t++)if(Uo(e[t],"\n")>=0)return!1;return!0}(g)?"["+qo(g,s)+"]":"[ "+g.join(", ")+" ]"}if(function(e){return!("[object Error]"!==Vo(e)||jo&&"object"==typeof e&&jo in e)}(t)){var v=Yo(t,u);return 0===v.length?"["+String(t)+"]":"{ ["+String(t)+"] "+v.join(", ")+" }"}if("object"==typeof t&&i){if(Co&&"function"==typeof t[Co])return t[Co]();if("symbol"!==i&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!ho||!e||"object"!=typeof e)return!1;try{ho.call(e);try{vo.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var y=[];return po.call(t,(function(e,n){y.push(u(n,t,!0)+" => "+u(e,t))})),$o("Map",ho.call(t),y,s)}if(function(e){if(!vo||!e||"object"!=typeof e)return!1;try{vo.call(e);try{ho.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var b=[];return yo.call(t,(function(e){b.push(u(e,t))})),$o("Set",vo.call(t),b,s)}if(function(e){if(!bo||!e||"object"!=typeof e)return!1;try{bo.call(e,bo);try{xo.call(e,xo)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return zo("WeakMap");if(function(e){if(!xo||!e||"object"!=typeof e)return!1;try{xo.call(e,xo);try{bo.call(e,bo)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return zo("WeakSet");if(function(e){if(!wo||!e||"object"!=typeof e)return!1;try{return wo.call(e),!0}catch(e){}return!1}(t))return zo("WeakRef");if(function(e){return!("[object Number]"!==Vo(e)||jo&&"object"==typeof e&&jo in e)}(t))return Ho(u(Number(t)));if(function(e){if(!e||"object"!=typeof e||!ko)return!1;try{return ko.call(e),!0}catch(e){}return!1}(t))return Ho(u(ko.call(t)));if(function(e){return!("[object Boolean]"!==Vo(e)||jo&&"object"==typeof e&&jo in e)}(t))return Ho(So.call(t));if(function(e){return!("[object String]"!==Vo(e)||jo&&"object"==typeof e&&jo in e)}(t))return Ho(u(String(t)));if(!function(e){return!("[object Date]"!==Vo(e)||jo&&"object"==typeof e&&jo in e)}(t)&&!function(e){return!("[object RegExp]"!==Vo(e)||jo&&"object"==typeof e&&jo in e)}(t)){var x=Yo(t,u),w=Mo?Mo(t)===Object.prototype:t instanceof Object||t.constructor===Object,S=t instanceof Object?"":"null prototype",_=!w&&jo&&Object(t)===t&&jo in t?Vo(t).slice(8,-1):S?"Object":"",E=(w||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(_||S?"["+[].concat(_||[],S||[]).join(": ")+"] ":"");return 0===x.length?E+"{}":s?E+"{"+qo(x,s)+"}":E+"{ "+x.join(", ")+" }"}return String(t)}(t));return e[t]},ti=Za("%TypeError%"),ni=function(e,t){if("Object"!==Qo(e))throw new ti("Assertion failed: `O` must be an Object");if(!Zo(t))throw new ti("Assertion failed: `P` must be a Property Key");return t in e},ri=Function.prototype.toString,ai="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof ai&&"function"==typeof Object.defineProperty)try{Ko=Object.defineProperty({},"length",{get:function(){throw Jo}}),Jo={},ai((function(){throw 42}),null,Ko)}catch(T){T!==Jo&&(ai=null)}else ai=null;var oi=/^\s*class\b/,ii=function(e){try{var t=ri.call(e);return oi.test(t)}catch(e){return!1}},ci=Object.prototype.toString,si="function"==typeof Symbol&&!!Symbol.toStringTag,ui="object"==typeof document&&void 0===document.all&&void 0!==document.all?document.all:{},li=ai?function(e){if(e===ui)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;try{ai(e,null,Ko)}catch(e){if(e!==Jo)return!1}return!ii(e)}:function(e){if(e===ui)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(si)return function(e){try{return!ii(e)&&(ri.call(e),!0)}catch(e){return!1}}(e);if(ii(e))return!1;var t=ci.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t},fi=li,hi=Za("%Math%"),di=Za("%Number%").MAX_SAFE_INTEGER||hi.pow(2,53)-1,pi=Za("%Math.abs%"),mi=Math.floor,gi=function(e){return null===e||"function"!=typeof e&&"object"!=typeof e},vi=Object.prototype.toString,yi=function(e){var t;if((t=arguments.length>1?arguments[1]:"[object Date]"===vi.call(e)?String:Number)===String||t===Number){var n,r,a=t===String?["toString","valueOf"]:["valueOf","toString"];for(r=0;r<a.length;++r)if(li(e[a[r]])&&(n=e[a[r]](),gi(n)))return n;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")},bi=Number.isNaN||function(e){return e!=e},xi=Number.isNaN||function(e){return e!=e},wi=Number.isFinite||function(e){return"number"==typeof e&&!xi(e)&&Infinity!==e&&-Infinity!==e},Si=Za("RegExp.prototype.test"),_i=function(e){return Qa(Si,e)},Ei=function(){return ka()&&!!Symbol.toStringTag},Oi=Date.prototype.getDay,ki=Object.prototype.toString,Ai=Ei(),Li=function(e){return"object"==typeof e&&null!==e&&(Ai?function(e){try{return Oi.call(e),!0}catch(e){return!1}}(e):"[object Date]"===ki.call(e))},Wi=c((function(e){var t=Object.prototype.toString;if(La()){var n=Symbol.prototype.toString,r=/^Symbol\(.*\)$/;e.exports=function(e){if("symbol"==typeof e)return!0;if("[object Symbol]"!==t.call(e))return!1;try{return function(e){return"symbol"==typeof e.valueOf()&&r.test(n.call(e))}(e)}catch(e){return!1}}}else e.exports=function(e){return!1}})),Di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,Mi=function(e,t){if(null==e)throw new TypeError("Cannot call method on "+e);if("string"!=typeof t||"number"!==t&&"string"!==t)throw new TypeError('hint must be "string" or "number"');var n,r,a,o="string"===t?["toString","valueOf"]:["valueOf","toString"];for(a=0;a<o.length;++a)if(li(n=e[o[a]])&&(r=n.call(e),gi(r)))return r;throw new TypeError("No default value")},Ri=function(e,t){var n=e[t];if(null!=n){if(!li(n))throw new TypeError(n+" returned for property "+t+" of object "+e+" is not a function");return n}},Ci=function(e){if(gi(e))return e;var t,n="default";if(arguments.length>1&&(arguments[1]===String?n="string":arguments[1]===Number&&(n="number")),Di&&(Symbol.toPrimitive?t=Ri(e,Symbol.toPrimitive):Wi(e)&&(t=Symbol.prototype.valueOf)),void 0!==t){var r=t.call(e,n);if(gi(r))return r;throw new TypeError("unable to convert exotic object to primitive")}return"default"===n&&(Li(e)||Wi(e))&&(n="string"),Mi(e,"default"===n?"number":n)},ji=Za("%TypeError%"),Pi=Za("%Number%"),Ti=Za("%RegExp%"),Ni=Za("%parseInt%"),Ii=eo("String.prototype.slice"),Fi=_i(/^0b[01]+$/i),Gi=_i(/^0o[0-7]+$/i),Vi=_i(/^[-+]0x[0-9a-f]+$/i),Ui=_i(new Ti("["+["","​","￾"].join("")+"]","g")),Bi=["\t\n\v\f\r   ᠎    ","         　\u2028","\u2029\ufeff"].join(""),Hi=new RegExp("(^["+Bi+"]+)|(["+Bi+"]+$)","g"),zi=eo("String.prototype.replace"),$i=Za("%TypeError%"),qi=function(e){if("Object"!==Qo(e))throw new $i("Assertion failed: `obj` must be an Object");return 0!==(t=function e(t){var n=function(e){return null===e||"function"!=typeof e&&"object"!=typeof e}(t)?t:function(e){return arguments.length>1?Ci(e,arguments[1]):Ci(e)}(t,Pi);if("symbol"==typeof n)throw new ji("Cannot convert a Symbol value to a number");if("bigint"==typeof n)throw new ji("Conversion from 'BigInt' to 'number' is not allowed.");if("string"==typeof n){if(Fi(n))return e(Ni(Ii(n,2),2));if(Gi(n))return e(Ni(Ii(n,2),8));if(Ui(n)||Vi(n))return NaN;var r=function(e){return zi(e,Hi,"")}(n);if(r!==n)return e(r)}return Pi(n)}(ei(e,"length")))&&(t=function(e){var t=function(e){var t=function(e){return gi(e)?e:arguments.length>1?yi(e,arguments[1]):yi(e)}(e,Number);if("string"!=typeof t)return+t;var n=t.replace(/^[ \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u0085]+|[ \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u0085]+$/g,"");return/^0[ob]|^[+-]0x/.test(n)?NaN:+n}(e);return bi(t)?0:0!==t&&wi(t)?function(e){return e>=0?1:-1}(t)*function(e){return mi(e)}(function(e){return pi(e)}(t)):t}(t)),(n=0===t?0:t)<=0?0:n>di?di:n;var t,n},Yi=Za("%Object%"),Ki=function(e){return no(e),Yi(e)},Ji=Za("%String%"),Zi=Za("%TypeError%"),Qi=function(e){if("symbol"==typeof e)throw new Zi("Cannot convert a Symbol value to a string");return Ji(e)},Xi=String.prototype.valueOf,ec=Object.prototype.toString,tc=Ei(),nc=function(e){return"string"==typeof e||"object"==typeof e&&(tc?function(e){try{return Xi.call(e),!0}catch(e){return!1}}(e):"[object String]"===ec.call(e))},rc=Za("%TypeError%"),ac=eo("String.prototype.split"),oc=Object("a"),ic="a"!==oc[0]||!(0 in oc),cc=function(e){var t,n=Ki(this),r=ic&&nc(this)?ac(this,""):n,a=qi(r);if(!fi(e))throw new rc("Array.prototype.forEach callback must be a function");arguments.length>1&&(t=arguments[1]);for(var o=0;o<a;){var i=Qi(o),c=ni(r,i);if(c){var s=ei(r,i);so(e,t,[s,o,r])}o+=1}},sc=function(){var e=Array.prototype.forEach;return function(e){var t=!0,n=!0,r=!1;if("function"==typeof e){try{e.call("f",(function(e,n,r){"object"!=typeof r&&(t=!1)})),e.call([null],(function(){n="string"==typeof this}),"x")}catch(e){r=!0}return!r&&t&&n}return!1}(e)?e:cc},uc=sc(),lc=eo("Array.prototype.slice"),fc=Qa.apply(uc),hc=function(e,t){return no(e),fc(e,lc(arguments,1))};wa(hc,{getPolyfill:sc,implementation:cc,shim:function(){var e=sc();return wa(Array.prototype,{forEach:e},{forEach:function(){return Array.prototype.forEach!==e}}),e}});var dc=hc,pc=eo("Object.prototype.propertyIsEnumerable"),mc=eo("Array.prototype.push"),gc=function(e){var t=no(e),n=[];for(var r in t)pc(t,r)&&mc(n,[r,t[r]]);return n},vc=function(){return"function"==typeof Object.entries?Object.entries:gc},yc=Qa(vc(),Object);wa(yc,{getPolyfill:vc,implementation:gc,shim:function(){var e=vc();return wa(Object,{entries:e},{entries:function(){return Object.entries!==e}}),e}});var bc=yc,xc=eo("String.prototype.replace"),wc=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,Sc=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/,_c=function(){var e=Qi(no(this));return xc(xc(e,wc,""),Sc,"")},Ec=function(){return String.prototype.trim&&"​"==="​".trim()?String.prototype.trim:_c},Oc=Qa(Ec());wa(Oc,{getPolyfill:Ec,implementation:_c,shim:function(){var e=Ec();return wa(String.prototype,{trim:e},{trim:function(){return String.prototype.trim!==e}}),e}});var kc=Oc,Ac=function(e){},Lc=String.prototype.replace,Wc=String.prototype.split,Dc=function(e){var t=e%100,n=t%10;return 11!==t&&1===n?0:2<=n&&n<=4&&!(t>=12&&t<=14)?1:2},Mc={pluralTypes:{arabic:function(e){if(e<3)return e;var t=e%100;return t>=3&&t<=10?3:t>=11?4:5},bosnian_serbian:Dc,chinese:function(){return 0},croatian:Dc,french:function(e){return e>=2?1:0},german:function(e){return 1!==e?1:0},russian:Dc,lithuanian:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=9&&(e%100<11||e%100>19)?1:2},czech:function(e){return 1===e?0:e>=2&&e<=4?1:2},polish:function(e){if(1===e)return 0;var t=e%10;return 2<=t&&t<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!=1||e%100==11?1:0},slovenian:function(e){var t=e%100;return 1===t?0:2===t?1:3===t||4===t?2:3}},pluralTypeToLanguages:{arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]}};function Rc(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var Cc,jc=(Cc={},function(e,t){var n=Cc[t];return n&&!e.pluralTypes[n]&&(Cc[t]=n=null),n||(n=function(e,t){var n,r=(n={},dc(bc(e.pluralTypeToLanguages),(function(e){var t=e[0];dc(e[1],(function(e){n[e]=t}))})),n);return r[t]||r[Wc.call(t,/-/,1)[0]]||r.en}(e,t))&&(Cc[t]=n),n}),Pc=/%\{(.*?)\}/g;function Tc(e,t,n,r,a){if("string"!=typeof e)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==t)return e;var o=e,i=r||Pc,c="number"==typeof t?{smart_count:t}:t;if(null!=c.smart_count&&e){var s=a||Mc,u=Wc.call(e,"||||"),l=function(e,t,n){return e.pluralTypes[t](n)}(s,jc(s,n||"en"),c.smart_count);o=kc(u[l]||u[0])}return Lc.call(o,i,(function(e,t){return Wa(c,t)&&null!=c[t]?c[t]:e}))}function Nc(e){var t=e||{};this.phrases={},this.extend(t.phrases||{}),this.currentLocale=t.locale||"en",this.onMissingKey="function"==typeof t.onMissingKey?t.onMissingKey:t.allowMissing?Tc:null,this.warn=t.warn||Ac,this.tokenRegex=function(e){var t=e&&e.prefix||"%{",n=e&&e.suffix||"}";if("||||"===t||"||||"===n)throw new RangeError('"||||" token is reserved for pluralization');return new RegExp(Rc(t)+"(.*?)"+Rc(n),"g")}(t.interpolation),this.pluralRules=t.pluralRules||Mc}Nc.prototype.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},Nc.prototype.extend=function(e,t){dc(bc(e||{}),(function(e){var n=e[0],r=e[1],a=t?t+"."+n:n;"object"==typeof r?this.extend(r,a):this.phrases[a]=r}),this)},Nc.prototype.unset=function(e,t){"string"==typeof e?delete this.phrases[e]:dc(bc(e||{}),(function(e){var n=e[0],r=e[1],a=t?t+"."+n:n;"object"==typeof r?this.unset(r,a):delete this.phrases[a]}),this)},Nc.prototype.clear=function(){this.phrases={}},Nc.prototype.replace=function(e){this.clear(),this.extend(e)},Nc.prototype.t=function(e,t){var n,r,a=null==t?{}:t;return"string"==typeof this.phrases[e]?n=this.phrases[e]:"string"==typeof a._?n=a._:this.onMissingKey?r=(0,this.onMissingKey)(e,a,this.currentLocale,this.tokenRegex,this.pluralRules):(this.warn('Missing translation for key: "'+e+'"'),r=e),"string"==typeof n&&(r=Tc(n,a,this.currentLocale,this.tokenRegex,this.pluralRules)),r},Nc.prototype.has=function(e){return Wa(this.phrases,e)},Nc.transformPhrase=function(e,t,n){return Tc(e,t,n)};var Ic=Nc;At.templateSettings.interpolate=/{([\s\S]+?)}/;var Fc=new Ic,Gc=[],Vc={},Uc=/\\{\w+\\}/g;function Bc(e,t){if(Vc[e])return Vc[e];if(!isNaN(Number(e)))return e;if(Mt.items[e])e=Mt.items[e].name;else if(Mt.Outside.INCOME[e])e=Mt.Outside.INCOME[e].name;else for(var n=0,r=Gc.length;n<r;n++){var a=Gc[n],o=a.match.exec(e);if(a.match.lastIndex=0,o){var i=a.interpolcation(a.template,a.keys,o.slice(1));return Vc[e]=i,i}}var c=Fc.t(e,t);return Vc[e]=c,c}e.Engine=Jr,e.Perks=y,e.config=Mt,e.incomes=b,e.setTranslation=function(e){(Fc=new Ic).extend(e),Gc=[],Vc={},Object.keys(e).forEach((function(t){for(var n=/{(.+?)}/g,r=n.exec(t),a=[];r;)a.push(r[1]),r=n.exec(t);if(a.length>0){var o=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}(t).replace(Uc,"(.+?)");Gc.push({match:new RegExp("^"+o+"$"),interpolcation:function(e,t,n){var r={};return t.forEach((function(e,t){r[e]=Bc(n[t])})),e.replace(/{(.+?)}/g,(function(e,t){return void 0===r[t]?t:r[t]}))},template:e[t],keys:a})}})),Gc.sort((function(e,t){return t.template.length-e.template.length}))},e.translate=Bc,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=adarkroom-core.umd.production.min.js.map
